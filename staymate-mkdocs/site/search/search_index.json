{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"StayMate","text":"Enterprise Property Rental Platform <p> A production-grade Spring Boot backend for property rental, roommate matching, and financial management </p>"},{"location":"#quick-start","title":"Quick Start","text":"Run BackendRun with DockerAccess API <pre><code>cd server\n./mvnw spring-boot:run\n</code></pre> <pre><code>docker-compose up -d\n</code></pre> <pre><code>curl http://localhost:8080/actuator/health\n</code></pre>"},{"location":"#platform-overview","title":"Platform Overview","text":"<pre><code>graph TB\n    subgraph Clients\n        WEB[\"\ud83c\udf10 Next.js Frontend\"]\n        API[\"\ud83d\udcf1 REST API Clients\"]\n    end\n\n    subgraph \"Spring Boot Application\"\n        GW[\"\ud83d\udd12 Security Layer\"]\n        CTRL[\"\ud83c\udfae Controllers\"]\n        SVC[\"\u2699\ufe0f Services\"]\n        REPO[\"\ud83d\udcbe Repositories\"]\n    end\n\n    subgraph \"Data Stores\"\n        DB[(\"\ud83d\uddc4\ufe0f MySQL\")]\n        MINIO[\"\ud83d\udce6 MinIO\"]\n    end\n\n    WEB --&gt; GW\n    API --&gt; GW\n    GW --&gt; CTRL\n    CTRL --&gt; SVC\n    SVC --&gt; REPO\n    REPO --&gt; DB\n    SVC --&gt; MINIO\n\n    style GW fill:#e74c3c\n    style SVC fill:#3498db\n    style DB fill:#27ae60</code></pre>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li> <p> Enterprise Security</p> <p>JWT + OAuth2 authentication, RBAC authorization, rate limiting, and comprehensive threat mitigation.</p> <p> Security Docs</p> </li> <li> <p> Property Management</p> <p>Full CRUD for listings, advanced search, image uploads via MinIO, and moderation workflows.</p> <p> API Reference</p> </li> <li> <p> Booking System</p> <p>Complete booking lifecycle: request \u2192 approval \u2192 check-in \u2192 check-out with notifications.</p> <p> Data Flow</p> </li> <li> <p> Financial Operations</p> <p>Earnings tracking, payout management, payment history, and admin financial oversight.</p> <p> Backend</p> </li> </ul>"},{"location":"#technical-stack","title":"Technical Stack","text":"Layer Technology Version Backend Spring Boot 3.x Language Java 17 LTS Database MySQL 8.0+ Migrations Flyway Latest Auth JWT + OAuth2 jjwt 0.11.x Storage MinIO S3-compatible Pool HikariCP Default"},{"location":"#documentation-sections","title":"Documentation Sections","text":"Section Description Product Motivation, vision, features, and non-goals Architecture Clean architecture, request lifecycle, data flow Security JWT, OAuth2, authorization, threat model API Reference Role-aware endpoints (Tenant/Landlord/Admin) Backend Service layer, repositories, DTOs, validation Database Schema, ER diagram, indexing, migrations Performance Load testing, caching, scaling Observability Logging, metrics, dashboards Quality Testing strategy, CI/CD Deployment Docker, configuration, rollback Contributing Code style, branching, roadmap"},{"location":"#metrics-at-a-glance","title":"Metrics at a Glance","text":"Metric Value API Endpoints 148 Domain Modules 23 Flyway Migrations 55+ User Roles 3 (USER, HOUSE_OWNER, ADMIN) SLA Target p95 &lt; 500ms <p> Built with \u2764\ufe0f using Spring Boot, MySQL, and MinIO </p>"},{"location":"api/","title":"API Reference","text":"<p>Role-aware API documentation for StayMate's 148 endpoints.</p>"},{"location":"api/#api-design-principles","title":"API Design Principles","text":"<ul> <li>RESTful: Resource-oriented URLs</li> <li>JSON: All request/response bodies</li> <li>JWT: Bearer token authentication</li> <li>RBAC: Role-based endpoint access</li> <li>Consistent: Standard error responses</li> </ul>"},{"location":"api/#base-url","title":"Base URL","text":"<pre><code>Production: https://api.staymate.com\nDevelopment: http://localhost:8080\n</code></pre>"},{"location":"api/#authentication","title":"Authentication","text":"<pre><code>Authorization: Bearer &lt;access_token&gt;\n</code></pre> <p>See JWT Lifecycle for token management.</p>"},{"location":"api/#endpoint-categories","title":"Endpoint Categories","text":"<pre><code>graph TD\n    subgraph \"Public\"\n        AUTH[\"/api/auth\"]\n        PUBLIC[\"/api/public\"]\n    end\n\n    subgraph \"Tenant (USER)\"\n        PROP[\"/api/properties\"]\n        BOOK[\"/api/bookings\"]\n        MSG[\"/api/messages\"]\n        ROOM[\"/api/roommates\"]\n    end\n\n    subgraph \"Landlord (HOUSE_OWNER)\"\n        EARN[\"/api/finance\"]\n        MAINT[\"/api/maintenance\"]\n    end\n\n    subgraph \"Admin (ADMIN)\"\n        ADMIN[\"/api/admin\"]\n        USERS[\"/api/users (admin)\"]\n    end</code></pre>"},{"location":"api/#in-this-section","title":"In This Section","text":"Document Endpoints Target Role Authentication 8 Public/All Tenant API 60+ USER Landlord API 30+ HOUSE_OWNER Admin API 25+ ADMIN Versioning \u2014 Reference Error Contracts \u2014 Reference"},{"location":"api/#quick-reference","title":"Quick Reference","text":"Method Meaning <code>GET</code> Retrieve resource(s) <code>POST</code> Create resource <code>PUT</code> Full update <code>PATCH</code> Partial update <code>DELETE</code> Remove resource"},{"location":"api/#common-headers","title":"Common Headers","text":"Header Value Required <code>Authorization</code> <code>Bearer &lt;token&gt;</code> Most endpoints <code>Content-Type</code> <code>application/json</code> POST/PUT/PATCH <code>Accept</code> <code>application/json</code> Recommended"},{"location":"api/admin/","title":"Admin API","text":"<p>Administrative endpoints for platform management.</p>"},{"location":"api/admin/#endpoints","title":"Endpoints","text":"<p>All endpoints require <code>ROLE_ADMIN</code>.</p> Category Example Endpoints Dashboard <code>GET /api/dashboard/admin</code> Analytics <code>GET /api/admin/analytics/user-growth</code> Users <code>GET /api/users</code>, <code>DELETE /api/users/{id}</code> Verification <code>GET /api/verification/admin/pending</code> Fraud <code>GET /api/admin/fraud-scan</code>"},{"location":"api/admin/#dashboard-stats","title":"Dashboard Stats","text":"<pre><code>GET /api/dashboard/admin\nAuthorization: Bearer &lt;admin_token&gt;\n</code></pre> <p>Response: <pre><code>{\n  \"totalUsers\": 5420,\n  \"totalProperties\": 1234,\n  \"activeBookings\": 456,\n  \"pendingBookings\": 78,\n  \"totalRevenue\": 125000,\n  \"fraudAlerts\": 3\n}\n</code></pre></p>"},{"location":"api/admin/#user-management","title":"User Management","text":"<pre><code>GET /api/users?page=0&amp;size=20&amp;role=USER\nAuthorization: Bearer &lt;admin_token&gt;\n</code></pre>"},{"location":"api/admin/#verification-processing","title":"Verification Processing","text":"<pre><code>POST /api/verification/admin/{id}/approve\nAuthorization: Bearer &lt;admin_token&gt;\n</code></pre> <pre><code>POST /api/verification/admin/{id}/reject\nAuthorization: Bearer &lt;admin_token&gt;\nContent-Type: application/json\n\n{\"reason\": \"Document not readable\"}\n</code></pre> <p>See Security - Authorization for role details.</p>"},{"location":"api/auth/","title":"Authentication API","text":"<p>Authentication endpoints for login, registration, and token management.</p>"},{"location":"api/auth/#endpoints","title":"Endpoints","text":"Method Path Description Auth <code>POST</code> <code>/api/auth/register</code> Register new user Public <code>POST</code> <code>/api/auth/login</code> Login Public <code>POST</code> <code>/api/auth/refresh-token</code> Refresh JWT Public <code>GET</code> <code>/api/auth/me</code> Get current user JWT <code>POST</code> <code>/api/auth/logout</code> Logout JWT <code>POST</code> <code>/api/auth/select-role</code> Select user role JWT <code>GET</code> <code>/api/auth/check-email</code> Check email exists Public <code>GET</code> <code>/api/auth/validate</code> Validate token JWT"},{"location":"api/auth/#register","title":"Register","text":"<pre><code>POST /api/auth/register\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\"\n}\n</code></pre> <p>Response (201): <pre><code>{\n  \"accessToken\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"refreshToken\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"tokenType\": \"Bearer\",\n  \"expiresIn\": 900000\n}\n</code></pre></p>"},{"location":"api/auth/#login","title":"Login","text":"<pre><code>POST /api/auth/login\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123!\"\n}\n</code></pre>"},{"location":"api/auth/#oauth2-google","title":"OAuth2 (Google)","text":"<pre><code>GET /oauth2/authorization/google\n</code></pre> <p>Redirects to Google for authentication, then returns to configured redirect URI.</p> <p>See JWT Lifecycle for token management details.</p>"},{"location":"api/error-contracts/","title":"Error Contracts","text":"<p>Standard error response formats across the API.</p>"},{"location":"api/error-contracts/#error-response-structure","title":"Error Response Structure","text":"<p>All errors follow this format:</p> <pre><code>{\n  \"timestamp\": \"2024-01-21T10:30:00Z\",\n  \"status\": 400,\n  \"error\": \"Bad Request\",\n  \"message\": \"Validation failed\",\n  \"path\": \"/api/properties\",\n  \"errors\": [...]\n}\n</code></pre> Field Type Description <code>timestamp</code> ISO-8601 When error occurred <code>status</code> integer HTTP status code <code>error</code> string HTTP status text <code>message</code> string Human-readable message <code>path</code> string Request path <code>errors</code> array Validation errors (optional)"},{"location":"api/error-contracts/#http-status-codes","title":"HTTP Status Codes","text":""},{"location":"api/error-contracts/#success","title":"Success","text":"Code Meaning When <code>200</code> OK GET, PUT, PATCH success <code>201</code> Created POST success <code>204</code> No Content DELETE success"},{"location":"api/error-contracts/#client-errors","title":"Client Errors","text":"Code Meaning When <code>400</code> Bad Request Invalid input <code>401</code> Unauthorized Missing/invalid token <code>403</code> Forbidden Insufficient permissions <code>404</code> Not Found Resource doesn't exist <code>409</code> Conflict Duplicate resource <code>422</code> Unprocessable Entity Business rule violation <code>429</code> Too Many Requests Rate limit exceeded"},{"location":"api/error-contracts/#server-errors","title":"Server Errors","text":"Code Meaning When <code>500</code> Internal Server Error Unexpected error <code>503</code> Service Unavailable Maintenance"},{"location":"api/error-contracts/#error-examples","title":"Error Examples","text":""},{"location":"api/error-contracts/#validation-error-400","title":"Validation Error (400)","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:30:00Z\",\n  \"status\": 400,\n  \"error\": \"Bad Request\",\n  \"message\": \"Validation failed\",\n  \"path\": \"/api/auth/register\",\n  \"errors\": [\n    { \"field\": \"email\", \"message\": \"must be a valid email\" },\n    { \"field\": \"password\", \"message\": \"must be at least 8 characters\" }\n  ]\n}\n</code></pre>"},{"location":"api/error-contracts/#unauthorized-401","title":"Unauthorized (401)","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:30:00Z\",\n  \"status\": 401,\n  \"error\": \"Unauthorized\",\n  \"message\": \"JWT token is expired\",\n  \"path\": \"/api/properties\"\n}\n</code></pre>"},{"location":"api/error-contracts/#forbidden-403","title":"Forbidden (403)","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:30:00Z\",\n  \"status\": 403,\n  \"error\": \"Forbidden\",\n  \"message\": \"Access denied: You don't have permission to modify this resource\",\n  \"path\": \"/api/properties/123\"\n}\n</code></pre>"},{"location":"api/error-contracts/#not-found-404","title":"Not Found (404)","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:30:00Z\",\n  \"status\": 404,\n  \"error\": \"Not Found\",\n  \"message\": \"Property not found with id: 999\",\n  \"path\": \"/api/properties/999\"\n}\n</code></pre>"},{"location":"api/error-contracts/#conflict-409","title":"Conflict (409)","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:30:00Z\",\n  \"status\": 409,\n  \"error\": \"Conflict\",\n  \"message\": \"User already exists with email: user@example.com\",\n  \"path\": \"/api/auth/register\"\n}\n</code></pre>"},{"location":"api/error-contracts/#rate-limited-429","title":"Rate Limited (429)","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:30:00Z\",\n  \"status\": 429,\n  \"error\": \"Too Many Requests\",\n  \"message\": \"Rate limit exceeded. Try again later.\",\n  \"path\": \"/api/auth/login\"\n}\n</code></pre>"},{"location":"api/error-contracts/#client-handling","title":"Client Handling","text":"<pre><code>async function apiRequest(url: string, options: RequestInit) {\n  const response = await fetch(url, options);\n\n  if (!response.ok) {\n    const error = await response.json();\n\n    switch (response.status) {\n      case 401:\n        // Redirect to login or refresh token\n        await refreshToken();\n        return apiRequest(url, options);\n\n      case 403:\n        showError(\"You don't have access to this resource\");\n        break;\n\n      case 404:\n        showError(\"Resource not found\");\n        break;\n\n      case 429:\n        // Retry after delay\n        await delay(60000);\n        return apiRequest(url, options);\n\n      default:\n        showError(error.message);\n    }\n\n    throw new ApiError(error);\n  }\n\n  return response.json();\n}\n</code></pre>"},{"location":"api/landlord/","title":"Landlord API","text":"<p>Endpoints for users with <code>ROLE_HOUSE_OWNER</code> (landlords).</p>"},{"location":"api/landlord/#property-management","title":"Property Management","text":""},{"location":"api/landlord/#create-property","title":"Create Property","text":"<pre><code>POST /api/properties\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"title\": \"Modern 2BR Apartment\",\n  \"description\": \"Spacious apartment with city view...\",\n  \"price\": 25000,\n  \"deposit\": 50000,\n  \"propertyType\": \"APARTMENT\",\n  \"bedrooms\": 2,\n  \"bathrooms\": 2,\n  \"squareFeet\": 1200,\n  \"address\": \"123 Main St\",\n  \"city\": \"Dhaka\",\n  \"amenities\": [\"WIFI\", \"AC\", \"PARKING\"],\n  \"images\": [\"https://storage.../image1.jpg\"]\n}\n</code></pre>"},{"location":"api/landlord/#get-my-properties","title":"Get My Properties","text":"<pre><code>GET /api/properties/my-properties?page=0&amp;size=20\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#update-property","title":"Update Property","text":"<pre><code>PUT /api/properties/{id}\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre>"},{"location":"api/landlord/#delete-property","title":"Delete Property","text":"<pre><code>DELETE /api/properties/{id}\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#update-property-status","title":"Update Property Status","text":"<pre><code>PATCH /api/properties/{id}/status\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"status\": \"UNAVAILABLE\"\n}\n</code></pre>"},{"location":"api/landlord/#booking-management","title":"Booking Management","text":""},{"location":"api/landlord/#get-property-bookings","title":"Get Property Bookings","text":"<pre><code>GET /api/bookings/property/{propertyId}?status=PENDING\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#approvereject-booking","title":"Approve/Reject Booking","text":"<pre><code>PATCH /api/bookings/{id}/status\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"status\": \"APPROVED\",\n  \"note\": \"Looking forward to hosting you!\"\n}\n</code></pre>"},{"location":"api/landlord/#check-in-tenant","title":"Check-In Tenant","text":"<pre><code>POST /api/bookings/{id}/check-in\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#check-out-tenant","title":"Check-Out Tenant","text":"<pre><code>POST /api/bookings/{id}/check-out\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#financial-operations","title":"Financial Operations","text":""},{"location":"api/landlord/#get-earnings-summary","title":"Get Earnings Summary","text":"<pre><code>GET /api/finance/earnings\nAuthorization: Bearer &lt;token&gt;\n</code></pre> <p>Response: <pre><code>{\n  \"totalEarnings\": 150000,\n  \"pendingPayouts\": 25000,\n  \"availableBalance\": 50000,\n  \"thisMonth\": {\n    \"earnings\": 30000,\n    \"bookings\": 5\n  }\n}\n</code></pre></p>"},{"location":"api/landlord/#get-earnings-history","title":"Get Earnings History","text":"<pre><code>GET /api/finance/earnings/history?from=2024-01-01&amp;to=2024-01-31\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#get-payout-methods","title":"Get Payout Methods","text":"<pre><code>GET /api/finance/payout-methods\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#add-payout-method","title":"Add Payout Method","text":"<pre><code>POST /api/finance/payout-methods\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"type\": \"BANK_ACCOUNT\",\n  \"accountName\": \"John Doe\",\n  \"bankName\": \"City Bank\",\n  \"accountNumber\": \"1234567890\",\n  \"routingNumber\": \"12345\",\n  \"isDefault\": true\n}\n</code></pre>"},{"location":"api/landlord/#request-payout","title":"Request Payout","text":"<pre><code>POST /api/finance/payout-request\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"amount\": 25000,\n  \"payoutMethodId\": 1\n}\n</code></pre>"},{"location":"api/landlord/#export-financial-report","title":"Export Financial Report","text":"<pre><code>GET /api/finance/export/csv?from=2024-01-01&amp;to=2024-01-31\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#maintenance-requests","title":"Maintenance Requests","text":""},{"location":"api/landlord/#get-maintenance-requests","title":"Get Maintenance Requests","text":"<pre><code>GET /api/maintenance/property/{propertyId}\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/landlord/#update-request-status","title":"Update Request Status","text":"<pre><code>PATCH /api/maintenance/{id}/status\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"status\": \"IN_PROGRESS\",\n  \"note\": \"Technician scheduled for tomorrow\"\n}\n</code></pre>"},{"location":"api/landlord/#dashboard","title":"Dashboard","text":""},{"location":"api/landlord/#get-landlord-dashboard","title":"Get Landlord Dashboard","text":"<pre><code>GET /api/dashboard/landlord\nAuthorization: Bearer &lt;token&gt;\n</code></pre> <p>Response: <pre><code>{\n  \"totalProperties\": 5,\n  \"activeBookings\": 3,\n  \"pendingBookings\": 2,\n  \"monthlyEarnings\": 75000,\n  \"occupancyRate\": 0.85,\n  \"recentActivity\": [...]\n}\n</code></pre></p>"},{"location":"api/tenant/","title":"Tenant API","text":"<p>Endpoints accessible to users with <code>ROLE_USER</code> (tenants).</p>"},{"location":"api/tenant/#property-endpoints","title":"Property Endpoints","text":""},{"location":"api/tenant/#search-properties","title":"Search Properties","text":"<pre><code>GET /api/properties/search?city=Dhaka&amp;minPrice=5000&amp;maxPrice=20000&amp;page=0&amp;size=20\n</code></pre> <p>Query Parameters:</p> Parameter Type Description <code>city</code> string Filter by city <code>minPrice</code> number Minimum price <code>maxPrice</code> number Maximum price <code>propertyType</code> string APARTMENT, HOUSE, ROOM <code>bedrooms</code> integer Number of bedrooms <code>page</code> integer Page number (0-based) <code>size</code> integer Page size <p>Response: <pre><code>{\n  \"content\": [\n    {\n      \"id\": 1,\n      \"title\": \"Cozy Apartment in Gulshan\",\n      \"price\": 15000,\n      \"city\": \"Dhaka\",\n      \"images\": [\"https://...\"],\n      \"landlord\": { \"id\": 5, \"name\": \"John\" }\n    }\n  ],\n  \"page\": 0,\n  \"totalElements\": 45,\n  \"totalPages\": 3\n}\n</code></pre></p>"},{"location":"api/tenant/#get-property-details","title":"Get Property Details","text":"<pre><code>GET /api/properties/{id}\n</code></pre>"},{"location":"api/tenant/#get-recommended-properties","title":"Get Recommended Properties","text":"<pre><code>GET /api/properties/recommended\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#booking-endpoints","title":"Booking Endpoints","text":""},{"location":"api/tenant/#create-booking","title":"Create Booking","text":"<pre><code>POST /api/bookings\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"propertyId\": 123,\n  \"startDate\": \"2024-02-01\",\n  \"endDate\": \"2024-02-28\",\n  \"message\": \"Looking forward to staying!\"\n}\n</code></pre>"},{"location":"api/tenant/#get-my-bookings","title":"Get My Bookings","text":"<pre><code>GET /api/bookings/my-bookings?status=APPROVED&amp;page=0\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#cancel-booking","title":"Cancel Booking","text":"<pre><code>PATCH /api/bookings/{id}/status\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"status\": \"CANCELLED\"\n}\n</code></pre>"},{"location":"api/tenant/#roommate-endpoints","title":"Roommate Endpoints","text":""},{"location":"api/tenant/#search-roommates","title":"Search Roommates","text":"<pre><code>GET /api/roommates?city=Dhaka&amp;gender=MALE&amp;page=0\n</code></pre>"},{"location":"api/tenant/#create-roommate-post","title":"Create Roommate Post","text":"<pre><code>POST /api/roommates\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"title\": \"Looking for roommate in Banani\",\n  \"description\": \"...\",\n  \"budget\": 10000,\n  \"preferredGender\": \"ANY\",\n  \"city\": \"Dhaka\"\n}\n</code></pre>"},{"location":"api/tenant/#get-my-roommate-posts","title":"Get My Roommate Posts","text":"<pre><code>GET /api/roommates/my-posts\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#messaging-endpoints","title":"Messaging Endpoints","text":""},{"location":"api/tenant/#get-conversations","title":"Get Conversations","text":"<pre><code>GET /api/messages/conversations\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#send-message","title":"Send Message","text":"<pre><code>POST /api/messages\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"conversationId\": 10,\n  \"content\": \"Is the property still available?\"\n}\n</code></pre>"},{"location":"api/tenant/#get-unread-count","title":"Get Unread Count","text":"<pre><code>GET /api/messages/unread-count\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#saved-items","title":"Saved Items","text":""},{"location":"api/tenant/#save-property","title":"Save Property","text":"<pre><code>POST /api/saved/properties/{propertyId}\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#get-saved-properties","title":"Get Saved Properties","text":"<pre><code>GET /api/saved/properties\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#remove-saved-property","title":"Remove Saved Property","text":"<pre><code>DELETE /api/saved/properties/{propertyId}\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#notifications","title":"Notifications","text":""},{"location":"api/tenant/#get-notifications","title":"Get Notifications","text":"<pre><code>GET /api/notifications?unreadOnly=true&amp;page=0\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#mark-all-as-read","title":"Mark All as Read","text":"<pre><code>POST /api/notifications/mark-all-read\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#profile","title":"Profile","text":""},{"location":"api/tenant/#get-my-profile","title":"Get My Profile","text":"<pre><code>GET /api/auth/me\nAuthorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"api/tenant/#update-profile","title":"Update Profile","text":"<pre><code>PUT /api/users/profile\nAuthorization: Bearer &lt;token&gt;\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"phoneNumber\": \"+8801712345678\",\n  \"bio\": \"Software developer looking for housing\"\n}\n</code></pre>"},{"location":"api/versioning/","title":"API Versioning","text":"<p>API versioning strategy and compatibility guidelines.</p>"},{"location":"api/versioning/#current-version","title":"Current Version","text":"<p>v1 \u2014 All current endpoints are version 1.</p>"},{"location":"api/versioning/#versioning-strategy","title":"Versioning Strategy","text":"<p>Design Decision</p> <p>StayMate uses URL-based versioning for explicit version control:</p> <pre><code>/api/v1/properties\n/api/v2/properties  (future)\n</code></pre> <p>Currently, the <code>/api/</code> prefix implies v1.</p>"},{"location":"api/versioning/#alternative-strategies-considered","title":"Alternative Strategies Considered","text":"Strategy Example Pros Cons URL Path \u2705 <code>/api/v1/...</code> Explicit, cacheable URL changes Header <code>Accept-Version: 1</code> Clean URLs Less discoverable Query <code>?version=1</code> Easy to add Not RESTful"},{"location":"api/versioning/#compatibility-rules","title":"Compatibility Rules","text":""},{"location":"api/versioning/#non-breaking-changes-minor","title":"Non-Breaking Changes (Minor)","text":"<p>These can be added without version bump:</p> <ul> <li>Adding new endpoints</li> <li>Adding optional request fields</li> <li>Adding response fields</li> <li>Adding new enum values</li> </ul>"},{"location":"api/versioning/#breaking-changes-major","title":"Breaking Changes (Major)","text":"<p>These require a new version:</p> <ul> <li>Removing endpoints</li> <li>Removing/renaming fields</li> <li>Changing field types</li> <li>Changing endpoint URLs</li> <li>Changing authentication</li> </ul>"},{"location":"api/versioning/#deprecation-policy","title":"Deprecation Policy","text":"<pre><code>timeline\n    title API Deprecation Timeline\n\n    v1 Release : v1 is current\n    v2 Release : v1 deprecated, v2 current\n    +6 months : v1 sunset warning\n    +12 months : v1 removed</code></pre>"},{"location":"api/versioning/#deprecation-headers","title":"Deprecation Headers","text":"<pre><code>HTTP/1.1 200 OK\nDeprecation: true\nSunset: Sat, 01 Jan 2025 00:00:00 GMT\nLink: &lt;https://api.staymate.com/api/v2/properties&gt;; rel=\"successor-version\"\n</code></pre>"},{"location":"api/versioning/#migration-guide-template","title":"Migration Guide Template","text":"<p>When v2 is released:</p> v1 Endpoint v2 Endpoint Changes <code>GET /api/properties</code> <code>GET /api/v2/properties</code> Pagination format <code>POST /api/bookings</code> <code>POST /api/v2/bookings</code> New required field"},{"location":"api/versioning/#sdk-versioning","title":"SDK Versioning","text":"<p>Future client SDKs will match API versions:</p> <pre><code>// JavaScript SDK\nimport { StayMateClient } from '@staymate/sdk-v1';\n\nconst client = new StayMateClient({\n  apiVersion: 'v1',\n  baseUrl: 'https://api.staymate.com'\n});\n</code></pre>"},{"location":"architecture/","title":"Architecture","text":"<p>This section provides a deep technical dive into StayMate's architecture, explaining not just what we built, but why and how.</p>"},{"location":"architecture/#system-overview","title":"System Overview","text":"<pre><code>graph TB\n    subgraph \"Client Layer\"\n        WEB[\"Next.js Frontend&lt;br/&gt;Port 3000\"]\n        API_CLIENT[\"REST API Clients\"]\n    end\n\n    subgraph \"Security Layer\"\n        CORS[\"CORS Filter\"]\n        RATE[\"RateLimitFilter\"]\n        JWT[\"JwtAuthenticationFilter\"]\n    end\n\n    subgraph \"Application Layer\"\n        AUTH[\"AuthController\"]\n        PROP[\"PropertyController\"]\n        BOOK[\"BookingController\"]\n        FIN[\"FinanceController\"]\n        MSG[\"MessageController\"]\n        ADMIN[\"AdminController\"]\n    end\n\n    subgraph \"Business Layer\"\n        AUTH_SVC[\"AuthService\"]\n        PROP_SVC[\"PropertyService\"]\n        BOOK_SVC[\"BookingService\"]\n        FIN_SVC[\"FinanceService\"]\n        NOT_SVC[\"NotificationService\"]\n    end\n\n    subgraph \"Data Layer\"\n        MYSQL[(\"MySQL 8.0&lt;br/&gt;Port 3306\")]\n        MINIO[\"MinIO Storage&lt;br/&gt;Port 9005\"]\n    end\n\n    WEB --&gt; CORS\n    API_CLIENT --&gt; CORS\n    CORS --&gt; RATE\n    RATE --&gt; JWT\n    JWT --&gt; AUTH &amp; PROP &amp; BOOK &amp; FIN &amp; MSG &amp; ADMIN\n    AUTH --&gt; AUTH_SVC\n    PROP --&gt; PROP_SVC\n    BOOK --&gt; BOOK_SVC\n    FIN --&gt; FIN_SVC\n    MSG --&gt; NOT_SVC\n    PROP_SVC &amp; BOOK_SVC &amp; FIN_SVC --&gt; MYSQL\n    PROP_SVC --&gt; MINIO</code></pre>"},{"location":"architecture/#architecture-decisions","title":"Architecture Decisions","text":"Decision Choice Rationale Framework Spring Boot 3.x Mature, enterprise-ready, great security Auth JWT (stateless) Horizontal scaling, no session management Database MySQL ACID compliance, proven at scale Storage MinIO S3-compatible, self-hosted Migrations Flyway Version-controlled schema changes"},{"location":"architecture/#in-this-section","title":"In This Section","text":"Document Description Clean Architecture Layered design and package structure Service Boundaries Domain module organization Request Lifecycle From HTTP request to response Data Flow How data moves through the system Event Flow Notification and messaging patterns Failure Handling Error handling and resilience"},{"location":"architecture/#key-components","title":"Key Components","text":""},{"location":"architecture/#security-chain","title":"Security Chain","text":"Order Filter Package Purpose 1 <code>CorsFilter</code> Spring Cross-origin handling 2 <code>RateLimitFilter</code> <code>auth.config</code> Token bucket throttling 3 <code>JwtAuthenticationFilter</code> <code>auth.security</code> Token validation"},{"location":"architecture/#domain-modules","title":"Domain Modules","text":"<pre><code>com.webapp.domain/\n\u251c\u2500\u2500 admin/          # 28 files - Platform management\n\u251c\u2500\u2500 booking/        # 9 files - Reservation system\n\u251c\u2500\u2500 finance/        # 23 files - Payments &amp; payouts\n\u251c\u2500\u2500 messaging/      # 17 files - Real-time chat\n\u251c\u2500\u2500 property/       # 18 files - Listing management\n\u251c\u2500\u2500 user/           # 18 files - User management\n\u2514\u2500\u2500 ... 17 more domains\n</code></pre>"},{"location":"architecture/architecture-review/","title":"Architecture Review","text":"<p>Critical review of StayMate's architecture against actual implementation.</p>"},{"location":"architecture/architecture-review/#purpose","title":"Purpose","text":"<p>This document serves as a design review to validate that documentation accurately reflects the codebase. It was created after analyzing:</p> <ul> <li><code>SecurityConfig.java</code> (196 lines)</li> <li><code>JwtTokenProvider.java</code> (146 lines)</li> <li><code>GlobalExceptionHandler.java</code> (160 lines)</li> <li><code>application.properties</code> (90 lines)</li> <li>110+ domain files across 23 modules</li> <li>55+ Flyway migrations</li> </ul>"},{"location":"architecture/architecture-review/#what-is-correct","title":"What Is Correct \u2705","text":""},{"location":"architecture/architecture-review/#1-security-filter-chain","title":"1. Security Filter Chain","text":"<p>The documented filter chain accurately reflects <code>SecurityConfig.java</code>:</p> <pre><code>flowchart TD\n    subgraph \"Actual Filter Order\"\n        REQ[HTTP Request] --&gt; CORS[CorsFilter]\n        CORS --&gt; RATE[RateLimitFilter]\n        RATE --&gt; JWT[JwtAuthenticationFilter]\n        JWT --&gt; AUTH[UsernamePasswordAuthenticationFilter]\n        AUTH --&gt; CTRL[Controller]\n    end</code></pre> <p>Verification: <pre><code>// SecurityConfig.java lines 140-145\n.addFilterBefore(rateLimitFilter, UsernamePasswordAuthenticationFilter.class)\n.addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class)\n</code></pre></p> <p>Order Matters</p> <p>RateLimitFilter runs before JWT to protect against unauthenticated brute force.</p>"},{"location":"architecture/architecture-review/#2-jwt-token-structure","title":"2. JWT Token Structure","text":"<p>The documented JWT claims are accurate:</p> Claim Access Token Refresh Token <code>sub</code> (userId) \u2705 \u2705 <code>email</code> \u2705 \u274c <code>roles</code> \u2705 \u274c <code>type</code> \u274c \u2705 (\"refresh\") <code>iat</code> \u2705 \u2705 <code>exp</code> \u2705 (15 min) \u2705 (7 days) <p>Verification: <pre><code>// JwtTokenProvider.java lines 53-61\nreturn Jwts.builder()\n    .subject(userPrincipal.getId().toString())\n    .claim(\"email\", userPrincipal.getEmail())\n    .claim(\"roles\", roles)\n    .issuedAt(now)\n    .expiration(expiryDate)\n    .signWith(key)\n    .compact();\n</code></pre></p>"},{"location":"architecture/architecture-review/#3-controller-service-repository-flow","title":"3. Controller \u2192 Service \u2192 Repository Flow","text":"<p>All domains follow this pattern correctly:</p> <pre><code>flowchart LR\n    subgraph \"Verified Pattern\"\n        C[PropertyController] --&gt;|calls| S[PropertyService]\n        S --&gt;|interface| R[PropertyRepository]\n        R --&gt;|JPA| DB[(MySQL)]\n    end</code></pre> <p>Verification: Every domain module contains: - <code>controller/</code> \u2192 REST endpoints - <code>service/</code> + <code>service/impl/</code> \u2192 Business logic - <code>repository/</code> \u2192 Data access</p>"},{"location":"architecture/architecture-review/#4-transaction-management","title":"4. Transaction Management","text":"<p>Documented behavior matches implementation:</p> <pre><code>// Service classes use:\n@Transactional(readOnly = true)  // Class-level default\n@Transactional                   // Method-level for writes\n</code></pre> <p>Design Decision</p> <p><code>readOnly = true</code> is the default to optimize read queries. Write operations explicitly override.</p>"},{"location":"architecture/architecture-review/#what-was-adjusted","title":"What Was Adjusted \u26a0\ufe0f","text":""},{"location":"architecture/architecture-review/#1-database-technology","title":"1. Database Technology","text":"Documentation Reality PostgreSQL MySQL 8.0 <p>Corrected: All database references now specify MySQL.</p> <p>Evidence: <pre><code># application.properties line 7\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n</code></pre></p>"},{"location":"architecture/architecture-review/#2-rate-limit-details","title":"2. Rate Limit Details","text":"Previous Actual Generic description Specific token bucket implementation <p>Updated Documentation: - 200 requests/minute (configurable) - Per-client bucket (authenticated user ID or IP) - 429 response on limit exceeded</p>"},{"location":"architecture/architecture-review/#3-oauth2-handler-chain","title":"3. OAuth2 Handler Chain","text":"<p>Previously missing from documentation:</p> <pre><code>flowchart TD\n    GAUTH[Google Auth] --&gt; CUSTOM[CustomOAuth2UserService]\n    CUSTOM --&gt; |New User| CREATE[Create Local User]\n    CUSTOM --&gt; |Existing| UPDATE[Update Last Login]\n    CUSTOM --&gt; SUCCESS[OAuth2AuthenticationSuccessHandler]\n    SUCCESS --&gt; COOKIE[HttpCookieOAuth2AuthorizationRequestRepository]\n    SUCCESS --&gt; REDIRECT[Redirect to Frontend]</code></pre> <p>Added: Complete OAuth2 handler documentation.</p>"},{"location":"architecture/architecture-review/#why-this-design-is-valid","title":"Why This Design Is Valid \u2705","text":""},{"location":"architecture/architecture-review/#stateless-jwt-architecture","title":"Stateless JWT Architecture","text":"<p>Decision: Use JWT instead of sessions.</p> <p>Trade-offs:</p> Pro Con Horizontal scaling Can't revoke tokens No session storage Larger request headers Self-contained Refresh token complexity <p>Mitigation: Short access token lifetime (15 min) + refresh tokens.</p>"},{"location":"architecture/architecture-review/#rbac-over-abac","title":"RBAC Over ABAC","text":"<p>Decision: Role-Based Access Control (ROLE_USER, ROLE_HOUSE_OWNER, ROLE_ADMIN).</p> <p>Why Not ABAC (Attribute-Based)?</p> <ul> <li>Simpler to implement and audit</li> <li>Roles map directly to user types</li> <li>Sufficient for current authorization needs</li> </ul> <p>Trade-off: Less granular than ABAC. Property-level access uses ownership checks in services.</p>"},{"location":"architecture/architecture-review/#layered-architecture-over-microservices","title":"Layered Architecture Over Microservices","text":"<p>Decision: Monolithic Spring Boot application.</p> <p>Justification:</p> Microservices Monolith (Chosen) Complex deployment Simple deployment Network latency In-process calls Service discovery N/A Good for: scaling teams Good for: scaling users <p>Trade-off: Module boundaries are package-based, not service-based. Clear interfaces allow future extraction.</p>"},{"location":"architecture/architecture-review/#known-limitations","title":"Known Limitations \u26a0\ufe0f","text":""},{"location":"architecture/architecture-review/#1-token-revocation","title":"1. Token Revocation","text":"<p>Limitation: JWTs cannot be revoked before expiration.</p> <p>Impact: If a token is stolen, attacker has 15-minute window.</p> <p>Mitigation: - Short access token lifetime - User can change password (invalidates sessions conceptually)</p> <p>Future: Consider token blacklist with Redis.</p>"},{"location":"architecture/architecture-review/#2-rate-limiting-memory","title":"2. Rate Limiting Memory","text":"<p>Limitation: In-memory token buckets.</p> <p>Impact: Rate limits don't persist across restarts; no cross-instance coordination.</p> <p>Mitigation: Single-instance deployment acceptable for current scale.</p> <p>Future: Redis-based rate limiting for multi-instance.</p>"},{"location":"architecture/architecture-review/#3-notification-delivery","title":"3. Notification Delivery","text":"<p>Limitation: Fire-and-forget notifications.</p> <p>Impact: Failed notifications are lost.</p> <p>Future: Implement outbox pattern for critical notifications (payments).</p>"},{"location":"architecture/architecture-review/#architecture-verification-status","title":"Architecture Verification Status","text":"Component Status Verified Against Security Filter Chain \u2705 Accurate SecurityConfig.java JWT Lifecycle \u2705 Accurate JwtTokenProvider.java RBAC Model \u2705 Accurate SecurityConfig + annotations Exception Handling \u2705 Accurate GlobalExceptionHandler.java Database Schema \u26a0\ufe0f Corrected MySQL (not PostgreSQL) Rate Limiting \u26a0\ufe0f Enhanced RateLimitFilter.java OAuth2 Flow \u26a0\ufe0f Enhanced oauth2 package"},{"location":"architecture/clean-architecture/","title":"Clean Architecture","text":"<p>StayMate follows a layered clean architecture pattern with strict dependency rules.</p>"},{"location":"architecture/clean-architecture/#layer-overview","title":"Layer Overview","text":"<pre><code>graph TB\n    subgraph \"Presentation Layer\"\n        CTRL[Controllers]\n        DTO_REQ[Request DTOs]\n        DTO_RES[Response DTOs]\n    end\n\n    subgraph \"Business Layer\"\n        SVC_INT[Service Interfaces]\n        SVC_IMPL[Service Implementations]\n        MAPPER[Mappers]\n    end\n\n    subgraph \"Persistence Layer\"\n        REPO[Repositories]\n        ENTITY[Entities]\n    end\n\n    subgraph \"Infrastructure\"\n        CONFIG[Configuration]\n        SECURITY[Security]\n        EXTERNAL[External Services]\n    end\n\n    CTRL --&gt; SVC_INT\n    SVC_IMPL --&gt; REPO\n    SVC_IMPL --&gt; MAPPER\n    MAPPER --&gt; ENTITY\n    MAPPER --&gt; DTO_RES\n\n    style CTRL fill:#3498db\n    style SVC_IMPL fill:#2ecc71\n    style REPO fill:#e74c3c</code></pre>"},{"location":"architecture/clean-architecture/#dependency-rule","title":"Dependency Rule","text":"<p>Critical Principle</p> <p>Dependencies flow inward only:</p> <ul> <li>Controllers depend on Services</li> <li>Services depend on Repositories</li> <li>Repositories depend on Entities</li> <li>No layer depends on an outer layer</li> </ul>"},{"location":"architecture/clean-architecture/#package-structure","title":"Package Structure","text":"<pre><code>com.webapp/\n\u251c\u2500\u2500 Application.java                 # Spring Boot entry point\n\u2502\n\u251c\u2500\u2500 auth/                            # Authentication module\n\u2502   \u251c\u2500\u2500 config/\n\u2502   \u2502   \u251c\u2500\u2500 SecurityConfig.java      # HTTP security chain\n\u2502   \u2502   \u251c\u2500\u2500 RateLimitFilter.java     # Token bucket rate limiting\n\u2502   \u2502   \u2514\u2500\u2500 WebSocketConfig.java     # WS configuration\n\u2502   \u251c\u2500\u2500 controller/\n\u2502   \u2502   \u2514\u2500\u2500 AuthController.java      # /api/auth endpoints\n\u2502   \u251c\u2500\u2500 dto/\n\u2502   \u2502   \u251c\u2500\u2500 request/                 # LoginRequest, RegisterRequest\n\u2502   \u2502   \u2514\u2500\u2500 response/                # AuthResponse\n\u2502   \u251c\u2500\u2500 security/\n\u2502   \u2502   \u251c\u2500\u2500 JwtAuthenticationFilter.java\n\u2502   \u2502   \u251c\u2500\u2500 JwtTokenProvider.java\n\u2502   \u2502   \u2514\u2500\u2500 oauth2/                  # Google OAuth2\n\u2502   \u251c\u2500\u2500 service/\n\u2502   \u2502   \u2514\u2500\u2500 impl/AuthServiceImpl.java\n\u2502   \u2514\u2500\u2500 exception/\n\u2502       \u2514\u2500\u2500 GlobalExceptionHandler.java\n\u2502\n\u251c\u2500\u2500 domain/                          # Business domains\n\u2502   \u251c\u2500\u2500 property/\n\u2502   \u2502   \u251c\u2500\u2500 controller/PropertyController.java\n\u2502   \u2502   \u251c\u2500\u2500 dto/\n\u2502   \u2502   \u251c\u2500\u2500 entity/Property.java\n\u2502   \u2502   \u251c\u2500\u2500 repository/PropertyRepository.java\n\u2502   \u2502   \u251c\u2500\u2500 service/PropertyService.java\n\u2502   \u2502   \u2514\u2500\u2500 mapper/PropertyMapper.java\n\u2502   \u251c\u2500\u2500 booking/\n\u2502   \u251c\u2500\u2500 finance/\n\u2502   \u2514\u2500\u2500 ... (23 total domains)\n\u2502\n\u2514\u2500\u2500 config/                          # Global configuration\n</code></pre>"},{"location":"architecture/clean-architecture/#layer-responsibilities","title":"Layer Responsibilities","text":""},{"location":"architecture/clean-architecture/#controller-layer","title":"Controller Layer","text":"<pre><code>@RestController\n@RequestMapping(\"/api/properties\")\n@RequiredArgsConstructor\npublic class PropertyController {\n\n    private final PropertyService propertyService;  // Service interface\n\n    @PostMapping\n    @PreAuthorize(\"hasRole('HOUSE_OWNER')\")\n    public ResponseEntity&lt;PropertyResponse&gt; create(\n            @Valid @RequestBody CreatePropertyRequest request) {\n        return ResponseEntity.status(HttpStatus.CREATED)\n                .body(propertyService.createProperty(request));\n    }\n}\n</code></pre> <p>Responsibilities:</p> <ul> <li>HTTP request/response handling</li> <li>Input validation (<code>@Valid</code>)</li> <li>Authorization (<code>@PreAuthorize</code>)</li> <li>Delegate to service layer</li> </ul> <p>Does NOT:</p> <ul> <li>Contain business logic</li> <li>Access repositories directly</li> <li>Handle entity transformations</li> </ul>"},{"location":"architecture/clean-architecture/#service-layer","title":"Service Layer","text":"<pre><code>@Service\n@RequiredArgsConstructor\n@Transactional(readOnly = true)\npublic class PropertyServiceImpl implements PropertyService {\n\n    private final PropertyRepository propertyRepository;\n    private final PropertyMapper propertyMapper;\n    private final UserService userService;\n\n    @Override\n    @Transactional\n    public PropertyResponse createProperty(CreatePropertyRequest request) {\n        User owner = userService.getCurrentUser();\n\n        Property property = propertyMapper.toEntity(request);\n        property.setOwner(owner);\n        property.setStatus(PropertyStatus.PENDING_REVIEW);\n\n        Property saved = propertyRepository.save(property);\n        return propertyMapper.toResponse(saved);\n    }\n}\n</code></pre> <p>Responsibilities:</p> <ul> <li>Business logic</li> <li>Transaction management</li> <li>Entity \u2194 DTO mapping (via mappers)</li> <li>Orchestration of multiple repositories</li> </ul>"},{"location":"architecture/clean-architecture/#repository-layer","title":"Repository Layer","text":"<pre><code>public interface PropertyRepository extends JpaRepository&lt;Property, Long&gt; {\n\n    Page&lt;Property&gt; findByOwner(User owner, Pageable pageable);\n\n    @Query(\"SELECT p FROM Property p WHERE p.status = :status\")\n    List&lt;Property&gt; findByStatus(@Param(\"status\") PropertyStatus status);\n\n    boolean existsByIdAndOwner(Long id, User owner);\n}\n</code></pre> <p>Responsibilities:</p> <ul> <li>Data access abstraction</li> <li>Query definitions</li> <li>Pagination support</li> </ul>"},{"location":"architecture/clean-architecture/#benefits","title":"Benefits","text":"Benefit How Achieved Testability Mock service interfaces in controller tests Maintainability Changes isolated to specific layer Flexibility Swap implementations without affecting other layers Readability Clear responsibility boundaries"},{"location":"architecture/data-flow/","title":"Data Flow","text":"<p>Understanding how data moves through StayMate for key business operations.</p>"},{"location":"architecture/data-flow/#booking-flow-most-complex","title":"Booking Flow (Most Complex)","text":"<p>The booking process involves multiple domains and state transitions.</p> <pre><code>sequenceDiagram\n    autonumber\n    participant T as Tenant\n    participant BC as BookingController\n    participant BS as BookingService\n    participant PS as PropertyService\n    participant NS as NotificationService\n    participant DB as Database\n    participant L as Landlord\n\n    T-&gt;&gt;BC: POST /api/bookings\n    BC-&gt;&gt;BS: createBooking(request)\n    BS-&gt;&gt;PS: validatePropertyAvailable(propertyId)\n    PS-&gt;&gt;DB: SELECT * FROM properties WHERE id = ?\n    DB--&gt;&gt;PS: Property entity\n    PS--&gt;&gt;BS: Property available\n\n    BS-&gt;&gt;DB: INSERT INTO bookings (status = 'PENDING')\n    DB--&gt;&gt;BS: Booking created\n\n    BS-&gt;&gt;NS: sendBookingNotification(landlord, booking)\n    NS-&gt;&gt;DB: INSERT INTO notifications\n    NS--&gt;&gt;L: Push notification\n\n    BS--&gt;&gt;BC: BookingResponse\n    BC--&gt;&gt;T: 201 Created\n\n    Note over L: Landlord reviews request\n\n    L-&gt;&gt;BC: PATCH /api/bookings/{id}/status\n    BC-&gt;&gt;BS: updateStatus(id, APPROVED)\n    BS-&gt;&gt;DB: UPDATE bookings SET status = 'APPROVED'\n\n    BS-&gt;&gt;NS: notifyTenant(booking)\n    NS--&gt;&gt;T: Booking approved!</code></pre>"},{"location":"architecture/data-flow/#property-listing-flow","title":"Property Listing Flow","text":"<pre><code>sequenceDiagram\n    participant L as Landlord\n    participant PC as PropertyController\n    participant PS as PropertyService\n    participant FS as FileStorageService\n    participant MINIO as MinIO\n    participant DB as MySQL\n\n    L-&gt;&gt;PC: POST /api/properties\n    Note over L,PC: With images\n\n    PC-&gt;&gt;FS: uploadImages(files)\n    FS-&gt;&gt;MINIO: PUT objects\n    MINIO--&gt;&gt;FS: URLs\n    FS--&gt;&gt;PC: Image URLs\n\n    PC-&gt;&gt;PS: createProperty(request, imageUrls)\n    PS-&gt;&gt;DB: INSERT INTO properties\n    DB--&gt;&gt;PS: Property ID\n\n    PS--&gt;&gt;PC: PropertyResponse\n    PC--&gt;&gt;L: 201 Created</code></pre>"},{"location":"architecture/data-flow/#authentication-flow","title":"Authentication Flow","text":"<pre><code>sequenceDiagram\n    participant U as User\n    participant AC as AuthController\n    participant AS as AuthService\n    participant US as UserService\n    participant JWT as JwtTokenProvider\n    participant DB as Database\n\n    U-&gt;&gt;AC: POST /api/auth/login\n    AC-&gt;&gt;AS: authenticate(email, password)\n    AS-&gt;&gt;US: findByEmail(email)\n    US-&gt;&gt;DB: SELECT * FROM users\n    DB--&gt;&gt;US: User entity\n\n    AS-&gt;&gt;AS: BCrypt.verify(password, hash)\n\n    alt Password invalid\n        AS--&gt;&gt;U: 401 Unauthorized\n    end\n\n    AS-&gt;&gt;JWT: generateAccessToken(user)\n    JWT--&gt;&gt;AS: Access token (15 min)\n    AS-&gt;&gt;JWT: generateRefreshToken(user)\n    JWT--&gt;&gt;AS: Refresh token (7 days)\n\n    AS-&gt;&gt;DB: UPDATE users SET last_login_at = NOW()\n\n    AS--&gt;&gt;AC: AuthResponse\n    AC--&gt;&gt;U: 200 OK + tokens</code></pre>"},{"location":"architecture/data-flow/#token-refresh-flow","title":"Token Refresh Flow","text":"<pre><code>sequenceDiagram\n    participant C as Client\n    participant AC as AuthController\n    participant JWT as JwtTokenProvider\n    participant US as UserService\n    participant DB as Database\n\n    C-&gt;&gt;AC: POST /api/auth/refresh-token\n    Note over C,AC: Body: { refreshToken }\n\n    AC-&gt;&gt;JWT: validateToken(refreshToken)\n    JWT-&gt;&gt;JWT: Check signature\n    JWT-&gt;&gt;JWT: Check expiration\n    JWT-&gt;&gt;JWT: Verify type = \"refresh\"\n\n    alt Token invalid\n        JWT--&gt;&gt;C: 401 Unauthorized\n    end\n\n    JWT-&gt;&gt;JWT: getUserIdFromToken()\n    AC-&gt;&gt;US: loadUserById(userId)\n    US-&gt;&gt;DB: SELECT * FROM users\n    DB--&gt;&gt;US: User entity\n\n    AC-&gt;&gt;JWT: generateAccessToken(user)\n    JWT--&gt;&gt;AC: New access token\n\n    AC--&gt;&gt;C: 200 OK + new tokens</code></pre>"},{"location":"architecture/data-flow/#financial-flow","title":"Financial Flow","text":"<pre><code>flowchart TD\n    subgraph \"Booking Complete\"\n        A[Check-out] --&gt; B[Calculate Earnings]\n    end\n\n    subgraph \"Landlord Actions\"\n        B --&gt; C[Credit to Balance]\n        C --&gt; D[Payout Request]\n        D --&gt; E[Select Method]\n    end\n\n    subgraph \"Admin Processing\"\n        E --&gt; F[Admin Review]\n        F --&gt; G{Approve?}\n        G --&gt;|Yes| H[Mark Processed]\n        G --&gt;|No| I[Reject with Reason]\n    end\n\n    H --&gt; J[Bank Transfer]</code></pre>"},{"location":"architecture/data-flow/#data-transformation","title":"Data Transformation","text":"Stage Format Request JSON \u2192 DTO Validation DTO \u2192 Validated DTO Mapping DTO \u2192 Entity Persistence Entity \u2192 Database Row Response Entity \u2192 DTO \u2192 JSON"},{"location":"architecture/event-flow/","title":"Event Flow","text":"<p>How notifications and asynchronous events flow through StayMate.</p>"},{"location":"architecture/event-flow/#notification-architecture","title":"Notification Architecture","text":"<pre><code>graph TB\n    subgraph \"Trigger Sources\"\n        BOOKING[Booking Events]\n        MESSAGE[New Messages]\n        REVIEW[Reviews]\n        SYSTEM[System Events]\n    end\n\n    subgraph \"Notification Service\"\n        NS[NotificationService]\n        QUEUE[Event Queue]\n    end\n\n    subgraph \"Delivery Channels\"\n        PUSH[Push Notification]\n        EMAIL[Email]\n        INAPP[In-App]\n        WS[WebSocket]\n    end\n\n    BOOKING --&gt; NS\n    MESSAGE --&gt; NS\n    REVIEW --&gt; NS\n    SYSTEM --&gt; NS\n\n    NS --&gt; QUEUE\n    QUEUE --&gt; PUSH\n    QUEUE --&gt; EMAIL\n    QUEUE --&gt; INAPP\n    QUEUE --&gt; WS</code></pre>"},{"location":"architecture/event-flow/#event-types","title":"Event Types","text":"Event Trigger Recipients Channels <code>BOOKING_REQUEST</code> Tenant creates booking Landlord Push, In-App <code>BOOKING_APPROVED</code> Landlord approves Tenant Push, In-App, Email <code>BOOKING_REJECTED</code> Landlord rejects Tenant Push, In-App <code>MESSAGE_RECEIVED</code> New message Recipient Push, In-App <code>REVIEW_RECEIVED</code> New review Property owner In-App <code>PAYOUT_PROCESSED</code> Payout completed Landlord Push, In-App, Email"},{"location":"architecture/event-flow/#booking-event-flow","title":"Booking Event Flow","text":"<pre><code>sequenceDiagram\n    participant BS as BookingService\n    participant NS as NotificationService\n    participant NR as NotificationRepository\n    participant WS as WebSocket\n    participant U as User\n\n    BS-&gt;&gt;NS: onBookingCreated(booking)\n    NS-&gt;&gt;NS: Build notification payload\n    NS-&gt;&gt;NR: save(notification)\n    NR--&gt;&gt;NS: Notification ID\n\n    NS-&gt;&gt;WS: broadcast(landlordId, event)\n    WS--&gt;&gt;U: Real-time update\n\n    Note over U: User sees notification</code></pre>"},{"location":"architecture/event-flow/#notification-entity","title":"Notification Entity","text":"<pre><code>@Entity\n@Table(name = \"notifications\")\npublic class Notification {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"user_id\")\n    private User user;\n\n    @Enumerated(EnumType.STRING)\n    private NotificationType type;\n\n    private String title;\n    private String message;\n\n    @JdbcTypeCode(SqlTypes.JSON)\n    private Map&lt;String, Object&gt; data;\n\n    private boolean read;\n    private LocalDateTime createdAt;\n}\n</code></pre>"},{"location":"architecture/event-flow/#message-event-flow","title":"Message Event Flow","text":"<pre><code>sequenceDiagram\n    participant S as Sender\n    participant MC as MessageController\n    participant MS as MessagingService\n    participant NS as NotificationService\n    participant WS as WebSocketHandler\n    participant R as Recipient\n\n    S-&gt;&gt;MC: POST /api/messages\n    MC-&gt;&gt;MS: sendMessage(request)\n    MS-&gt;&gt;MS: Save message\n    MS-&gt;&gt;NS: notifyNewMessage(recipient, message)\n    NS-&gt;&gt;WS: sendToUser(recipientId, payload)\n    WS--&gt;&gt;R: WebSocket event\n\n    alt Recipient offline\n        NS-&gt;&gt;NS: Queue for later\n    end</code></pre>"},{"location":"architecture/event-flow/#websocket-configuration","title":"WebSocket Configuration","text":"<pre><code>// WebSocketConfig.java\n@Configuration\n@EnableWebSocketMessageBroker\npublic class WebSocketConfig implements WebSocketMessageBrokerConfigurer {\n\n    @Override\n    public void configureMessageBroker(MessageBrokerRegistry config) {\n        config.enableSimpleBroker(\"/topic\", \"/queue\");\n        config.setApplicationDestinationPrefixes(\"/app\");\n    }\n\n    @Override\n    public void registerStompEndpoints(StompEndpointRegistry registry) {\n        registry.addEndpoint(\"/ws\")\n                .setAllowedOrigins(\"*\")\n                .withSockJS();\n    }\n}\n</code></pre>"},{"location":"architecture/event-flow/#event-patterns","title":"Event Patterns","text":""},{"location":"architecture/event-flow/#fire-and-forget","title":"Fire and Forget","text":"<pre><code>// Non-blocking notification\n@Async\npublic void sendNotification(Notification notification) {\n    notificationRepository.save(notification);\n    webSocketService.broadcast(notification);\n}\n</code></pre>"},{"location":"architecture/event-flow/#transactional-outbox-recommended-for-critical-events","title":"Transactional Outbox (Recommended for Critical Events)","text":"<pre><code>flowchart LR\n    TX[Transaction] --&gt; |1| DB[(Save Entity)]\n    TX --&gt; |2| OUTBOX[(Save to Outbox)]\n    SCHEDULER[Scheduler] --&gt; |3| OUTBOX\n    SCHEDULER --&gt; |4| SEND[Send Notification]\n    SEND --&gt; |5| MARK[Mark Sent]</code></pre> <p>Design Note</p> <p>Currently using fire-and-forget. Outbox pattern recommended for payment notifications.</p>"},{"location":"architecture/failure-handling/","title":"Failure Handling","text":"<p>How StayMate handles errors, recovers from failures, and maintains system stability.</p>"},{"location":"architecture/failure-handling/#error-handling-architecture","title":"Error Handling Architecture","text":"<pre><code>flowchart TD\n    REQ[Request] --&gt; CTRL[Controller]\n    CTRL --&gt; SVC[Service]\n    SVC --&gt; REPO[Repository]\n\n    CTRL --&gt;|Exception| GEH[GlobalExceptionHandler]\n    SVC --&gt;|Exception| GEH\n    REPO --&gt;|Exception| GEH\n\n    GEH --&gt; |Structured| ERR[Error Response]\n    ERR --&gt; CLIENT[Client]\n\n    style GEH fill:#e74c3c</code></pre>"},{"location":"architecture/failure-handling/#globalexceptionhandler","title":"GlobalExceptionHandler","text":"<p>Located at <code>com.webapp.auth.exception.GlobalExceptionHandler</code>:</p> <pre><code>@RestControllerAdvice\npublic class GlobalExceptionHandler {\n\n    @ExceptionHandler(ResourceNotFoundException.class)\n    public ResponseEntity&lt;ErrorResponse&gt; handleNotFound(\n            ResourceNotFoundException ex, WebRequest request) {\n        ErrorResponse error = ErrorResponse.builder()\n            .timestamp(LocalDateTime.now())\n            .status(HttpStatus.NOT_FOUND.value())\n            .error(\"Not Found\")\n            .message(ex.getMessage())\n            .path(request.getDescription(false))\n            .build();\n        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(error);\n    }\n\n    @ExceptionHandler(BadRequestException.class)\n    public ResponseEntity&lt;ErrorResponse&gt; handleBadRequest(...) {...}\n\n    @ExceptionHandler(UserAlreadyExistsException.class)\n    public ResponseEntity&lt;ErrorResponse&gt; handleDuplicate(...) {...}\n\n    @ExceptionHandler(MethodArgumentNotValidException.class)\n    public ResponseEntity&lt;ValidationErrorResponse&gt; handleValidation(...) {...}\n\n    @ExceptionHandler(AccessDeniedException.class)\n    public ResponseEntity&lt;ErrorResponse&gt; handleAccessDenied(...) {...}\n\n    @ExceptionHandler(Exception.class)\n    public ResponseEntity&lt;ErrorResponse&gt; handleGlobal(...) {...}\n}\n</code></pre>"},{"location":"architecture/failure-handling/#exception-hierarchy","title":"Exception Hierarchy","text":"<pre><code>classDiagram\n    RuntimeException &lt;|-- ResourceNotFoundException\n    RuntimeException &lt;|-- BadRequestException\n    RuntimeException &lt;|-- AuthenticationException\n    RuntimeException &lt;|-- UserAlreadyExistsException\n    RuntimeException &lt;|-- OAuth2AuthenticationProcessingException\n\n    class ResourceNotFoundException {\n        +String resource\n        +Long id\n    }\n\n    class BadRequestException {\n        +String message\n    }\n\n    class UserAlreadyExistsException {\n        +String email\n    }</code></pre>"},{"location":"architecture/failure-handling/#exception-to-http-mapping","title":"Exception to HTTP Mapping","text":"Exception HTTP Status When <code>ResourceNotFoundException</code> 404 Entity not found <code>BadRequestException</code> 400 Invalid input <code>AuthenticationException</code> 401 Auth failure <code>AccessDeniedException</code> 403 RBAC denial <code>UserAlreadyExistsException</code> 409 Duplicate user <code>MethodArgumentNotValidException</code> 400 Validation errors <code>BadCredentialsException</code> 401 Wrong password <code>Exception</code> (fallback) 500 Unexpected error"},{"location":"architecture/failure-handling/#error-response-formats","title":"Error Response Formats","text":""},{"location":"architecture/failure-handling/#standard-error","title":"Standard Error","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:00:00Z\",\n  \"status\": 404,\n  \"error\": \"Not Found\",\n  \"message\": \"Property not found with id: 999\",\n  \"path\": \"/api/properties/999\"\n}\n</code></pre>"},{"location":"architecture/failure-handling/#validation-error","title":"Validation Error","text":"<pre><code>{\n  \"timestamp\": \"2024-01-21T10:00:00Z\",\n  \"status\": 400,\n  \"error\": \"Bad Request\",\n  \"message\": \"Validation failed\",\n  \"errors\": [\n    {\"field\": \"email\", \"message\": \"must be a valid email\"},\n    {\"field\": \"password\", \"message\": \"must be at least 8 characters\"}\n  ]\n}\n</code></pre>"},{"location":"architecture/failure-handling/#resilience-patterns","title":"Resilience Patterns","text":""},{"location":"architecture/failure-handling/#circuit-breaker-recommended","title":"Circuit Breaker (Recommended)","text":"<p>Future Enhancement</p> <p>For external services (MinIO, email), implement circuit breaker pattern:</p> <pre><code>@CircuitBreaker(name = \"minio\", fallbackMethod = \"uploadFallback\")\npublic String uploadFile(MultipartFile file) {\n    return minioClient.upload(file);\n}\n</code></pre>"},{"location":"architecture/failure-handling/#retry-logic","title":"Retry Logic","text":"<pre><code>@Retryable(value = {TransientException.class}, maxAttempts = 3)\npublic void sendNotification(Notification notification) {\n    // Retry up to 3 times on transient failures\n}\n</code></pre>"},{"location":"architecture/failure-handling/#graceful-degradation","title":"Graceful Degradation","text":"<pre><code>public List&lt;PropertyResponse&gt; getRecommended(Long userId) {\n    try {\n        return aiService.getRecommendations(userId);\n    } catch (AiServiceException e) {\n        log.warn(\"AI service unavailable, falling back to popular\");\n        return getPopularProperties();  // Fallback\n    }\n}\n</code></pre>"},{"location":"architecture/failure-handling/#database-failure-handling","title":"Database Failure Handling","text":""},{"location":"architecture/failure-handling/#transaction-rollback","title":"Transaction Rollback","text":"<pre><code>@Transactional\npublic BookingResponse createBooking(BookingRequest request) {\n    Booking booking = bookingRepository.save(entity);\n\n    // If notification fails, booking is NOT rolled back\n    notificationService.notify(booking);\n\n    return mapper.toResponse(booking);\n}\n</code></pre> <p>Design Decision</p> <p>Notifications are fire-and-forget. Booking success doesn't depend on notification success.</p>"},{"location":"architecture/failure-handling/#logging-failures","title":"Logging Failures","text":"<pre><code>@ExceptionHandler(Exception.class)\npublic ResponseEntity&lt;ErrorResponse&gt; handleGlobal(Exception ex, WebRequest request) {\n    log.error(\"Unexpected error: {}\", ex.getMessage(), ex);\n\n    // Don't expose internal details to client\n    return ResponseEntity.status(500)\n        .body(new ErrorResponse(\"Internal Server Error\"));\n}\n</code></pre>"},{"location":"architecture/request-lifecycle/","title":"Request Lifecycle","text":"<p>Every HTTP request to StayMate passes through a well-defined processing pipeline.</p>"},{"location":"architecture/request-lifecycle/#complete-request-flow","title":"Complete Request Flow","text":"<pre><code>flowchart TD\n    subgraph CLIENT[\"\ud83d\udcf1 Client\"]\n        REQ[\"HTTP Request\"]\n    end\n\n    subgraph SECURITY[\"\ud83d\udd12 Security Layer\"]\n        CORS[\"CorsFilter&lt;br/&gt;&lt;small&gt;Check allowed origins&lt;/small&gt;\"]\n        RATE[\"RateLimitFilter&lt;br/&gt;&lt;small&gt;Token bucket check&lt;/small&gt;\"]\n        JWT[\"JwtAuthenticationFilter&lt;br/&gt;&lt;small&gt;Validate Bearer token&lt;/small&gt;\"]\n    end\n\n    subgraph APP[\"\u2699\ufe0f Application Layer\"]\n        CTRL[\"Controller&lt;br/&gt;&lt;small&gt;@RestController&lt;/small&gt;\"]\n        VALID[\"@Valid&lt;br/&gt;&lt;small&gt;Bean Validation&lt;/small&gt;\"]\n        AUTH[\"@PreAuthorize&lt;br/&gt;&lt;small&gt;RBAC Check&lt;/small&gt;\"]\n    end\n\n    subgraph BIZ[\"\ud83d\udcbc Business Layer\"]\n        SVC[\"Service&lt;br/&gt;&lt;small&gt;@Transactional&lt;/small&gt;\"]\n        MAP[\"Mapper&lt;br/&gt;&lt;small&gt;Entity \u2194 DTO&lt;/small&gt;\"]\n    end\n\n    subgraph DATA[\"\ud83d\udcbe Data Layer\"]\n        REPO[\"Repository&lt;br/&gt;&lt;small&gt;Spring Data JPA&lt;/small&gt;\"]\n        DB[(\"MySQL&lt;br/&gt;Port 3306\")]\n    end\n\n    REQ --&gt; CORS\n    CORS --&gt;|\"\u2705 Origin OK\"| RATE\n    CORS --&gt;|\"\u274c Blocked\"| REJECT1[\"403 Forbidden\"]\n\n    RATE --&gt;|\"\u2705 Under limit\"| JWT\n    RATE --&gt;|\"\u274c Exceeded\"| REJECT2[\"429 Too Many Requests\"]\n\n    JWT --&gt;|\"\u2705 Valid token\"| CTRL\n    JWT --&gt;|\"\u274c Invalid/Missing\"| REJECT3[\"401 Unauthorized\"]\n\n    CTRL --&gt; VALID\n    VALID --&gt;|\"\u274c Invalid\"| REJECT4[\"400 Bad Request\"]\n    VALID --&gt;|\"\u2705 Valid\"| AUTH\n\n    AUTH --&gt;|\"\u274c No permission\"| REJECT5[\"403 Forbidden\"]\n    AUTH --&gt;|\"\u2705 Authorized\"| SVC\n\n    SVC --&gt; MAP\n    MAP --&gt; REPO\n    REPO --&gt; DB\n    DB --&gt; REPO\n    REPO --&gt; MAP\n    MAP --&gt; SVC\n    SVC --&gt; CTRL\n    CTRL --&gt; RESPONSE[\"HTTP Response\"]\n\n    style SECURITY fill:#e74c3c,color:#fff\n    style APP fill:#3498db,color:#fff\n    style BIZ fill:#2ecc71,color:#fff\n    style DATA fill:#9b59b6,color:#fff</code></pre>"},{"location":"architecture/request-lifecycle/#detailed-sequence","title":"Detailed Sequence","text":"<pre><code>sequenceDiagram\n    autonumber\n    participant C as Client\n    participant CORS as CorsFilter\n    participant Rate as RateLimitFilter\n    participant JWT as JwtAuthFilter\n    participant Sec as SecurityContext\n    participant Ctrl as Controller\n    participant Valid as @Valid\n    participant Svc as Service\n    participant Repo as Repository\n    participant DB as MySQL\n\n    C-&gt;&gt;CORS: HTTP Request\n    Note over CORS: Check Origin header&lt;br/&gt;Match against allowed origins\n    CORS-&gt;&gt;Rate: Pass request\n\n    Note over Rate: Get client identifier&lt;br/&gt;(userId or IP address)\n    Rate-&gt;&gt;Rate: TokenBucket.tryConsume()\n\n    alt Rate limit exceeded\n        Rate--&gt;&gt;C: 429 Too Many Requests\n    end\n\n    Rate-&gt;&gt;JWT: Pass request\n    Note over JWT: Extract \"Bearer\" token&lt;br/&gt;from Authorization header\n    JWT-&gt;&gt;JWT: jwtTokenProvider.validateToken()\n\n    alt Token invalid or missing\n        JWT--&gt;&gt;C: 401 Unauthorized\n    end\n\n    JWT-&gt;&gt;JWT: getUserIdFromToken()\n    JWT-&gt;&gt;Sec: Set Authentication\n    Note over Sec: UserPrincipal with&lt;br/&gt;roles and permissions\n\n    Sec-&gt;&gt;Ctrl: Dispatch to @RequestMapping\n    Ctrl-&gt;&gt;Valid: Validate @RequestBody\n\n    alt Validation failed\n        Valid--&gt;&gt;C: 400 Bad Request&lt;br/&gt;with field errors\n    end\n\n    Note over Ctrl: Check @PreAuthorize&lt;br/&gt;hasRole('HOUSE_OWNER')\n\n    alt Not authorized\n        Ctrl--&gt;&gt;C: 403 Forbidden\n    end\n\n    Ctrl-&gt;&gt;Svc: Business method call\n    Note over Svc: @Transactional begins\n    Svc-&gt;&gt;Repo: Repository method\n    Repo-&gt;&gt;DB: SQL Query\n    DB--&gt;&gt;Repo: ResultSet\n    Repo--&gt;&gt;Svc: Entity\n    Note over Svc: @Transactional commits\n    Svc--&gt;&gt;Ctrl: Response DTO\n    Ctrl--&gt;&gt;C: 200 OK + JSON</code></pre>"},{"location":"architecture/request-lifecycle/#filter-chain-actual-code","title":"Filter Chain (Actual Code)","text":"<p>From <code>SecurityConfig.java</code>:</p> <pre><code>// Lines 140-145\n.addFilterBefore(rateLimitFilter, UsernamePasswordAuthenticationFilter.class)\n.addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class)\n</code></pre> <p>Filter Order</p> <p>Both filters run before <code>UsernamePasswordAuthenticationFilter</code>, but the order between them is determined by their <code>@Order</code> annotations. RateLimitFilter runs first.</p>"},{"location":"architecture/request-lifecycle/#rate-limit-details","title":"Rate Limit Details","text":"<p>From <code>RateLimitFilter.java</code>:</p> <pre><code>flowchart LR\n    subgraph \"Token Bucket Algorithm\"\n        REQ[Request] --&gt; ID[Get Client ID]\n        ID --&gt; BUCKET[\"Get/Create Bucket&lt;br/&gt;(200 tokens max)\"]\n        BUCKET --&gt; TRY{tryConsume?}\n        TRY --&gt;|\"tokens &gt; 0\"| ALLOW[Allow Request]\n        TRY --&gt;|\"tokens = 0\"| DENY[429 Response]\n\n        REFILL[Timer] --&gt;|\"3.33 tokens/sec\"| BUCKET\n    end</code></pre> <p>Client Identification: 1. Authenticated user: <code>user:{userId}</code> 2. Anonymous: <code>ip:{remoteAddr}</code> or <code>ip:{X-Forwarded-For}</code></p>"},{"location":"architecture/request-lifecycle/#jwt-validation-steps","title":"JWT Validation Steps","text":"<p>From <code>JwtTokenProvider.java</code>:</p> <pre><code>public boolean validateToken(String authToken) {\n    try {\n        Jwts.parser()\n            .verifyWith(key)           // 1. Verify signature\n            .build()\n            .parseSignedClaims(token); // 2. Parse claims\n        return true;                   // 3. Check expiration (auto)\n    } catch (SignatureException ex) {\n        logger.error(\"Invalid JWT signature\");\n    } catch (ExpiredJwtException ex) {\n        logger.error(\"Expired JWT token\");\n    }\n    // ... other exceptions\n    return false;\n}\n</code></pre>"},{"location":"architecture/request-lifecycle/#transaction-boundaries","title":"Transaction Boundaries","text":"<pre><code>sequenceDiagram\n    participant Controller\n    participant Service\n    participant Repo1 as PropertyRepo\n    participant Repo2 as NotificationRepo\n    participant DB as MySQL\n\n    Controller-&gt;&gt;Service: createProperty(request)\n\n    rect rgb(200, 230, 200)\n        Note over Service,DB: @Transactional scope\n        Service-&gt;&gt;Repo1: save(property)\n        Repo1-&gt;&gt;DB: INSERT INTO properties\n        DB--&gt;&gt;Repo1: OK\n\n        Service-&gt;&gt;Repo2: save(notification)\n        Repo2-&gt;&gt;DB: INSERT INTO notifications\n        DB--&gt;&gt;Repo2: OK\n\n        Note over Service: Commit on return\n    end\n\n    Service--&gt;&gt;Controller: PropertyResponse</code></pre> <p>Notification Caveat</p> <p>If notification save fails, the entire transaction rolls back including the property. Consider async notifications for non-critical cases.</p>"},{"location":"architecture/service-boundaries/","title":"Service Boundaries","text":"<p>StayMate organizes business logic into 23 domain modules, each with clear boundaries.</p>"},{"location":"architecture/service-boundaries/#domain-map","title":"Domain Map","text":"<pre><code>graph TB\n    subgraph \"Core Domains\"\n        USER[User]\n        PROPERTY[Property]\n        BOOKING[Booking]\n    end\n\n    subgraph \"Financial Domains\"\n        FINANCE[Finance]\n        PAYOUT[Payout]\n    end\n\n    subgraph \"Communication Domains\"\n        MESSAGING[Messaging]\n        NOTIFICATION[Notification]\n    end\n\n    subgraph \"Trust &amp; Safety\"\n        VERIFICATION[Verification]\n        REVIEW[Review]\n        REPORT[Report]\n    end\n\n    subgraph \"Administration\"\n        ADMIN[Admin]\n        AUDIT[Audit]\n        DASHBOARD[Dashboard]\n    end\n\n    USER --&gt; PROPERTY\n    USER --&gt; BOOKING\n    PROPERTY --&gt; BOOKING\n    BOOKING --&gt; FINANCE\n    BOOKING --&gt; NOTIFICATION\n    MESSAGING --&gt; NOTIFICATION</code></pre>"},{"location":"architecture/service-boundaries/#module-inventory","title":"Module Inventory","text":"Domain Files Purpose <code>admin</code> 28 Platform administration, analytics, fraud <code>ai</code> 6 AI-powered recommendations <code>application</code> 9 Roommate applications <code>audit</code> 5 Audit logging <code>booking</code> 9 Property reservations <code>contact</code> 3 Contact form handling <code>dashboard</code> 16 User/landlord/admin dashboards <code>file</code> 4 File upload/download <code>finance</code> 23 Earnings, payments, payouts <code>landlord</code> 5 Landlord-specific features <code>maintenance</code> 6 Maintenance requests <code>match</code> 8 User matching <code>messaging</code> 17 Real-time chat <code>notification</code> 18 Push/email notifications <code>property</code> 18 Property listing management <code>report</code> 7 Reporting system <code>review</code> 7 User/property reviews <code>roommate</code> 9 Roommate posts <code>saved</code> 6 Saved properties/roommates <code>setting</code> 4 User settings <code>support</code> 12 Support tickets <code>user</code> 18 User management <code>verification</code> 8 Identity verification"},{"location":"architecture/service-boundaries/#module-structure","title":"Module Structure","text":"<p>Each domain follows a consistent internal structure:</p> <pre><code>domain/booking/\n\u251c\u2500\u2500 controller/\n\u2502   \u2514\u2500\u2500 BookingController.java\n\u251c\u2500\u2500 dto/\n\u2502   \u251c\u2500\u2500 BookingRequest.java\n\u2502   \u2514\u2500\u2500 BookingResponse.java\n\u251c\u2500\u2500 entity/\n\u2502   \u2514\u2500\u2500 Booking.java\n\u251c\u2500\u2500 enums/\n\u2502   \u2514\u2500\u2500 BookingStatus.java\n\u251c\u2500\u2500 mapper/\n\u2502   \u2514\u2500\u2500 BookingMapper.java\n\u251c\u2500\u2500 repository/\n\u2502   \u2514\u2500\u2500 BookingRepository.java\n\u2514\u2500\u2500 service/\n    \u251c\u2500\u2500 BookingService.java\n    \u2514\u2500\u2500 impl/\n        \u2514\u2500\u2500 BookingServiceImpl.java\n</code></pre>"},{"location":"architecture/service-boundaries/#boundary-rules","title":"Boundary Rules","text":"<p>Cross-Domain Communication</p> <p>Domains should communicate through service interfaces, not direct repository access.</p> <pre><code>// \u2705 Good - Use service interface\n@Service\npublic class BookingServiceImpl {\n    private final NotificationService notificationService;\n\n    public void approveBooking(Long id) {\n        // ... booking logic\n        notificationService.sendBookingApproval(booking);\n    }\n}\n\n// \u274c Bad - Direct repository access\n@Service\npublic class BookingServiceImpl {\n    private final NotificationRepository notificationRepository;  // Don't do this\n}\n</code></pre>"},{"location":"architecture/service-boundaries/#domain-dependencies","title":"Domain Dependencies","text":"<pre><code>flowchart TD\n    BOOKING --&gt; USER\n    BOOKING --&gt; PROPERTY\n    BOOKING --&gt; NOTIFICATION\n    FINANCE --&gt; BOOKING\n    FINANCE --&gt; USER\n    MESSAGING --&gt; USER\n    MESSAGING --&gt; NOTIFICATION\n    REVIEW --&gt; USER\n    REVIEW --&gt; PROPERTY\n    ADMIN --&gt; USER\n    ADMIN --&gt; PROPERTY\n    ADMIN --&gt; FINANCE</code></pre>"},{"location":"architecture/service-boundaries/#shared-code","title":"Shared Code","text":"<p>Cross-cutting concerns live outside domains:</p> Package Purpose <code>auth.exception</code> GlobalExceptionHandler <code>auth.security</code> JWT, OAuth2 <code>config</code> Global configuration <code>scheduler</code> Background jobs"},{"location":"backend/","title":"Backend Internals","text":"<p>Deep dive into StayMate's backend implementation.</p>"},{"location":"backend/#module-structure","title":"Module Structure","text":"<p>Each domain follows a consistent pattern:</p> <pre><code>domain/{name}/\n\u251c\u2500\u2500 controller/      # REST endpoints\n\u251c\u2500\u2500 dto/             # Request/Response objects\n\u251c\u2500\u2500 entity/          # JPA entities\n\u251c\u2500\u2500 enums/           # Domain enumerations\n\u251c\u2500\u2500 mapper/          # Entity \u2194 DTO conversion\n\u251c\u2500\u2500 repository/      # Data access\n\u2514\u2500\u2500 service/         # Business logic\n    \u2514\u2500\u2500 impl/        # Service implementations\n</code></pre>"},{"location":"backend/#in-this-section","title":"In This Section","text":"Document Description Module Design Domain organization Service Layer Business logic patterns Repository Layer Data access DTO Mapping Entity transformation Validation Input validation Exception Handling Error management"},{"location":"backend/#key-statistics","title":"Key Statistics","text":"Metric Value Domain Modules 23 Total Java Files 300+ Controllers 25+ Services 30+ Entities 20+"},{"location":"backend/dto-mapping/","title":"DTO Mapping","text":"<p>Entity to DTO conversion patterns.</p>"},{"location":"backend/dto-mapping/#mapper-pattern","title":"Mapper Pattern","text":"<pre><code>@Component\npublic class PropertyMapper {\n\n    public PropertyResponse toResponse(Property property) {\n        PropertyResponse response = new PropertyResponse();\n        response.setId(property.getId());\n        response.setTitle(property.getTitle());\n        response.setPrice(property.getPrice());\n        return response;\n    }\n\n    public Property toEntity(CreatePropertyRequest request) {\n        Property property = new Property();\n        property.setTitle(request.getTitle());\n        property.setPrice(request.getPrice());\n        return property;\n    }\n}\n</code></pre>"},{"location":"backend/dto-mapping/#benefits","title":"Benefits","text":"<ul> <li>Separation of API contract from entities</li> <li>Security: hide internal fields</li> <li>Flexibility: independent evolution</li> </ul>"},{"location":"backend/exception-handling/","title":"Exception Handling","text":"<p>Centralized error handling with GlobalExceptionHandler.</p>"},{"location":"backend/exception-handling/#handler","title":"Handler","text":"<pre><code>@RestControllerAdvice\npublic class GlobalExceptionHandler {\n\n    @ExceptionHandler(ResourceNotFoundException.class)\n    public ResponseEntity&lt;ErrorResponse&gt; handleNotFound(\n            ResourceNotFoundException ex) {\n        return ResponseEntity.status(404)\n            .body(new ErrorResponse(\"Not Found\", ex.getMessage()));\n    }\n}\n</code></pre>"},{"location":"backend/exception-handling/#exception-mapping","title":"Exception Mapping","text":"Exception HTTP Status ResourceNotFoundException 404 BadRequestException 400 AccessDeniedException 403 AuthenticationException 401 <p>See Failure Handling for details.</p>"},{"location":"backend/module-design/","title":"Module Design","text":"<p>Domain module organization patterns.</p>"},{"location":"backend/module-design/#standard-module-structure","title":"Standard Module Structure","text":"<pre><code>domain/{name}/\n\u251c\u2500\u2500 controller/     # REST endpoints\n\u251c\u2500\u2500 dto/            # Request/Response\n\u251c\u2500\u2500 entity/         # JPA entities\n\u251c\u2500\u2500 enums/          # Domain enums\n\u251c\u2500\u2500 mapper/         # Entity \u2194 DTO\n\u251c\u2500\u2500 repository/     # Data access\n\u2514\u2500\u2500 service/        # Business logic\n    \u2514\u2500\u2500 impl/\n</code></pre>"},{"location":"backend/module-design/#module-inventory","title":"Module Inventory","text":"Module Controllers Services Entities admin 3 3 3 booking 1 1 1 finance 1 1 2 messaging 1 1 2 property 1 1 1 user 1 1 1"},{"location":"backend/repository-layer/","title":"Repository Layer","text":"<p>Data access patterns with Spring Data JPA.</p>"},{"location":"backend/repository-layer/#interface-pattern","title":"Interface Pattern","text":"<pre><code>public interface PropertyRepository extends JpaRepository&lt;Property, Long&gt; {\n\n    Page&lt;Property&gt; findByOwner(User owner, Pageable pageable);\n\n    @Query(\"SELECT p FROM Property p WHERE p.status = :status\")\n    List&lt;Property&gt; findByStatus(@Param(\"status\") PropertyStatus status);\n\n    boolean existsByIdAndOwner(Long id, User owner);\n}\n</code></pre>"},{"location":"backend/repository-layer/#key-features","title":"Key Features","text":"<ul> <li>Extends <code>JpaRepository</code> for CRUD</li> <li>Query methods from naming conventions</li> <li>Custom <code>@Query</code> for complex queries</li> <li>Pagination with <code>Pageable</code></li> </ul>"},{"location":"backend/service-layer/","title":"Service Layer","text":"<p>Business logic implementation patterns.</p>"},{"location":"backend/service-layer/#pattern","title":"Pattern","text":"<pre><code>@Service\n@RequiredArgsConstructor\n@Transactional(readOnly = true)\npublic class PropertyServiceImpl implements PropertyService {\n\n    private final PropertyRepository propertyRepository;\n    private final PropertyMapper propertyMapper;\n\n    @Override\n    @Transactional\n    public PropertyResponse createProperty(CreatePropertyRequest request) {\n        Property property = propertyMapper.toEntity(request);\n        Property saved = propertyRepository.save(property);\n        return propertyMapper.toResponse(saved);\n    }\n}\n</code></pre>"},{"location":"backend/service-layer/#best-practices","title":"Best Practices","text":"<ul> <li>Use <code>@Transactional(readOnly = true)</code> as default</li> <li>Inject interfaces, not implementations</li> <li>Keep business logic in services, not controllers</li> <li>Use mappers for DTO conversions</li> </ul>"},{"location":"backend/validation/","title":"Validation","text":"<p>Input validation with Bean Validation.</p>"},{"location":"backend/validation/#request-validation","title":"Request Validation","text":"<pre><code>public class CreatePropertyRequest {\n\n    @NotBlank(message = \"Title is required\")\n    @Size(max = 200)\n    private String title;\n\n    @NotNull(message = \"Price is required\")\n    @Positive\n    private BigDecimal price;\n\n    @Valid\n    @NotNull\n    private LocationRequest location;\n}\n</code></pre>"},{"location":"backend/validation/#controller-usage","title":"Controller Usage","text":"<pre><code>@PostMapping\npublic ResponseEntity&lt;PropertyResponse&gt; create(\n        @Valid @RequestBody CreatePropertyRequest request) {\n    // Validation errors \u2192 400 Bad Request\n}\n</code></pre>"},{"location":"database/","title":"Database","text":"<p>MySQL database architecture and schema design.</p>"},{"location":"database/#overview","title":"Overview","text":"Component Technology Database MySQL 8.0+ ORM Hibernate (JPA) Migrations Flyway Pool HikariCP"},{"location":"database/#entity-relationship-diagram","title":"Entity Relationship Diagram","text":"<pre><code>erDiagram\n    USER ||--o{ PROPERTY : owns\n    USER ||--o{ BOOKING : makes\n    USER ||--o{ BOOKING : receives\n    USER ||--o{ REVIEW : writes\n    USER ||--o{ MESSAGE : sends\n    USER ||--o{ NOTIFICATION : receives\n    USER ||--o{ PAYOUT_METHOD : has\n    USER ||--o{ VERIFICATION_REQUEST : submits\n\n    PROPERTY ||--o{ BOOKING : has\n    PROPERTY ||--o{ REVIEW : receives\n    PROPERTY ||--o{ SAVED_ITEM : savedBy\n    PROPERTY ||--o{ MAINTENANCE_REQUEST : has\n\n    CONVERSATION ||--o{ MESSAGE : contains\n    CONVERSATION }o--o{ USER : participants\n\n    BOOKING ||--o{ PAYMENT : generates</code></pre>"},{"location":"database/#in-this-section","title":"In This Section","text":"Document Description Schema Design Table structures Entity Relationships ER diagrams Indexing Strategy Performance indexes Transactions Transaction management Migrations Flyway migrations"},{"location":"database/#key-entities","title":"Key Entities","text":"Entity Table Records User <code>users</code> Core identity Property <code>properties</code> Listings Booking <code>bookings</code> Reservations Message <code>messages</code> Chat Notification <code>notifications</code> Alerts"},{"location":"database/entity-relationships/","title":"Entity Relationships","text":"<p>Complete entity relationship diagram for StayMate.</p>"},{"location":"database/entity-relationships/#full-er-diagram","title":"Full ER Diagram","text":"<pre><code>erDiagram\n    USER {\n        Long id PK\n        String email UK\n        String password_hash\n        String first_name\n        String last_name\n        String phone_number\n        String profile_picture_url\n        AuthProvider auth_provider\n        Set roles\n        Boolean email_verified\n        LocalDateTime created_at\n    }\n\n    PROPERTY {\n        Long id PK\n        String title\n        Text description\n        BigDecimal price\n        BigDecimal deposit\n        PropertyType type\n        PropertyStatus status\n        Integer bedrooms\n        Integer bathrooms\n        String address\n        String city\n        Long owner_id FK\n        LocalDateTime created_at\n    }\n\n    BOOKING {\n        Long id PK\n        Long property_id FK\n        Long tenant_id FK\n        LocalDate start_date\n        LocalDate end_date\n        BookingStatus status\n        BigDecimal total_amount\n        LocalDateTime check_in\n        LocalDateTime check_out\n    }\n\n    MESSAGE {\n        Long id PK\n        Long conversation_id FK\n        Long sender_id FK\n        Text content\n        Boolean read\n        LocalDateTime created_at\n    }\n\n    NOTIFICATION {\n        Long id PK\n        Long user_id FK\n        NotificationType type\n        String title\n        String message\n        Boolean read\n        LocalDateTime created_at\n    }\n\n    REVIEW {\n        Long id PK\n        Long reviewer_id FK\n        Long reviewee_id FK\n        Long property_id FK\n        Integer rating\n        Text comment\n        LocalDateTime created_at\n    }\n\n    USER ||--o{ PROPERTY : owns\n    USER ||--o{ BOOKING : \"makes (tenant)\"\n    PROPERTY ||--o{ BOOKING : has\n    USER ||--o{ MESSAGE : sends\n    USER ||--o{ NOTIFICATION : receives\n    USER ||--o{ REVIEW : writes\n    PROPERTY ||--o{ REVIEW : receives</code></pre>"},{"location":"database/entity-relationships/#core-relationships","title":"Core Relationships","text":"Parent Child Type Description User Property One-to-Many Landlord owns properties User Booking One-to-Many Tenant makes bookings Property Booking One-to-Many Property has bookings User Message One-to-Many User sends messages User Notification One-to-Many User receives notifications User Review One-to-Many User writes reviews"},{"location":"database/indexing-strategy/","title":"Indexing Strategy","text":"<p>Performance indexes for query optimization.</p>"},{"location":"database/indexing-strategy/#key-indexes","title":"Key Indexes","text":"<pre><code>-- Auth lookups\nCREATE INDEX idx_users_email ON users(email);\n\n-- Property searches\nCREATE INDEX idx_properties_owner ON properties(owner_id);\nCREATE INDEX idx_properties_status ON properties(status);\nCREATE INDEX idx_properties_city ON properties(city);\n\n-- Booking queries\nCREATE INDEX idx_bookings_property ON bookings(property_id);\nCREATE INDEX idx_bookings_tenant ON bookings(tenant_id);\nCREATE INDEX idx_bookings_status ON bookings(status);\n\n-- Notifications\nCREATE INDEX idx_notifications_user ON notifications(user_id);\nCREATE INDEX idx_notifications_read ON notifications(user_id, read);\n</code></pre>"},{"location":"database/indexing-strategy/#migration-references","title":"Migration References","text":"Index Migration Auth indexes V112 Dashboard indexes V111 Performance indexes V33"},{"location":"database/migrations/","title":"Migrations","text":"<p>Flyway database migrations for StayMate.</p>"},{"location":"database/migrations/#overview","title":"Overview","text":"<p>StayMate uses Flyway for version-controlled schema migrations.</p> <pre><code>src/main/resources/db/migration/\n\u251c\u2500\u2500 V1__init_schema.sql\n\u251c\u2500\u2500 V2__create_property_table.sql\n\u251c\u2500\u2500 V3_1__create_bookings_table.sql\n\u251c\u2500\u2500 ...\n\u2514\u2500\u2500 V120__alter_verification_requests_status.sql\n</code></pre>"},{"location":"database/migrations/#migration-stats","title":"Migration Stats","text":"Metric Value Total Migrations 55+ Schema Version V120 Naming Convention <code>V{version}__{description}.sql</code>"},{"location":"database/migrations/#key-migrations","title":"Key Migrations","text":"Version Description V1 Initial schema (users, roles) V2 Properties table V3_1 Bookings table V11 Roommate posts V16 Audit logs V20 Comprehensive demo seed data V31 Admin tables V33 Performance indexes V112 Auth performance indexes"},{"location":"database/migrations/#configuration","title":"Configuration","text":"<pre><code>spring.flyway.enabled=true\nspring.flyway.baseline-on-migrate=true\nspring.flyway.locations=classpath:db/migration\n</code></pre>"},{"location":"database/migrations/#best-practices","title":"Best Practices","text":"<p>Never Modify</p> <p>Once a migration is applied, never modify it. Create a new migration instead.</p> <pre><code>-- V121__add_new_column.sql\nALTER TABLE properties ADD COLUMN featured BOOLEAN DEFAULT false;\n</code></pre>"},{"location":"database/schema-design/","title":"Schema Design","text":"<p>Database table structures and design patterns.</p>"},{"location":"database/schema-design/#core-tables","title":"Core Tables","text":""},{"location":"database/schema-design/#users","title":"users","text":"<pre><code>CREATE TABLE users (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    email VARCHAR(255) NOT NULL UNIQUE,\n    password_hash VARCHAR(255),\n    first_name VARCHAR(100),\n    last_name VARCHAR(100),\n    auth_provider VARCHAR(50) NOT NULL,\n    email_verified BOOLEAN DEFAULT FALSE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n</code></pre>"},{"location":"database/schema-design/#properties","title":"properties","text":"<pre><code>CREATE TABLE properties (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    title VARCHAR(200) NOT NULL,\n    description TEXT,\n    price DECIMAL(10,2) NOT NULL,\n    property_type VARCHAR(50),\n    status VARCHAR(50),\n    owner_id BIGINT NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (owner_id) REFERENCES users(id)\n);\n</code></pre>"},{"location":"database/schema-design/#bookings","title":"bookings","text":"<pre><code>CREATE TABLE bookings (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    property_id BIGINT NOT NULL,\n    tenant_id BIGINT NOT NULL,\n    start_date DATE NOT NULL,\n    end_date DATE NOT NULL,\n    status VARCHAR(50) NOT NULL,\n    total_amount DECIMAL(10,2),\n    FOREIGN KEY (property_id) REFERENCES properties(id),\n    FOREIGN KEY (tenant_id) REFERENCES users(id)\n);\n</code></pre>"},{"location":"database/transactions/","title":"Transactions","text":"<p>Transaction management patterns.</p>"},{"location":"database/transactions/#default-configuration","title":"Default Configuration","text":"<pre><code>@Service\n@Transactional(readOnly = true)  // Default read-only\npublic class PropertyServiceImpl implements PropertyService {\n\n    @Override\n    @Transactional  // Write transaction\n    public PropertyResponse createProperty(CreatePropertyRequest request) {\n        // Modifying data\n    }\n\n    @Override\n    public PropertyResponse getProperty(Long id) {\n        // Read-only query\n    }\n}\n</code></pre>"},{"location":"database/transactions/#isolation-levels","title":"Isolation Levels","text":"Level Use Case READ_COMMITTED Default, most queries SERIALIZABLE Financial operations"},{"location":"database/transactions/#rollback-behavior","title":"Rollback Behavior","text":"<pre><code>@Transactional\npublic void createBookingWithPayment() {\n    bookingRepository.save(booking);  // Rolled back if payment fails\n    paymentService.process(payment);  // Exception rolls back\n}\n</code></pre>"},{"location":"deployment/","title":"Deployment","text":"<p>Deployment architecture and configuration.</p>"},{"location":"deployment/#deployment-options","title":"Deployment Options","text":"<pre><code>graph LR\n    LOCAL[Local Dev] --&gt; DOCKER[Docker]\n    DOCKER --&gt; CLOUD[Cloud Deploy]</code></pre>"},{"location":"deployment/#in-this-section","title":"In This Section","text":"Document Description Environment Variables Configuration Dockerization Container setup Architecture Deployment topology Rollback Strategy Recovery procedures"},{"location":"deployment/#quick-commands","title":"Quick Commands","text":"<pre><code># Local\n./mvnw spring-boot:run\n\n# Docker\ndocker-compose up -d\n\n# Production\njava -jar app.jar --spring.profiles.active=prod\n</code></pre>"},{"location":"deployment/architecture/","title":"Deployment Architecture","text":"<p>Production deployment topology.</p>"},{"location":"deployment/architecture/#architecture","title":"Architecture","text":"<pre><code>graph TB\n    LB[Load Balancer]\n    subgraph \"API Cluster\"\n        API1[API 1]\n        API2[API 2]\n    end\n    subgraph \"Data\"\n        DB[(MySQL)]\n        MINIO[MinIO]\n    end\n\n    LB --&gt; API1\n    LB --&gt; API2\n    API1 &amp; API2 --&gt; DB\n    API1 &amp; API2 --&gt; MINIO</code></pre>"},{"location":"deployment/architecture/#components","title":"Components","text":"Component Purpose Load Balancer Traffic distribution API Instances Stateless services MySQL Primary database MinIO Object storage"},{"location":"deployment/dockerization/","title":"Dockerization","text":"<p>Docker containerization for StayMate.</p>"},{"location":"deployment/dockerization/#dockerfile","title":"Dockerfile","text":"<pre><code># Build stage\nFROM eclipse-temurin:17-jdk-alpine AS build\nWORKDIR /app\nCOPY pom.xml mvnw ./\nCOPY .mvn .mvn\nRUN ./mvnw dependency:go-offline\nCOPY src src\nRUN ./mvnw package -DskipTests\n\n# Runtime stage\nFROM eclipse-temurin:17-jre-alpine\nWORKDIR /app\nCOPY --from=build /app/target/*.jar app.jar\n\n# Non-root user\nRUN addgroup -S spring &amp;&amp; adduser -S spring -G spring\nUSER spring\n\nEXPOSE 8080\nENTRYPOINT [\"java\", \"-jar\", \"app.jar\"]\n</code></pre>"},{"location":"deployment/dockerization/#docker-compose","title":"Docker Compose","text":"<pre><code>version: '3.8'\nservices:\n  api:\n    build: ./server\n    ports:\n      - \"8080:8080\"\n    environment:\n      - DB_HOST=mysql\n      - JWT_SECRET=${JWT_SECRET}\n    depends_on:\n      - mysql\n      - minio\n\n  mysql:\n    image: mysql:8.0\n    environment:\n      MYSQL_DATABASE: staymate\n      MYSQL_ROOT_PASSWORD: ${MYSQL_PASSWORD}\n    volumes:\n      - mysql_data:/var/lib/mysql\n\n  minio:\n    image: minio/minio\n    ports:\n      - \"9005:9000\"\n    command: server /data\n    volumes:\n      - minio_data:/data\n\nvolumes:\n  mysql_data:\n  minio_data:\n</code></pre>"},{"location":"deployment/dockerization/#commands","title":"Commands","text":"<pre><code># Build\ndocker-compose build\n\n# Run\ndocker-compose up -d\n\n# Logs\ndocker-compose logs -f api\n\n# Stop\ndocker-compose down\n</code></pre>"},{"location":"deployment/environment-variables/","title":"Environment Variables","text":"<p>Configuration via environment variables.</p>"},{"location":"deployment/environment-variables/#required-variables","title":"Required Variables","text":"Variable Description Example <code>DB_HOST</code> MySQL host <code>localhost</code> <code>DB_PORT</code> MySQL port <code>3306</code> <code>DB_NAME</code> Database name <code>staymate</code> <code>DB_USERNAME</code> Database user <code>staymate</code> <code>DB_PASSWORD</code> Database password <code>secret</code> <code>JWT_SECRET</code> JWT signing key <code>base64-key</code>"},{"location":"deployment/environment-variables/#optional-variables","title":"Optional Variables","text":"Variable Default Description <code>CORS_ALLOWED_ORIGINS</code> <code>localhost:3000</code> CORS origins <code>RATE_LIMIT_ENABLED</code> <code>true</code> Enable rate limiting <code>RATE_LIMIT_REQUESTS_PER_MINUTE</code> <code>200</code> Requests per minute"},{"location":"deployment/environment-variables/#oauth2-optional","title":"OAuth2 (Optional)","text":"Variable Description <code>GOOGLE_CLIENT_ID</code> Google OAuth client ID <code>GOOGLE_CLIENT_SECRET</code> Google OAuth secret"},{"location":"deployment/environment-variables/#minio-storage","title":"MinIO Storage","text":"Variable Default <code>MINIO_URL</code> <code>http://localhost:9005</code> <code>MINIO_ACCESS_KEY</code> <code>minioadmin</code> <code>MINIO_SECRET_KEY</code> <code>minioadmin</code> <code>MINIO_BUCKET_NAME</code> <code>staymate-uploads</code>"},{"location":"deployment/environment-variables/#example-env","title":"Example .env","text":"<pre><code># Database\nDB_HOST=localhost\nDB_PORT=3306\nDB_NAME=staymate\nDB_USERNAME=root\nDB_PASSWORD=secret\n\n# Security\nJWT_SECRET=your-256-bit-secret\n\n# OAuth (optional)\nGOOGLE_CLIENT_ID=xxx.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=xxx\n</code></pre> <p>Security</p> <p>Never commit <code>.env</code> files to version control.</p>"},{"location":"deployment/rollback-strategy/","title":"Rollback Strategy","text":"<p>Recovery procedures for failed deployments.</p>"},{"location":"deployment/rollback-strategy/#docker-rollback","title":"Docker Rollback","text":"<pre><code># Roll back to previous version\ndocker-compose down\ndocker-compose pull staymate-api:previous\ndocker-compose up -d\n</code></pre>"},{"location":"deployment/rollback-strategy/#database-rollback","title":"Database Rollback","text":"<p>Flyway Limitation</p> <p>Flyway doesn't support automatic rollback. Create forward migrations to undo changes.</p> <pre><code>-- V122__rollback_feature.sql\nALTER TABLE properties DROP COLUMN new_feature;\n</code></pre>"},{"location":"frontend/","title":"Frontend","text":"<p>This section documents the Next.js 14 frontend application.</p>"},{"location":"frontend/#overview","title":"Overview","text":"Technology Version Purpose Next.js 14.2.3 React framework (App Router) React 18.3.1 UI library TypeScript 5.4.5 Type safety Tailwind CSS 3.4.3 Styling Axios 1.6.8 HTTP client STOMP.js 7.2.1 WebSocket client Framer Motion 12.23.26 Animations Recharts 3.6.0 Data visualization"},{"location":"frontend/#architecture","title":"Architecture","text":"<pre><code>flowchart TD\n    subgraph Pages[\"App Router (src/app/)\"]\n        HOME[\"/ - Landing\"]\n        LOGIN[\"/login\"]\n        REGISTER[\"/register\"]\n        DASH[\"/dashboard\"]\n        PROPS[\"/search\"]\n        ROOM[\"/roommates\"]\n        MSG[\"/messages\"]\n    end\n\n    subgraph Components[\"Components (src/components/)\"]\n        NAV[\"Navbar\"]\n        SIDE[\"Sidebar\"]\n        LAYOUT[\"DashboardLayout\"]\n        AUTH[\"AuthGuard\"]\n    end\n\n    subgraph Context[\"Context (src/context/)\"]\n        AUTHCTX[\"AuthContext\"]\n        THEME[\"ThemeContext\"]\n    end\n\n    subgraph Lib[\"Lib (src/lib/)\"]\n        API[\"api.ts - Axios\"]\n        SOCKET[\"socket.ts - WebSocket\"]\n    end\n\n    Pages --&gt; Components\n    Components --&gt; Context\n    Context --&gt; Lib\n    Lib --&gt; BACKEND[\"Backend API :8080\"]</code></pre>"},{"location":"frontend/#in-this-section","title":"In This Section","text":"Document Description Project Structure Directory organization Pages &amp; Routing App Router pages Components Reusable components State Management Context providers API Integration Axios configuration WebSocket Real-time messaging Styling Tailwind configuration"},{"location":"frontend/api-client/","title":"API Integration","text":"<p>Axios client configuration for backend communication.</p>"},{"location":"frontend/api-client/#configuration","title":"Configuration","text":"<p>Located at <code>src/lib/api.ts</code>:</p> <pre><code>import axios from 'axios';\n\nconst api = axios.create({\n  baseURL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8080',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  withCredentials: true,\n});\n</code></pre>"},{"location":"frontend/api-client/#request-interceptor","title":"Request Interceptor","text":"<p>Adds JWT token to all requests:</p> <pre><code>api.interceptors.request.use(\n  (config) =&gt; {\n    const token = localStorage.getItem('accessToken');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) =&gt; Promise.reject(error)\n);\n</code></pre>"},{"location":"frontend/api-client/#response-interceptor","title":"Response Interceptor","text":"<p>Handles token refresh on 401:</p> <pre><code>api.interceptors.response.use(\n  (response) =&gt; response,\n  async (error) =&gt; {\n    const originalRequest = error.config;\n\n    if (error.response?.status === 401 &amp;&amp; !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      try {\n        const refreshToken = localStorage.getItem('refreshToken');\n        const response = await axios.post('/api/auth/refresh-token', {\n          refreshToken,\n        });\n\n        localStorage.setItem('accessToken', response.data.accessToken);\n        originalRequest.headers.Authorization =\n          `Bearer ${response.data.accessToken}`;\n\n        return api(originalRequest);\n      } catch (refreshError) {\n        // Refresh failed - logout user\n        localStorage.removeItem('accessToken');\n        localStorage.removeItem('refreshToken');\n        window.location.href = '/login';\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n</code></pre>"},{"location":"frontend/api-client/#api-calls","title":"API Calls","text":""},{"location":"frontend/api-client/#authentication","title":"Authentication","text":"<pre><code>// Login\nconst response = await api.post('/api/auth/login', {\n  email,\n  password,\n});\n\n// Register\nconst response = await api.post('/api/auth/register', {\n  email,\n  password,\n  firstName,\n  lastName,\n});\n\n// Get current user\nconst response = await api.get('/api/auth/me');\n</code></pre>"},{"location":"frontend/api-client/#properties","title":"Properties","text":"<pre><code>// Search properties\nconst response = await api.get('/api/properties', {\n  params: { city, minPrice, maxPrice, page },\n});\n\n// Get property details\nconst response = await api.get(`/api/properties/${id}`);\n\n// Create property (landlord)\nconst response = await api.post('/api/properties', propertyData);\n</code></pre>"},{"location":"frontend/api-client/#bookings","title":"Bookings","text":"<pre><code>// Create booking\nconst response = await api.post('/api/bookings', {\n  propertyId,\n  startDate,\n  endDate,\n});\n\n// Get my bookings\nconst response = await api.get('/api/bookings/my-bookings');\n</code></pre>"},{"location":"frontend/api-client/#error-handling","title":"Error Handling","text":"<pre><code>try {\n  const response = await api.post('/api/bookings', data);\n  toast.success('Booking created!');\n} catch (error) {\n  if (axios.isAxiosError(error)) {\n    const message = error.response?.data?.message || 'An error occurred';\n    toast.error(message);\n  }\n}\n</code></pre>"},{"location":"frontend/api-client/#environment-variables","title":"Environment Variables","text":"<pre><code># .env.local\nNEXT_PUBLIC_API_URL=http://localhost:8080\n</code></pre> <p>Public Variables</p> <p>Only <code>NEXT_PUBLIC_*</code> variables are exposed to the browser. Never put secrets in these variables.</p>"},{"location":"frontend/components/","title":"Components","text":"<p>Reusable React components in StayMate.</p>"},{"location":"frontend/components/#component-categories","title":"Component Categories","text":"<pre><code>flowchart LR\n    subgraph Layout[\"Layout Components\"]\n        NAV[\"Navbar\"]\n        SIDE[\"Sidebar\"]\n        DASH[\"DashboardLayout\"]\n        FOOTER[\"Footer\"]\n    end\n\n    subgraph Auth[\"Auth Components\"]\n        GUARD[\"AuthGuard\"]\n        ROLE[\"RoleSelector\"]\n    end\n\n    subgraph Common[\"Common Components\"]\n        BTN[\"Button\"]\n        CARD[\"GlassCard\"]\n        AVATAR[\"Avatar\"]\n        EMPTY[\"EmptyState\"]\n        LOAD[\"LoadingState\"]\n    end\n\n    subgraph Feature[\"Feature Components\"]\n        PROP[\"PropertyCard\"]\n        ROOM[\"RoommateCard\"]\n        MSG[\"MessageBubble\"]\n    end</code></pre>"},{"location":"frontend/components/#core-components","title":"Core Components","text":""},{"location":"frontend/components/#navbar-componentsnavbartsx","title":"Navbar (<code>components/Navbar.tsx</code>)","text":"<p>Global navigation with auth-aware rendering:</p> <ul> <li>Logo and navigation links</li> <li>Auth buttons (login/register) or user menu</li> <li>Theme toggle</li> <li>Mobile responsive</li> </ul>"},{"location":"frontend/components/#dashboardlayout-componentsdashboardlayouttsx","title":"DashboardLayout (<code>components/DashboardLayout.tsx</code>)","text":"<p>Wrapper for authenticated pages:</p> <pre><code>export function DashboardLayout({ children }) {\n  return (\n    &lt;div className=\"flex h-screen\"&gt;\n      &lt;Sidebar /&gt;\n      &lt;main className=\"flex-1 overflow-auto\"&gt;\n        {children}\n      &lt;/main&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/components/#authguard-componentsauthauthguardtsx","title":"AuthGuard (<code>components/auth/AuthGuard.tsx</code>)","text":"<p>Route protection:</p> <ul> <li>Checks authentication state</li> <li>Redirects to login if unauthenticated</li> <li>Validates role permissions</li> <li>Shows loading during auth check</li> </ul>"},{"location":"frontend/components/#ui-components","title":"UI Components","text":"Component File Purpose <code>Button</code> <code>Button.tsx</code> Styled button variants <code>GlassCard</code> <code>GlassCard.tsx</code> Glass morphism card <code>Avatar</code> <code>common/Avatar.tsx</code> User avatar <code>EmptyState</code> <code>common/EmptyState.tsx</code> No data placeholder <code>LoadingState</code> <code>common/LoadingState.tsx</code> Loading spinner <code>AnimatedCard</code> <code>common/AnimatedCard.tsx</code> Framer Motion card <code>Map</code> <code>Map.tsx</code> Leaflet map <code>Logo</code> <code>Logo.tsx</code> StayMate logo"},{"location":"frontend/components/#feature-components","title":"Feature Components","text":""},{"location":"frontend/components/#landing-page","title":"Landing Page","text":"Component Purpose <code>HeroSection</code> Main hero with CTA <code>FeaturesSection</code> Feature highlights <code>TestimonialsCarousel</code> User testimonials <code>FAQSection</code> FAQ accordion <code>AmenitiesSection</code> Property amenities"},{"location":"frontend/components/#search-listings","title":"Search &amp; Listings","text":"Component Purpose <code>PropertyCard</code> Property listing card <code>RoommateCard</code> Roommate listing card <code>SearchFilters</code> Filter controls <code>SearchResults</code> Results grid"},{"location":"frontend/components/#admin","title":"Admin","text":"Component Purpose <code>UserManagement</code> Admin user table <code>DeletionWarningModal</code> Deletion confirmation <code>AdminStats</code> Dashboard statistics"},{"location":"frontend/components/#component-patterns","title":"Component Patterns","text":""},{"location":"frontend/components/#using-framer-motion","title":"Using Framer Motion","text":"<pre><code>import { motion } from 'framer-motion';\n\nexport function AnimatedCard({ children }) {\n  return (\n    &lt;motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.3 }}\n    &gt;\n      {children}\n    &lt;/motion.div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/components/#using-tailwind-clsx","title":"Using Tailwind + clsx","text":"<pre><code>import { clsx } from 'clsx';\n\nexport function Button({ variant = 'primary', className, ...props }) {\n  return (\n    &lt;button\n      className={clsx(\n        'px-4 py-2 rounded-lg font-medium',\n        variant === 'primary' &amp;&amp; 'bg-indigo-600 text-white',\n        variant === 'secondary' &amp;&amp; 'bg-gray-200 text-gray-800',\n        className\n      )}\n      {...props}\n    /&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/pages/","title":"Pages &amp; Routing","text":"<p>Next.js App Router pages in StayMate.</p>"},{"location":"frontend/pages/#route-map","title":"Route Map","text":"<pre><code>flowchart TD\n    subgraph Public[\"Public Routes\"]\n        HOME[\"/ Landing\"]\n        LOGIN[\"/login\"]\n        REGISTER[\"/register\"]\n        SEARCH[\"/search\"]\n        ROOMMATES[\"/roommates\"]\n        ABOUT[\"/about\"]\n        CONTACT[\"/contact\"]\n        FAQ[\"/faq\"]\n    end\n\n    subgraph Protected[\"Protected Routes (AuthGuard)\"]\n        DASH[\"/dashboard\"]\n        PROFILE[\"/profile\"]\n        SETTINGS[\"/settings\"]\n        MESSAGES[\"/messages\"]\n        NOTIFICATIONS[\"/notifications\"]\n        BOOKINGS[\"/bookings\"]\n        MATCHES[\"/matches\"]\n    end\n\n    subgraph Admin[\"Admin Only\"]\n        ADMIN[\"/dashboard/admin/*\"]\n    end\n\n    LOGIN --&gt; DASH\n    REGISTER --&gt; DASH</code></pre>"},{"location":"frontend/pages/#page-inventory","title":"Page Inventory","text":""},{"location":"frontend/pages/#public-pages","title":"Public Pages","text":"Route File Description <code>/</code> <code>app/page.tsx</code> Landing page <code>/login</code> <code>app/login/page.tsx</code> Login form <code>/register</code> <code>app/register/page.tsx</code> Registration <code>/search</code> <code>app/search/page.tsx</code> Property search <code>/roommates</code> <code>app/roommates/page.tsx</code> Roommate listings <code>/about</code> <code>app/about/page.tsx</code> About us <code>/contact</code> <code>app/contact/page.tsx</code> Contact form <code>/faq</code> <code>app/faq/page.tsx</code> FAQ <code>/how-it-works</code> <code>app/how-it-works/page.tsx</code> How it works <code>/testimonials</code> <code>app/testimonials/page.tsx</code> User testimonials"},{"location":"frontend/pages/#protected-pages","title":"Protected Pages","text":"Route File Required Role <code>/dashboard</code> <code>app/dashboard/page.tsx</code> Any authenticated <code>/profile</code> <code>app/profile/page.tsx</code> Any authenticated <code>/settings</code> <code>app/settings/page.tsx</code> Any authenticated <code>/messages</code> <code>app/messages/page.tsx</code> Any authenticated <code>/notifications</code> <code>app/notifications/page.tsx</code> Any authenticated <code>/bookings</code> <code>app/bookings/page.tsx</code> Any authenticated <code>/matches</code> <code>app/matches/page.tsx</code> Any authenticated <code>/applications</code> <code>app/applications/page.tsx</code> Any authenticated <code>/verification</code> <code>app/verification/page.tsx</code> Any authenticated"},{"location":"frontend/pages/#role-based-pages","title":"Role-Based Pages","text":"Route Required Role <code>/select-role</code> OAuth users (first login) <code>/dashboard/admin/*</code> ADMIN only"},{"location":"frontend/pages/#route-protection","title":"Route Protection","text":"<p>Using <code>AuthGuard</code> component:</p> <pre><code>// components/auth/AuthGuard.tsx\nexport function AuthGuard({ children, allowedRoles }) {\n  const { user, isLoading } = useAuth();\n  const router = useRouter();\n\n  useEffect(() =&gt; {\n    if (!isLoading &amp;&amp; !user) {\n      router.push('/login');\n    }\n    if (allowedRoles &amp;&amp; !allowedRoles.includes(user?.role)) {\n      router.push('/dashboard');\n    }\n  }, [user, isLoading]);\n\n  if (isLoading) return &lt;LoadingState /&gt;;\n  return children;\n}\n</code></pre>"},{"location":"frontend/pages/#dashboard-routing","title":"Dashboard Routing","text":"<p>Role-based dashboard content:</p> <pre><code>// app/dashboard/page.tsx\nexport default function Dashboard() {\n  const { user } = useAuth();\n\n  switch (user?.role) {\n    case 'ROLE_ADMIN':\n      return &lt;AdminDashboard /&gt;;\n    case 'ROLE_HOUSE_OWNER':\n      return &lt;LandlordDashboard /&gt;;\n    default:\n      return &lt;TenantDashboard /&gt;;\n  }\n}\n</code></pre>"},{"location":"frontend/state/","title":"State Management","text":"<p>React Context providers in StayMate.</p>"},{"location":"frontend/state/#context-architecture","title":"Context Architecture","text":"<pre><code>flowchart TD\n    subgraph Providers[\"Context Providers\"]\n        AUTH[\"AuthProvider\"]\n        THEME[\"ThemeProvider\"]\n    end\n\n    AUTH --&gt; USER[\"user state\"]\n    AUTH --&gt; TOKEN[\"tokens\"]\n    AUTH --&gt; ACTIONS[\"login/logout\"]\n\n    THEME --&gt; MODE[\"dark/light\"]\n    THEME --&gt; TOGGLE[\"toggleTheme()\"]\n\n    subgraph Consumption[\"Components\"]\n        NAV[\"Navbar\"]\n        DASH[\"Dashboard\"]\n        GUARD[\"AuthGuard\"]\n    end\n\n    USER --&gt; Consumption\n    MODE --&gt; Consumption</code></pre>"},{"location":"frontend/state/#authcontext","title":"AuthContext","text":"<p>Manages authentication state globally.</p>"},{"location":"frontend/state/#interface","title":"Interface","text":"<pre><code>interface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  login: (email: string, password: string) =&gt; Promise&lt;void&gt;;\n  register: (data: RegisterData) =&gt; Promise&lt;void&gt;;\n  logout: () =&gt; void;\n  refreshToken: () =&gt; Promise&lt;void&gt;;\n}\n</code></pre>"},{"location":"frontend/state/#usage","title":"Usage","text":"<pre><code>// In any component\nimport { useAuth } from '@/context/AuthContext';\n\nexport function ProfileButton() {\n  const { user, logout, isLoading } = useAuth();\n\n  if (isLoading) return &lt;Spinner /&gt;;\n  if (!user) return &lt;LoginButton /&gt;;\n\n  return (\n    &lt;div&gt;\n      &lt;span&gt;{user.firstName}&lt;/span&gt;\n      &lt;button onClick={logout}&gt;Logout&lt;/button&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/state/#token-management","title":"Token Management","text":"<pre><code>// Tokens stored in localStorage\nlocalStorage.setItem('accessToken', response.accessToken);\nlocalStorage.setItem('refreshToken', response.refreshToken);\n\n// Auto-refresh on 401\napi.interceptors.response.use(\n  (response) =&gt; response,\n  async (error) =&gt; {\n    if (error.response?.status === 401) {\n      await refreshToken();\n      return api.request(error.config);\n    }\n    throw error;\n  }\n);\n</code></pre>"},{"location":"frontend/state/#themecontext","title":"ThemeContext","text":"<p>Manages dark/light mode.</p>"},{"location":"frontend/state/#interface_1","title":"Interface","text":"<pre><code>interface ThemeContextType {\n  theme: 'light' | 'dark';\n  toggleTheme: () =&gt; void;\n}\n</code></pre>"},{"location":"frontend/state/#usage_1","title":"Usage","text":"<pre><code>import { useTheme } from '@/context/ThemeContext';\n\nexport function ThemeSwitcher() {\n  const { theme, toggleTheme } = useTheme();\n\n  return (\n    &lt;button onClick={toggleTheme}&gt;\n      {theme === 'dark' ? &lt;SunIcon /&gt; : &lt;MoonIcon /&gt;}\n    &lt;/button&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/state/#provider-setup","title":"Provider Setup","text":"<p>In <code>app/layout.tsx</code>:</p> <pre><code>export default function RootLayout({ children }) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;AuthProvider&gt;\n          &lt;ThemeProvider&gt;\n            {children}\n          &lt;/ThemeProvider&gt;\n        &lt;/AuthProvider&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  );\n}\n</code></pre> <p>Provider Order</p> <p>AuthProvider wraps ThemeProvider because theme preferences might be user-specific in the future.</p>"},{"location":"frontend/structure/","title":"Frontend Structure","text":"<p>Directory organization of the Next.js frontend.</p>"},{"location":"frontend/structure/#directory-tree","title":"Directory Tree","text":"<pre><code>frontend/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 app/                    # Next.js App Router\n\u2502   \u2502   \u251c\u2500\u2500 layout.tsx          # Root layout\n\u2502   \u2502   \u251c\u2500\u2500 page.tsx            # Landing page (/)\n\u2502   \u2502   \u251c\u2500\u2500 login/page.tsx      # /login\n\u2502   \u2502   \u251c\u2500\u2500 register/page.tsx   # /register\n\u2502   \u2502   \u251c\u2500\u2500 dashboard/          # /dashboard/*\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 page.tsx        # Dashboard home\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 layout.tsx      # Dashboard layout\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 admin/          # Admin pages\n\u2502   \u2502   \u251c\u2500\u2500 search/page.tsx     # Property search\n\u2502   \u2502   \u251c\u2500\u2500 roommates/page.tsx  # Roommate listings\n\u2502   \u2502   \u251c\u2500\u2500 messages/page.tsx   # Messaging\n\u2502   \u2502   \u251c\u2500\u2500 notifications/      # Notifications\n\u2502   \u2502   \u251c\u2500\u2500 profile/page.tsx    # User profile\n\u2502   \u2502   \u2514\u2500\u2500 settings/page.tsx   # Settings\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 components/             # Reusable components\n\u2502   \u2502   \u251c\u2500\u2500 Navbar.tsx          # Navigation bar\n\u2502   \u2502   \u251c\u2500\u2500 Sidebar.tsx         # Dashboard sidebar\n\u2502   \u2502   \u251c\u2500\u2500 DashboardLayout.tsx # Dashboard wrapper\n\u2502   \u2502   \u251c\u2500\u2500 auth/               # Auth components\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 AuthGuard.tsx   # Route protection\n\u2502   \u2502   \u251c\u2500\u2500 admin/              # Admin components\n\u2502   \u2502   \u251c\u2500\u2500 landing/            # Landing page sections\n\u2502   \u2502   \u251c\u2500\u2500 roommates/          # Roommate components\n\u2502   \u2502   \u2514\u2500\u2500 search/             # Search components\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 context/                # React contexts\n\u2502   \u2502   \u251c\u2500\u2500 AuthContext.tsx     # Authentication state\n\u2502   \u2502   \u2514\u2500\u2500 ThemeContext.tsx    # Theme (dark/light)\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 lib/                    # Utilities\n\u2502   \u2502   \u251c\u2500\u2500 api.ts              # Axios client\n\u2502   \u2502   \u2514\u2500\u2500 socket.ts           # WebSocket client\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 types/                  # TypeScript types\n\u2502       \u2514\u2500\u2500 auth.ts             # Auth types\n\u2502\n\u251c\u2500\u2500 public/                     # Static assets\n\u251c\u2500\u2500 package.json                # Dependencies\n\u251c\u2500\u2500 next.config.js              # Next.js config\n\u251c\u2500\u2500 tailwind.config.js          # Tailwind config\n\u2514\u2500\u2500 tsconfig.json               # TypeScript config\n</code></pre>"},{"location":"frontend/structure/#key-files","title":"Key Files","text":""},{"location":"frontend/structure/#root-layout-srcapplayouttsx","title":"Root Layout (<code>src/app/layout.tsx</code>)","text":"<p>Wraps all pages with providers:</p> <pre><code>export default function RootLayout({ children }) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;AuthProvider&gt;\n          &lt;ThemeProvider&gt;\n            &lt;Navbar /&gt;\n            {children}\n          &lt;/ThemeProvider&gt;\n        &lt;/AuthProvider&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/structure/#api-client-srclibapits","title":"API Client (<code>src/lib/api.ts</code>)","text":"<p>Configured Axios with interceptors:</p> <pre><code>const api = axios.create({\n  baseURL: process.env.NEXT_PUBLIC_API_URL,\n  headers: { 'Content-Type': 'application/json' }\n});\n\n// Request interceptor adds JWT\napi.interceptors.request.use((config) =&gt; {\n  const token = localStorage.getItem('accessToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n</code></pre>"},{"location":"frontend/structure/#statistics","title":"Statistics","text":"Category Count Pages (app/) 28 Components 54 Total TSX/TS 82"},{"location":"frontend/styling/","title":"Styling","text":"<p>Tailwind CSS configuration and patterns.</p>"},{"location":"frontend/styling/#configuration","title":"Configuration","text":"<p>Located at <code>tailwind.config.js</code>:</p> <pre><code>module.exports = {\n  content: [\n    './src/**/*.{js,ts,jsx,tsx}',\n  ],\n  darkMode: 'class',\n  theme: {\n    extend: {\n      colors: {\n        primary: {\n          50: '#eef2ff',\n          500: '#6366f1',\n          600: '#4f46e5',\n          700: '#4338ca',\n        },\n      },\n      animation: {\n        'fade-in': 'fadeIn 0.3s ease-in-out',\n        'slide-up': 'slideUp 0.3s ease-out',\n      },\n    },\n  },\n  plugins: [],\n};\n</code></pre>"},{"location":"frontend/styling/#class-patterns","title":"Class Patterns","text":""},{"location":"frontend/styling/#responsive-design","title":"Responsive Design","text":"<pre><code>&lt;!-- Mobile-first approach --&gt;\n&lt;div class=\"\n  grid\n  grid-cols-1\n  md:grid-cols-2\n  lg:grid-cols-3\n  gap-4\n\"&gt;\n</code></pre>"},{"location":"frontend/styling/#dark-mode","title":"Dark Mode","text":"<pre><code>&lt;div class=\"\n  bg-white dark:bg-gray-800\n  text-gray-900 dark:text-white\n\"&gt;\n</code></pre>"},{"location":"frontend/styling/#glass-morphism","title":"Glass Morphism","text":"<pre><code>&lt;div class=\"\n  bg-white/10\n  backdrop-blur-md\n  border border-white/20\n  rounded-xl\n\"&gt;\n</code></pre>"},{"location":"frontend/styling/#component-styling","title":"Component Styling","text":""},{"location":"frontend/styling/#button-variants","title":"Button Variants","text":"<pre><code>const buttonVariants = {\n  primary: 'bg-indigo-600 hover:bg-indigo-700 text-white',\n  secondary: 'bg-gray-200 hover:bg-gray-300 text-gray-800',\n  outline: 'border border-indigo-600 text-indigo-600 hover:bg-indigo-50',\n  ghost: 'hover:bg-gray-100 text-gray-600',\n};\n</code></pre>"},{"location":"frontend/styling/#card-styles","title":"Card Styles","text":"<pre><code>&lt;div className=\"\n  bg-white dark:bg-gray-800\n  rounded-xl\n  shadow-lg\n  p-6\n  transition-transform hover:scale-105\n\"&gt;\n</code></pre>"},{"location":"frontend/styling/#animations","title":"Animations","text":""},{"location":"frontend/styling/#framer-motion-integration","title":"Framer Motion Integration","text":"<pre><code>import { motion } from 'framer-motion';\n\n&lt;motion.div\n  initial={{ opacity: 0, y: 20 }}\n  animate={{ opacity: 1, y: 0 }}\n  exit={{ opacity: 0, y: -20 }}\n  transition={{ duration: 0.3 }}\n&gt;\n</code></pre>"},{"location":"frontend/styling/#css-animations","title":"CSS Animations","text":"<pre><code>@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes slideUp {\n  from { transform: translateY(20px); opacity: 0; }\n  to { transform: translateY(0); opacity: 1; }\n}\n</code></pre>"},{"location":"frontend/styling/#utility-classes","title":"Utility Classes","text":"<p>Using <code>clsx</code> and <code>tailwind-merge</code>:</p> <pre><code>import { clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n// Usage\n&lt;button className={cn(\n  'px-4 py-2 rounded',\n  isActive &amp;&amp; 'bg-indigo-600',\n  className\n)} /&gt;\n</code></pre>"},{"location":"frontend/styling/#icons","title":"Icons","text":"<p>Using Lucide React:</p> <pre><code>import { Home, User, Settings, LogOut } from 'lucide-react';\n\n&lt;Home className=\"w-5 h-5\" /&gt;\n</code></pre>"},{"location":"frontend/websocket/","title":"WebSocket","text":"<p>Real-time messaging with STOMP over WebSocket.</p>"},{"location":"frontend/websocket/#architecture","title":"Architecture","text":"<pre><code>sequenceDiagram\n    participant Client as Next.js Client\n    participant WS as WebSocket (/ws)\n    participant Backend as Spring Boot\n    participant DB as MySQL\n\n    Client-&gt;&gt;WS: Connect with JWT\n    WS-&gt;&gt;Backend: Validate token\n    Backend--&gt;&gt;WS: Connected\n\n    Client-&gt;&gt;WS: SUBSCRIBE /user/queue/messages\n\n    Note over Client,Backend: User sends message\n    Client-&gt;&gt;WS: SEND /app/chat\n    WS-&gt;&gt;Backend: MessagingController\n    Backend-&gt;&gt;DB: Save message\n    Backend-&gt;&gt;WS: Send to recipient\n    WS--&gt;&gt;Client: MESSAGE /user/queue/messages</code></pre>"},{"location":"frontend/websocket/#client-setup","title":"Client Setup","text":"<p>Located at <code>src/lib/socket.ts</code>:</p> <pre><code>import { Client } from '@stomp/stompjs';\nimport SockJS from 'sockjs-client';\n\nlet stompClient: Client | null = null;\n\nexport function connectWebSocket(token: string) {\n  stompClient = new Client({\n    webSocketFactory: () =&gt; new SockJS('http://localhost:8080/ws'),\n    connectHeaders: {\n      Authorization: `Bearer ${token}`,\n    },\n    onConnect: () =&gt; {\n      console.log('WebSocket connected');\n\n      // Subscribe to private messages\n      stompClient?.subscribe('/user/queue/messages', (message) =&gt; {\n        const data = JSON.parse(message.body);\n        handleNewMessage(data);\n      });\n\n      // Subscribe to notifications\n      stompClient?.subscribe('/user/queue/notifications', (notification) =&gt; {\n        const data = JSON.parse(notification.body);\n        handleNotification(data);\n      });\n    },\n    onDisconnect: () =&gt; {\n      console.log('WebSocket disconnected');\n    },\n  });\n\n  stompClient.activate();\n}\n\nexport function sendMessage(conversationId: number, content: string) {\n  stompClient?.publish({\n    destination: '/app/chat',\n    body: JSON.stringify({ conversationId, content }),\n  });\n}\n\nexport function disconnectWebSocket() {\n  stompClient?.deactivate();\n}\n</code></pre>"},{"location":"frontend/websocket/#usage-in-components","title":"Usage in Components","text":""},{"location":"frontend/websocket/#messages-page","title":"Messages Page","text":"<pre><code>import { connectWebSocket, sendMessage, disconnectWebSocket } from '@/lib/socket';\n\nexport function MessagesPage() {\n  const { user } = useAuth();\n  const [messages, setMessages] = useState([]);\n\n  useEffect(() =&gt; {\n    const token = localStorage.getItem('accessToken');\n    if (token) {\n      connectWebSocket(token);\n    }\n\n    return () =&gt; disconnectWebSocket();\n  }, []);\n\n  const handleSend = (content: string) =&gt; {\n    sendMessage(conversationId, content);\n  };\n\n  return (\n    &lt;div&gt;\n      &lt;MessageList messages={messages} /&gt;\n      &lt;MessageInput onSend={handleSend} /&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/websocket/#subscriptions","title":"Subscriptions","text":"Destination Purpose <code>/user/queue/messages</code> Private messages <code>/user/queue/notifications</code> Real-time notifications"},{"location":"frontend/websocket/#send-destinations","title":"Send Destinations","text":"Destination Purpose <code>/app/chat</code> Send message <code>/app/read</code> Mark as read"},{"location":"frontend/websocket/#connection-lifecycle","title":"Connection Lifecycle","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Disconnected\n    Disconnected --&gt; Connecting: Login\n    Connecting --&gt; Connected: Success\n    Connecting --&gt; Disconnected: Failed\n    Connected --&gt; Disconnected: Logout\n    Connected --&gt; Reconnecting: Connection Lost\n    Reconnecting --&gt; Connected: Success\n    Reconnecting --&gt; Disconnected: Max Retries</code></pre> <p>Auto-Reconnect</p> <p>STOMP.js handles automatic reconnection. Configure with <code>reconnectDelay</code> option.</p>"},{"location":"observability/","title":"Observability","text":"<p>Logging, metrics, and monitoring for StayMate.</p>"},{"location":"observability/#observability-stack","title":"Observability Stack","text":"<pre><code>graph TB\n    APP[Spring Boot] --&gt; LOGS[Structured Logs]\n    APP --&gt; METRICS[Micrometer Metrics]\n    APP --&gt; HEALTH[Actuator Health]\n\n    LOGS --&gt; ELK[ELK Stack]\n    METRICS --&gt; PROM[Prometheus]\n    PROM --&gt; GRAF[Grafana]</code></pre>"},{"location":"observability/#in-this-section","title":"In This Section","text":"Document Description Metrics Application metrics Distributed Tracing Request tracing Alerts Alert configuration Dashboards Grafana dashboards"},{"location":"observability/#quick-access","title":"Quick Access","text":"Endpoint Purpose <code>/actuator/health</code> Health check <code>/actuator/metrics</code> Metrics list <code>/actuator/prometheus</code> Prometheus scrape"},{"location":"observability/alerts/","title":"Alerts","text":"<p>Alerting configuration for monitoring.</p>"},{"location":"observability/alerts/#recommended-alerts","title":"Recommended Alerts","text":"Alert Condition Severity High Error Rate &gt; 5% 5xx Critical Slow Response p95 &gt; 1s Warning DB Pool Exhausted &gt; 90% used Critical"},{"location":"observability/dashboards/","title":"Dashboards","text":"<p>Grafana dashboard configuration.</p>"},{"location":"observability/dashboards/#recommended-dashboards","title":"Recommended Dashboards","text":"Dashboard ID Purpose JVM Micrometer 12900 JVM metrics k6 Load Test Custom Load test results <p>See load-testing/grafana for setup.</p>"},{"location":"observability/distributed-tracing/","title":"Distributed Tracing","text":"<p>Request tracing across services.</p>"},{"location":"observability/distributed-tracing/#future-implementation","title":"Future Implementation","text":"<pre><code>// Spring Cloud Sleuth\n@Autowired\nprivate Tracer tracer;\n\nSpan span = tracer.nextSpan().name(\"process-booking\");\n</code></pre>"},{"location":"observability/distributed-tracing/#tools","title":"Tools","text":"Tool Purpose Zipkin Trace visualization Jaeger Distributed tracing"},{"location":"observability/metrics/","title":"Metrics","text":"<p>Application metrics with Micrometer.</p>"},{"location":"observability/metrics/#built-in-metrics","title":"Built-in Metrics","text":"Metric Description <code>http.server.requests</code> Request counts and timing <code>jvm.memory.used</code> JVM memory <code>hikaricp.connections.active</code> DB connections"},{"location":"observability/metrics/#endpoint","title":"Endpoint","text":"<pre><code>GET /actuator/metrics\n</code></pre>"},{"location":"oss/","title":"Contributing","text":"<p>Guidelines for contributing to StayMate.</p>"},{"location":"oss/#welcome","title":"Welcome!","text":"<p>We welcome contributions from the community. This section covers everything you need to get started.</p>"},{"location":"oss/#in-this-section","title":"In This Section","text":"Document Description Code Style Formatting &amp; conventions Branching Strategy Git workflow Roadmap Future plans FAQ Common questions"},{"location":"oss/#quick-start","title":"Quick Start","text":"<pre><code># Fork and clone\ngit clone https://github.com/YOUR_USERNAME/staymate.git\n\n# Create branch\ngit checkout -b feature/your-feature\n\n# Make changes, commit, push\ngit commit -m \"feat: add new feature\"\ngit push origin feature/your-feature\n\n# Open Pull Request\n</code></pre>"},{"location":"oss/#code-of-conduct","title":"Code of Conduct","text":"<p>Be respectful, inclusive, and constructive. See our full Code of Conduct for details.</p>"},{"location":"oss/branching-strategy/","title":"Branching Strategy","text":"<p>Git branching workflow for StayMate.</p>"},{"location":"oss/branching-strategy/#branch-types","title":"Branch Types","text":"<pre><code>gitGraph\n    commit id: \"main\"\n    branch develop\n    commit id: \"dev work\"\n    branch feature/auth\n    commit id: \"feature\"\n    checkout develop\n    merge feature/auth\n    checkout main\n    merge develop tag: \"v1.0.0\"</code></pre>"},{"location":"oss/branching-strategy/#branch-naming","title":"Branch Naming","text":"Type Pattern Example Feature <code>feature/description</code> <code>feature/google-oauth</code> Bugfix <code>bugfix/description</code> <code>bugfix/token-expiry</code> Hotfix <code>hotfix/description</code> <code>hotfix/security-patch</code> Release <code>release/version</code> <code>release/1.2.0</code>"},{"location":"oss/branching-strategy/#workflow","title":"Workflow","text":"<ol> <li>Create feature branch from <code>develop</code></li> <li>Implement and test</li> <li>Create Pull Request</li> <li>Code review</li> <li>Merge to <code>develop</code></li> <li>Release: merge <code>develop</code> to <code>main</code></li> </ol>"},{"location":"oss/code-style/","title":"Code Style","text":"<p>Java code style guidelines for StayMate.</p>"},{"location":"oss/code-style/#general-rules","title":"General Rules","text":"<ul> <li>Indentation: 4 spaces (no tabs)</li> <li>Line length: 120 characters max</li> <li>Encoding: UTF-8</li> <li>Newline: LF (Unix-style)</li> </ul>"},{"location":"oss/code-style/#naming-conventions","title":"Naming Conventions","text":"Type Convention Example Class PascalCase <code>PropertyService</code> Method camelCase <code>createProperty()</code> Variable camelCase <code>propertyId</code> Constant UPPER_SNAKE <code>MAX_RETRIES</code> Package lowercase <code>com.webapp.domain</code>"},{"location":"oss/code-style/#annotations-order","title":"Annotations Order","text":"<pre><code>@Entity\n@Table(name = \"properties\")\n@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Property {\n</code></pre>"},{"location":"oss/code-style/#import-order","title":"Import Order","text":"<ol> <li><code>java.*</code></li> <li><code>javax.*</code></li> <li><code>org.springframework.*</code></li> <li><code>com.webapp.*</code></li> <li>Static imports</li> </ol>"},{"location":"oss/code-style/#method-structure","title":"Method Structure","text":"<pre><code>@Override\n@Transactional\npublic PropertyResponse createProperty(CreatePropertyRequest request) {\n    // 1. Validate\n    User owner = userService.getCurrentUser();\n\n    // 2. Transform\n    Property property = propertyMapper.toEntity(request);\n    property.setOwner(owner);\n\n    // 3. Persist\n    Property saved = propertyRepository.save(property);\n\n    // 4. Return\n    return propertyMapper.toResponse(saved);\n}\n</code></pre>"},{"location":"oss/contributing/","title":"Contributing","text":"<p>How to contribute to StayMate.</p>"},{"location":"oss/contributing/#getting-started","title":"Getting Started","text":"<ol> <li>Fork the repository</li> <li>Clone your fork</li> <li>Create a feature branch</li> <li>Implement your changes</li> <li>Test thoroughly</li> <li>Submit a Pull Request</li> </ol>"},{"location":"oss/contributing/#development-setup","title":"Development Setup","text":"<pre><code># Clone\ngit clone https://github.com/YOUR_USERNAME/staymate.git\ncd staymate/server\n\n# Run\n./mvnw spring-boot:run\n</code></pre>"},{"location":"oss/contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<ul> <li> Code follows Code Style</li> <li> Tests pass (<code>./mvnw test</code>)</li> <li> New features have tests</li> <li> Documentation updated</li> </ul>"},{"location":"oss/contributing/#commit-messages","title":"Commit Messages","text":"<p>Use conventional commits:</p> <pre><code>feat: add new booking feature\nfix: resolve token expiry issue\ndocs: update API documentation\ntest: add property service tests\n</code></pre>"},{"location":"oss/contributing/#questions","title":"Questions?","text":"<p>See FAQ or open an issue.</p>"},{"location":"oss/faq/","title":"FAQ","text":"<p>Frequently asked questions about StayMate.</p>"},{"location":"oss/faq/#general","title":"General","text":""},{"location":"oss/faq/#what-is-staymate","title":"What is StayMate?","text":"<p>StayMate is an enterprise-grade property rental and roommate matching platform built with Spring Boot.</p>"},{"location":"oss/faq/#what-technologies-does-it-use","title":"What technologies does it use?","text":"<ul> <li>Backend: Spring Boot 3.x, Java 17</li> <li>Database: MySQL 8.0</li> <li>Auth: JWT + OAuth2 (Google)</li> <li>Storage: MinIO (S3-compatible)</li> </ul>"},{"location":"oss/faq/#development","title":"Development","text":""},{"location":"oss/faq/#how-do-i-run-locally","title":"How do I run locally?","text":"<pre><code>cd server\n./mvnw spring-boot:run\n</code></pre>"},{"location":"oss/faq/#how-do-i-run-tests","title":"How do I run tests?","text":"<pre><code>./mvnw test\n</code></pre>"},{"location":"oss/faq/#how-do-i-generate-docs","title":"How do I generate docs?","text":"<pre><code>cd staymate-mkdocs\nmkdocs serve\n</code></pre>"},{"location":"oss/faq/#api","title":"API","text":""},{"location":"oss/faq/#how-do-i-authenticate","title":"How do I authenticate?","text":"<p>Use the login endpoint to get a JWT token:</p> <pre><code>POST /api/auth/login\nContent-Type: application/json\n\n{\"email\": \"user@example.com\", \"password\": \"secret\"}\n</code></pre>"},{"location":"oss/faq/#what-are-the-user-roles","title":"What are the user roles?","text":"<ul> <li><code>USER</code> - Tenants</li> <li><code>HOUSE_OWNER</code> - Landlords</li> <li><code>ADMIN</code> - Platform administrators</li> </ul>"},{"location":"oss/faq/#troubleshooting","title":"Troubleshooting","text":""},{"location":"oss/faq/#why-am-i-getting-401","title":"Why am I getting 401?","text":"<p>Your JWT token may be expired. Refresh it using:</p> <pre><code>POST /api/auth/refresh-token\n{\"refreshToken\": \"your-refresh-token\"}\n</code></pre>"},{"location":"oss/faq/#why-am-i-getting-429","title":"Why am I getting 429?","text":"<p>You've exceeded the rate limit (200 requests/minute). Wait and retry.</p>"},{"location":"oss/roadmap/","title":"Roadmap","text":"<p>Future development plans for StayMate.</p>"},{"location":"oss/roadmap/#current-v1","title":"Current (v1)","text":"<ul> <li>\u2705 JWT + OAuth2 authentication</li> <li>\u2705 Property management</li> <li>\u2705 Booking system</li> <li>\u2705 Messaging</li> <li>\u2705 Notifications</li> <li>\u2705 Financial operations</li> </ul>"},{"location":"oss/roadmap/#planned-v2","title":"Planned (v2)","text":"<ul> <li> AI recommendations</li> <li> Advanced roommate matching</li> <li> Stripe payment integration</li> <li> Mobile API optimizations</li> </ul>"},{"location":"oss/roadmap/#future","title":"Future","text":"<ul> <li> Mobile app (React Native)</li> <li> Multi-currency support</li> <li> International expansion</li> <li> Smart property IoT integration</li> </ul>"},{"location":"oss/roadmap/#contributing","title":"Contributing","text":"<p>Want to work on a roadmap item? See Contributing.</p>"},{"location":"performance/","title":"Performance","text":"<p>Performance optimization and scalability strategies.</p>"},{"location":"performance/#performance-model","title":"Performance Model","text":"<pre><code>flowchart LR\n    subgraph Targets[\"Targets\"]\n        P95[\"p95 &lt; 500ms\"]\n        P99[\"p99 &lt; 1000ms\"]\n        ERR[\"Error &lt; 1%\"]\n    end\n\n    subgraph Optimizations[\"Optimizations\"]\n        POOL[\"Connection Pool\"]\n        INDEX[\"DB Indexes\"]\n        ASYNC[\"Async Processing\"]\n    end</code></pre>"},{"location":"performance/#in-this-section","title":"In This Section","text":"Document Description Load Testing JMeter &amp; k6 setup Async Processing Background jobs Scaling Strategy Horizontal scaling Bottlenecks Identified constraints"},{"location":"performance/#sla-targets","title":"SLA Targets","text":"Metric Target Current p95 Response &lt; 500ms \u2705 p99 Response &lt; 1000ms \u2705 Error Rate &lt; 1% \u2705 Throughput &gt; 100 RPS \u2705"},{"location":"performance/async-processing/","title":"Async Processing","text":"<p>Asynchronous method execution in StayMate.</p>"},{"location":"performance/async-processing/#current-usage","title":"Current Usage","text":"<p><code>@Async</code> is used in two services:</p>"},{"location":"performance/async-processing/#auditservice","title":"AuditService","text":"<pre><code>// domain/audit/service/AuditService.java\n@Async\npublic void logAction(AuditAction action) {\n    // Non-blocking audit logging\n}\n\n@Async\npublic void logSecurityEvent(SecurityEvent event) {\n    // Non-blocking security logging\n}\n</code></pre>"},{"location":"performance/async-processing/#websocketnotificationservice","title":"WebSocketNotificationService","text":"<pre><code>// domain/notification/service/WebSocketNotificationService.java\n@Async\npublic void sendNotification(Long userId, Notification notification) {\n    // Non-blocking WebSocket push\n}\n\n@Async\npublic void broadcastNotification(Notification notification) {\n    // Non-blocking broadcast\n}\n</code></pre>"},{"location":"performance/async-processing/#purpose","title":"Purpose","text":"Service Why Async AuditService Audit logging shouldn't block API responses WebSocketNotificationService WebSocket pushes are I/O bound"},{"location":"performance/async-processing/#configuration","title":"Configuration","text":"<p>Missing @EnableAsync</p> <p>The codebase uses <code>@Async</code> annotations but <code>@EnableAsync</code> was not found in configuration.</p> <p>To enable async processing, add to a configuration class:</p> <pre><code>@Configuration\n@EnableAsync\npublic class AsyncConfig {\n}\n</code></pre>"},{"location":"performance/async-processing/#thread-pool-recommended","title":"Thread Pool (Recommended)","text":"<p>For production, configure a custom thread pool:</p> <pre><code>@Configuration\n@EnableAsync\npublic class AsyncConfig implements AsyncConfigurer {\n\n    @Override\n    public Executor getAsyncExecutor() {\n        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();\n        executor.setCorePoolSize(5);\n        executor.setMaxPoolSize(10);\n        executor.setQueueCapacity(100);\n        executor.setThreadNamePrefix(\"Async-\");\n        executor.initialize();\n        return executor;\n    }\n}\n</code></pre>"},{"location":"performance/bottlenecks/","title":"Bottlenecks","text":"<p>Identified performance constraints and mitigations.</p>"},{"location":"performance/bottlenecks/#known-bottlenecks","title":"Known Bottlenecks","text":"Bottleneck Impact Mitigation N+1 queries Slow list views Fetch joins Large uploads Timeout Chunked upload DB connections Pool exhaustion HikariCP tuning"},{"location":"performance/load-testing/","title":"Load Testing","text":"<p>Performance testing with JMeter and k6.</p>"},{"location":"performance/load-testing/#quick-start","title":"Quick Start","text":"k6 (Recommended)JMeter <pre><code>cd load-testing/k6\nk6 run --vus 10 --duration 60s main.js\n</code></pre> <pre><code>cd load-testing/jmeter\njmeter -n -t staymate-load-test.jmx -l results.jtl\n</code></pre>"},{"location":"performance/load-testing/#api-coverage","title":"API Coverage","text":"Category Endpoints Covered Auth 8 \u2705 Properties 9 \u2705 Bookings 7 \u2705 Finance 16 \u2705 Total 148 \u2705 100%"},{"location":"performance/load-testing/#traffic-distribution","title":"Traffic Distribution","text":"<pre><code>pie title Virtual User Roles\n    \"Tenant (60%)\" : 60\n    \"Landlord (30%)\" : 30\n    \"Admin (10%)\" : 10</code></pre>"},{"location":"performance/load-testing/#sla-thresholds","title":"SLA Thresholds","text":"Metric Target Critical p95 Response &lt; 500ms &lt; 1000ms p99 Response &lt; 1000ms &lt; 2000ms Error Rate &lt; 1% &lt; 5%"},{"location":"performance/load-testing/#documentation","title":"Documentation","text":"<p>Full details: load-testing/README.md</p>"},{"location":"performance/scaling-strategy/","title":"Scaling Strategy","text":"<p>Horizontal scaling approach for StayMate.</p>"},{"location":"performance/scaling-strategy/#stateless-design","title":"Stateless Design","text":"<p>JWT-based auth enables horizontal scaling without shared sessions.</p>"},{"location":"performance/scaling-strategy/#scaling-dimensions","title":"Scaling Dimensions","text":"Component Strategy API Add replicas behind load balancer Database Read replicas, connection pooling Storage MinIO cluster"},{"location":"product/","title":"Product &amp; Vision","text":"<p>This section explains why StayMate exists, what problems it solves, and where it's headed.</p>"},{"location":"product/#overview","title":"Overview","text":"<p>StayMate is a production-grade property rental platform built to demonstrate enterprise software engineering practices while solving real-world housing challenges.</p> <pre><code>mindmap\n  root((StayMate))\n    Tenants\n      Property Search\n      Booking\n      Roommate Matching\n      Messaging\n    Landlords\n      Property Management\n      Booking Approval\n      Earnings &amp; Payouts\n    Admins\n      User Management\n      Content Moderation\n      Analytics\n      Fraud Detection</code></pre>"},{"location":"product/#in-this-section","title":"In This Section","text":"Document Description Motivation Why we built StayMate Problem Statement The housing challenges we address Vision &amp; Goals Where we're headed Features Complete feature breakdown Non-Goals What StayMate intentionally doesn't do"},{"location":"product/#target-audience","title":"Target Audience","text":"<ul> <li>Property Seekers (Tenants): Finding housing and roommates</li> <li>Property Owners (Landlords): Managing listings and tenants</li> <li>Platform Operators (Admins): Overseeing the ecosystem</li> </ul>"},{"location":"product/features/","title":"Features","text":""},{"location":"product/features/#complete-feature-map","title":"Complete Feature Map","text":"<p>StayMate provides role-specific features for Tenants, Landlords, and Administrators.</p>"},{"location":"product/features/#feature-overview","title":"Feature Overview","text":"<pre><code>graph TB\n    subgraph \"Tenant Features\"\n        T1[Property Search]\n        T2[Booking]\n        T3[Roommate Matching]\n        T4[Messaging]\n        T5[Reviews]\n        T6[Saved Properties]\n    end\n\n    subgraph \"Landlord Features\"\n        L1[Property Management]\n        L2[Booking Approval]\n        L3[Earnings Dashboard]\n        L4[Payout Requests]\n        L5[Tenant Communication]\n    end\n\n    subgraph \"Admin Features\"\n        A1[User Management]\n        A2[Content Moderation]\n        A3[Analytics Dashboard]\n        A4[Fraud Detection]\n        A5[Financial Oversight]\n    end</code></pre>"},{"location":"product/features/#tenant-features","title":"Tenant Features","text":""},{"location":"product/features/#property-discovery","title":"Property Discovery","text":"Feature Description Endpoint Search Filter by location, price, type, amenities <code>GET /api/properties/search</code> Recommendations AI-powered suggestions <code>GET /api/properties/recommended</code> Details Full property info with images <code>GET /api/properties/{id}</code> Save Bookmark for later <code>POST /api/saved/properties</code>"},{"location":"product/features/#booking-system","title":"Booking System","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; PENDING: Create Booking\n    PENDING --&gt; APPROVED: Landlord Approves\n    PENDING --&gt; REJECTED: Landlord Rejects\n    PENDING --&gt; CANCELLED: Tenant Cancels\n    APPROVED --&gt; CHECKED_IN: Check In\n    CHECKED_IN --&gt; CHECKED_OUT: Check Out\n    CHECKED_OUT --&gt; [*]</code></pre>"},{"location":"product/features/#roommate-matching","title":"Roommate Matching","text":"<ul> <li>Create roommate posts with preferences</li> <li>Search compatible matches</li> <li>Direct messaging integration</li> <li>Match/unmatch functionality</li> </ul>"},{"location":"product/features/#messaging","title":"Messaging","text":"<ul> <li>Real-time conversations (WebSocket-ready)</li> <li>Property-context conversations</li> <li>Unread count tracking</li> <li>Presence indicators</li> </ul>"},{"location":"product/features/#landlord-features","title":"Landlord Features","text":""},{"location":"product/features/#property-management","title":"Property Management","text":"Action Description Create List new property with images Update Modify details, pricing Status AVAILABLE / UNAVAILABLE / RENTED Delete Remove listing"},{"location":"product/features/#financial-operations","title":"Financial Operations","text":"<pre><code>flowchart LR\n    B[Booking Paid] --&gt; E[Earnings Credited]\n    E --&gt; P[Payout Request]\n    P --&gt; A[Admin Approval]\n    A --&gt; T[Bank Transfer]</code></pre> <ul> <li>Earnings summary and history</li> <li>Multiple payout methods</li> <li>Export reports (CSV/PDF)</li> </ul>"},{"location":"product/features/#admin-features","title":"Admin Features","text":""},{"location":"product/features/#user-management","title":"User Management","text":"<ul> <li>List, search, filter users</li> <li>Role management (promote/demote)</li> <li>Account actions (suspend, delete)</li> <li>Deletion request processing</li> </ul>"},{"location":"product/features/#analytics-dashboard","title":"Analytics Dashboard","text":"Metric Source User Growth <code>GET /api/admin/analytics/user-growth</code> Revenue <code>GET /api/admin/analytics/revenue</code> Financial Overview <code>GET /api/admin/analytics/financial-overview</code>"},{"location":"product/features/#moderation","title":"Moderation","text":"<ul> <li>Property approval workflow</li> <li>Fraud detection and flagging</li> <li>Support ticket management</li> <li>Verification request processing</li> </ul>"},{"location":"product/features/#cross-cutting-features","title":"Cross-Cutting Features","text":"Feature All Roles Notifications Push, in-app, email Profile Update, profile picture Settings Preferences, notifications Verification Phone, document"},{"location":"product/motivation/","title":"Motivation","text":""},{"location":"product/motivation/#why-staymate-exists","title":"Why StayMate Exists","text":"<p>StayMate was created to address a dual need:</p> <ol> <li>Real-World Impact: Solve genuine housing discovery and management challenges</li> <li>Engineering Excellence: Demonstrate production-grade software architecture</li> </ol>"},{"location":"product/motivation/#the-housing-problem","title":"The Housing Problem","text":"<pre><code>graph LR\n    subgraph \"Current Pain Points\"\n        A[Scattered Listings] --&gt; P[Poor Experience]\n        B[Trust Issues] --&gt; P\n        C[No Verification] --&gt; P\n        D[Manual Processes] --&gt; P\n    end\n\n    subgraph \"StayMate Solution\"\n        P --&gt; S[Unified Platform]\n        S --&gt; U[Verified Users]\n        S --&gt; A2[Automated Workflows]\n        S --&gt; T[Trust &amp; Safety]\n    end</code></pre>"},{"location":"product/motivation/#for-tenants","title":"For Tenants","text":"<ul> <li>Properties scattered across multiple platforms</li> <li>No way to verify landlord legitimacy</li> <li>Difficulty finding compatible roommates</li> <li>Manual booking and payment processes</li> </ul>"},{"location":"product/motivation/#for-landlords","title":"For Landlords","text":"<ul> <li>Managing tenant inquiries across channels</li> <li>No integrated payment tracking</li> <li>Manual verification of tenant backgrounds</li> <li>Scattered maintenance request handling</li> </ul>"},{"location":"product/motivation/#for-administrators","title":"For Administrators","text":"<ul> <li>No centralized fraud detection</li> <li>Manual content moderation</li> <li>Limited analytics visibility</li> </ul>"},{"location":"product/motivation/#why-spring-boot","title":"Why Spring Boot?","text":"<p>Design Decision</p> <p>We chose Spring Boot for its:</p> <ul> <li>Mature Ecosystem: Battle-tested in enterprise</li> <li>Security Features: Spring Security with OAuth2/JWT</li> <li>Data Access: Spring Data JPA with Hibernate</li> <li>Production Readiness: Actuator, profiles, externalized config</li> </ul>"},{"location":"product/motivation/#technical-goals","title":"Technical Goals","text":"Goal Implementation Security First JWT + OAuth2, rate limiting, RBAC Clean Architecture Layered design with clear boundaries Observability Structured logging, metrics, health checks Scalability Stateless auth, connection pooling Maintainability DTO patterns, exception handling, migrations"},{"location":"product/motivation/#who-should-use-this","title":"Who Should Use This?","text":"<ul> <li>Developers learning enterprise Spring Boot patterns</li> <li>Architects evaluating production-ready designs</li> <li>Interviewers assessing real-world project experience</li> <li>Contributors interested in OSS property tech</li> </ul>"},{"location":"product/non-goals/","title":"Non-Goals","text":""},{"location":"product/non-goals/#what-staymate-doesnt-do","title":"What StayMate Doesn't Do","text":"<p>Being clear about non-goals prevents scope creep and focuses development effort.</p>"},{"location":"product/non-goals/#explicit-non-goals","title":"Explicit Non-Goals","text":""},{"location":"product/non-goals/#1-payment-processing","title":"1. Payment Processing","text":"<p>Not a Payment Gateway</p> <p>StayMate tracks financial transactions but does not process payments.</p> <ul> <li>We record earnings and payouts</li> <li>Actual money movement is external (bank transfers, Stripe integration is future scope)</li> <li>No credit card storage or PCI compliance</li> </ul>"},{"location":"product/non-goals/#2-real-estate-transactions","title":"2. Real Estate Transactions","text":"<pre><code>graph LR\n    A[Property Sale] --&gt; X[Not Supported]\n    B[Mortgage] --&gt; X\n    C[Property Valuation] --&gt; X\n    D[Legal Contracts] --&gt; X</code></pre> <p>StayMate is for rentals only:</p> <ul> <li>No property buying/selling</li> <li>No mortgage calculations</li> <li>No legal contract generation</li> <li>No escrow services</li> </ul>"},{"location":"product/non-goals/#3-background-checks","title":"3. Background Checks","text":"Feature Status Reason Credit checks \u274c Requires third-party integrations Criminal records \u274c Legal and privacy complexity Employment verification \u274c Out of scope Reference checks \u274c Manual process recommended"},{"location":"product/non-goals/#4-property-maintenance-automation","title":"4. Property Maintenance Automation","text":"<p>We provide:</p> <ul> <li>\u2705 Maintenance request submission</li> <li>\u2705 Request status tracking</li> <li>\u2705 Communication between tenant and landlord</li> </ul> <p>We do not provide:</p> <ul> <li>\u274c Contractor dispatch</li> <li>\u274c Parts ordering</li> <li>\u274c Scheduling integration</li> <li>\u274c IoT device integration</li> </ul>"},{"location":"product/non-goals/#5-multi-tenancy-saas-model","title":"5. Multi-Tenancy (SaaS Model)","text":"<p>Single Tenant Architecture</p> <p>Current design is single-tenant:</p> <ul> <li>One database for all users</li> <li>No customer isolation</li> <li>No white-labeling</li> </ul>"},{"location":"product/non-goals/#6-offline-functionality","title":"6. Offline Functionality","text":"<ul> <li>API requires internet connection</li> <li>No Progressive Web App (PWA) features</li> <li>No offline data sync</li> </ul>"},{"location":"product/non-goals/#why-these-non-goals","title":"Why These Non-Goals?","text":"Non-Goal Rationale Payment processing Regulatory complexity, security burden Real estate sales Different market, different features Background checks Privacy concerns, third-party dependency Contractor dispatch Requires marketplace functionality Multi-tenancy Adds significant complexity"},{"location":"product/non-goals/#future-considerations","title":"Future Considerations","text":"<p>These may become goals in future versions:</p> <ol> <li>Stripe Integration for in-app payments</li> <li>Background Check API integration</li> <li>Mobile App for offline-first experience</li> <li>Multi-tenancy for enterprise customers</li> </ol> <p>Contributing</p> <p>If you'd like to work on any of these, see Contributing.</p>"},{"location":"product/problem-statement/","title":"Problem Statement","text":""},{"location":"product/problem-statement/#the-housing-discovery-challenge","title":"The Housing Discovery Challenge","text":"<p>Finding and managing rental properties involves multiple disconnected systems, manual processes, and trust gaps.</p>"},{"location":"product/problem-statement/#core-problems","title":"Core Problems","text":""},{"location":"product/problem-statement/#1-fragmented-discovery","title":"1. Fragmented Discovery","text":"<pre><code>graph TD\n    T[Tenant] --&gt; P1[Platform A]\n    T --&gt; P2[Platform B]\n    T --&gt; P3[Social Media]\n    T --&gt; P4[Word of Mouth]\n\n    P1 &amp; P2 &amp; P3 &amp; P4 --&gt; C[Confusion &amp; Missed Opportunities]</code></pre> <p>Impact: Tenants waste hours searching across platforms; landlords miss potential tenants.</p>"},{"location":"product/problem-statement/#2-trust-deficit","title":"2. Trust Deficit","text":"Stakeholder Trust Problem Tenant Is this landlord legitimate? Is the property real? Landlord Will this tenant pay? Are they who they claim? Both Is this platform secure? <p>Impact: Scams, disputes, and abandoned bookings.</p>"},{"location":"product/problem-statement/#3-manual-workflows","title":"3. Manual Workflows","text":"<pre><code>sequenceDiagram\n    participant T as Tenant\n    participant L as Landlord\n\n    T-&gt;&gt;L: Email inquiry\n    L-&gt;&gt;T: Reply with details\n    T-&gt;&gt;L: Request viewing\n    L-&gt;&gt;T: Schedule manually\n    T-&gt;&gt;L: Submit application (paper)\n    L-&gt;&gt;T: Request documents (email)\n    T-&gt;&gt;L: Send payment (bank transfer)\n    L-&gt;&gt;T: Confirm receipt</code></pre> <p>Impact: Slow turnaround, lost communications, no audit trail.</p>"},{"location":"product/problem-statement/#4-roommate-matching-gap","title":"4. Roommate Matching Gap","text":"<ul> <li>No integrated solution for finding compatible roommates</li> <li>Separate apps for housing vs. roommate search</li> <li>No unified messaging</li> </ul>"},{"location":"product/problem-statement/#staymates-solution","title":"StayMate's Solution","text":"Problem Solution Fragmented discovery Unified search with filters Trust deficit Verification system, reviews Manual workflows Automated booking lifecycle Roommate gap Integrated matching + messaging"},{"location":"product/problem-statement/#success-criteria","title":"Success Criteria","text":"<p>We've succeeded when:</p> <ul> <li>A tenant can go from search \u2192 booking in under 10 minutes</li> <li>Landlords manage all properties from a single dashboard</li> <li>Admins can detect fraud before it impacts users</li> <li>The platform achieves p95 response time &lt; 500ms</li> </ul>"},{"location":"product/vision-and-goals/","title":"Vision &amp; Goals","text":""},{"location":"product/vision-and-goals/#vision-statement","title":"Vision Statement","text":"<p>StayMate will be the most trusted and efficient platform for property rental and roommate matching, where every interaction is secure, every workflow is automated, and every user experience is delightful.</p>"},{"location":"product/vision-and-goals/#strategic-goals","title":"Strategic Goals","text":""},{"location":"product/vision-and-goals/#short-term-mvp","title":"Short-Term (MVP)","text":"<pre><code>gantt\n    title MVP Milestones\n    dateFormat  YYYY-MM-DD\n    section Core\n    User Authentication       :done, auth, 2024-01-01, 30d\n    Property CRUD             :done, prop, after auth, 30d\n    Booking System            :done, book, after prop, 30d\n    section Extended\n    Messaging                 :done, msg, after book, 20d\n    Payments                  :done, pay, after msg, 20d\n    Admin Dashboard           :done, admin, after pay, 20d</code></pre>"},{"location":"product/vision-and-goals/#medium-term","title":"Medium-Term","text":"<ul> <li> AI-powered property recommendations</li> <li> Advanced roommate matching algorithms</li> <li> Mobile application (React Native)</li> <li> Multi-currency support</li> </ul>"},{"location":"product/vision-and-goals/#long-term","title":"Long-Term","text":"<ul> <li> International expansion</li> <li> Blockchain-based rental agreements</li> <li> IoT integration for smart properties</li> </ul>"},{"location":"product/vision-and-goals/#design-principles","title":"Design Principles","text":""},{"location":"product/vision-and-goals/#1-security-first","title":"1. Security First","text":"<p>Every feature is designed with security as a foundation:</p> <pre><code>// Example: All endpoints protected by default\n.anyRequest().authenticated()\n</code></pre>"},{"location":"product/vision-and-goals/#2-fail-fast-recover-gracefully","title":"2. Fail Fast, Recover Gracefully","text":"<pre><code>flowchart TD\n    REQ[Request] --&gt; VAL{Validate}\n    VAL --&gt;|Invalid| ERR[400 Bad Request]\n    VAL --&gt;|Valid| PROC[Process]\n    PROC --&gt;|Error| HANDLE[GlobalExceptionHandler]\n    HANDLE --&gt; RESPONSE[Structured Error Response]\n    PROC --&gt;|Success| OK[200 OK]</code></pre>"},{"location":"product/vision-and-goals/#3-observable-by-default","title":"3. Observable by Default","text":"<ul> <li>Structured JSON logging</li> <li>Health endpoints exposed</li> <li>Metrics-ready architecture</li> </ul>"},{"location":"product/vision-and-goals/#4-developer-experience","title":"4. Developer Experience","text":"<ul> <li>Consistent API contracts</li> <li>Comprehensive error messages</li> <li>Self-documenting code</li> </ul>"},{"location":"product/vision-and-goals/#quality-attributes","title":"Quality Attributes","text":"Attribute Target How Performance p95 &lt; 500ms Connection pooling, efficient queries Availability 99.9% Health checks, graceful degradation Security Zero breaches JWT, rate limiting, input validation Maintainability &lt; 1 hour to understand any module Clean architecture, documentation"},{"location":"product/vision-and-goals/#north-star-metrics","title":"North Star Metrics","text":"<ul> <li>Time to First Booking: &lt; 10 minutes for new users</li> <li>Landlord Listing Time: &lt; 5 minutes per property</li> <li>API Response Time: p95 &lt; 500ms</li> <li>Error Rate: &lt; 0.1%</li> </ul>"},{"location":"quality/","title":"Quality &amp; Delivery","text":"<p>Testing strategy and CI/CD pipeline.</p>"},{"location":"quality/#testing-pyramid","title":"Testing Pyramid","text":"<pre><code>graph TB\n    E2E[\"E2E Tests (Few)\"]\n    INT[\"Integration Tests\"]\n    UNIT[\"Unit Tests (Many)\"]\n\n    UNIT --&gt; INT --&gt; E2E</code></pre>"},{"location":"quality/#in-this-section","title":"In This Section","text":"Document Description Unit Testing JUnit &amp; Mockito Integration Testing Spring Boot Test Contract Testing API contracts CI/CD Pipeline configuration Release Strategy Versioning &amp; releases"},{"location":"quality/#coverage-targets","title":"Coverage Targets","text":"Layer Target Services 80%+ Controllers 70%+ Repositories 60%+"},{"location":"quality/ci-cd/","title":"CI/CD Pipeline","text":"<p>Continuous Integration and Deployment configuration.</p>"},{"location":"quality/ci-cd/#pipeline-overview","title":"Pipeline Overview","text":"<pre><code>graph LR\n    CODE[Push Code] --&gt; BUILD[Build]\n    BUILD --&gt; TEST[Test]\n    TEST --&gt; LINT[Lint]\n    LINT --&gt; SCAN[Security Scan]\n    SCAN --&gt; DEPLOY[Deploy]</code></pre>"},{"location":"quality/ci-cd/#github-actions-example","title":"GitHub Actions Example","text":"<pre><code># .github/workflows/ci.yml\nname: CI Pipeline\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    steps:\n    - uses: actions/checkout@v4\n\n    - name: Set up JDK 17\n      uses: actions/setup-java@v4\n      with:\n        java-version: '17'\n        distribution: 'temurin'\n\n    - name: Build\n      run: ./mvnw clean compile\n\n    - name: Test\n      run: ./mvnw test\n\n    - name: Package\n      run: ./mvnw package -DskipTests\n</code></pre>"},{"location":"quality/ci-cd/#pipeline-stages","title":"Pipeline Stages","text":"Stage Purpose Tools Build Compile code Maven Test Run unit tests JUnit, Mockito Lint Code quality Checkstyle Scan Security OWASP Deploy Release Docker"},{"location":"quality/contract-testing/","title":"Contract Testing","text":"<p>API contract testing approaches.</p>"},{"location":"quality/contract-testing/#approach","title":"Approach","text":"<p>Ensure API contracts are stable between versions.</p>"},{"location":"quality/contract-testing/#tools","title":"Tools","text":"Tool Purpose OpenAPI API specification Spring Cloud Contract Consumer-driven contracts"},{"location":"quality/integration-testing/","title":"Integration Testing","text":"<p>API testing with Spring Boot Test.</p>"},{"location":"quality/integration-testing/#example","title":"Example","text":"<pre><code>@SpringBootTest\n@AutoConfigureMockMvc\nclass PropertyControllerTest {\n    @Autowired MockMvc mockMvc;\n\n    @Test\n    @WithMockUser(roles = \"HOUSE_OWNER\")\n    void createProperty_valid_returns201() throws Exception {\n        mockMvc.perform(post(\"/api/properties\")\n                .contentType(APPLICATION_JSON)\n                .content(json))\n            .andExpect(status().isCreated());\n    }\n}\n</code></pre>"},{"location":"quality/release-strategy/","title":"Release Strategy","text":"<p>Versioning and release process.</p>"},{"location":"quality/release-strategy/#semantic-versioning","title":"Semantic Versioning","text":"<pre><code>MAJOR.MINOR.PATCH\n1.2.3\n</code></pre> Type When MAJOR Breaking changes MINOR New features PATCH Bug fixes"},{"location":"quality/release-strategy/#release-process","title":"Release Process","text":"<ol> <li>Update version in <code>pom.xml</code></li> <li>Update CHANGELOG.md</li> <li>Create tag: <code>git tag v1.2.3</code></li> <li>Push release</li> </ol>"},{"location":"quality/unit-testing/","title":"Unit Testing","text":"<p>Unit testing with JUnit 5 and Mockito.</p>"},{"location":"quality/unit-testing/#example","title":"Example","text":"<pre><code>@ExtendWith(MockitoExtension.class)\nclass PropertyServiceTest {\n    @Mock PropertyRepository repository;\n    @InjectMocks PropertyServiceImpl service;\n\n    @Test\n    void getProperty_exists_returnsResponse() {\n        when(repository.findById(1L)).thenReturn(Optional.of(property));\n        PropertyResponse result = service.getProperty(1L);\n        assertThat(result.getId()).isEqualTo(1L);\n    }\n}\n</code></pre>"},{"location":"security/","title":"Security","text":"<p>This section covers StayMate's comprehensive security architecture, from authentication to threat mitigation.</p>"},{"location":"security/#security-layers","title":"Security Layers","text":"<pre><code>graph TB\n    subgraph \"Perimeter\"\n        CORS[\"CORS Policy\"]\n        RATE[\"Rate Limiting\"]\n    end\n\n    subgraph \"Authentication\"\n        JWT[\"JWT Tokens\"]\n        OAUTH[\"OAuth2 (Google)\"]\n    end\n\n    subgraph \"Authorization\"\n        RBAC[\"Role-Based Access\"]\n        METHOD[\"Method Security\"]\n    end\n\n    subgraph \"Data Protection\"\n        HASH[\"Password Hashing\"]\n        VALID[\"Input Validation\"]\n        SQL[\"SQL Injection Prevention\"]\n    end\n\n    CORS --&gt; RATE\n    RATE --&gt; JWT\n    JWT --&gt; RBAC\n    RBAC --&gt; METHOD\n    METHOD --&gt; HASH\n    HASH --&gt; VALID\n    VALID --&gt; SQL</code></pre>"},{"location":"security/#security-stack","title":"Security Stack","text":"Layer Technology Configuration Authentication JWT + OAuth2 <code>JwtTokenProvider</code>, <code>CustomOAuth2UserService</code> Authorization Spring Security <code>@PreAuthorize</code>, <code>SecurityConfig</code> Rate Limiting Token Bucket <code>RateLimitFilter</code> Password BCrypt <code>PasswordEncoder</code> CORS Spring CORS <code>CorsConfigurationSource</code>"},{"location":"security/#in-this-section","title":"In This Section","text":"Document Description JWT Lifecycle Token generation, validation, refresh Authorization Model RBAC with roles and permissions Threat Model Security threats and mitigations Rate Limiting Token bucket algorithm, configuration Data Privacy Password handling, data protection"},{"location":"security/#key-security-classes","title":"Key Security Classes","text":"Class Package Purpose <code>SecurityConfig</code> <code>auth.config</code> HTTP security filter chain <code>JwtTokenProvider</code> <code>auth.security</code> Token generation/validation <code>JwtAuthenticationFilter</code> <code>auth.security</code> Request authentication <code>RateLimitFilter</code> <code>auth.config</code> Request throttling <code>CustomOAuth2UserService</code> <code>auth.security.oauth2</code> Google OAuth2 <code>GlobalExceptionHandler</code> <code>auth.exception</code> Security error handling"},{"location":"security/#quick-security-facts","title":"Quick Security Facts","text":"<ul> <li>Token Types: Access (15 min), Refresh (7 days)</li> <li>Roles: <code>USER</code>, <code>HOUSE_OWNER</code>, <code>ADMIN</code></li> <li>OAuth Providers: Google</li> <li>Rate Limit: 200 requests/minute default</li> <li>Password: BCrypt with strength 10</li> </ul>"},{"location":"security/authorization-model/","title":"Authorization Model","text":"<p>Role-Based Access Control (RBAC) implementation in StayMate.</p>"},{"location":"security/authorization-model/#role-hierarchy","title":"Role Hierarchy","text":"<pre><code>graph TD\n    ADMIN[\"\ud83d\udd10 ADMIN&lt;br/&gt;Full Platform Access\"]\n    HOUSE_OWNER[\"\ud83c\udfe0 HOUSE_OWNER&lt;br/&gt;Property Management\"]\n    USER[\"\ud83d\udc64 USER&lt;br/&gt;Basic Access\"]\n\n    ADMIN --&gt; HOUSE_OWNER\n    HOUSE_OWNER --&gt; USER\n\n    style ADMIN fill:#e74c3c\n    style HOUSE_OWNER fill:#3498db\n    style USER fill:#2ecc71</code></pre>"},{"location":"security/authorization-model/#role-definitions","title":"Role Definitions","text":"Role Code Description USER <code>ROLE_USER</code> Tenants searching and booking properties HOUSE_OWNER <code>ROLE_HOUSE_OWNER</code> Landlords managing properties ADMIN <code>ROLE_ADMIN</code> Platform administrators"},{"location":"security/authorization-model/#role-capabilities-matrix","title":"Role Capabilities Matrix","text":"Capability USER HOUSE_OWNER ADMIN View properties \u2705 \u2705 \u2705 Create bookings \u2705 \u2705 \u2705 Create properties \u274c \u2705 \u2705 Approve bookings \u274c \u2705 \u2705 View earnings \u274c \u2705 \u2705 Request payouts \u274c \u2705 \u2705 Manage users \u274c \u274c \u2705 View analytics \u274c \u274c \u2705 Process payouts \u274c \u274c \u2705 Fraud detection \u274c \u274c \u2705"},{"location":"security/authorization-model/#implementation","title":"Implementation","text":""},{"location":"security/authorization-model/#securityconfig-authorization-rules","title":"SecurityConfig Authorization Rules","text":"<pre><code>// SecurityConfig.java\n@Bean\npublic SecurityFilterChain securityFilterChain(HttpSecurity http) {\n    http.authorizeHttpRequests(auth -&gt; auth\n        // Public endpoints\n        .requestMatchers(\n            \"/api/auth/register\",\n            \"/api/auth/login\",\n            \"/api/auth/refresh-token\",\n            \"/api/public/**\"\n        ).permitAll()\n\n        // Admin only\n        .requestMatchers(\"/api/admin/**\")\n            .hasRole(\"ADMIN\")\n\n        // House owner endpoints\n        .requestMatchers(\"/api/house-owner/**\")\n            .hasAnyRole(\"HOUSE_OWNER\", \"ADMIN\")\n\n        // Authenticated users\n        .requestMatchers(\"/api/users/**\")\n            .authenticated()\n\n        // Default: require authentication\n        .anyRequest().authenticated()\n    );\n    return http.build();\n}\n</code></pre>"},{"location":"security/authorization-model/#method-level-security","title":"Method-Level Security","text":"<pre><code>@RestController\n@RequestMapping(\"/api/properties\")\npublic class PropertyController {\n\n    @PostMapping\n    @PreAuthorize(\"hasRole('HOUSE_OWNER')\")\n    public ResponseEntity&lt;PropertyResponse&gt; create(...) {\n        // Only HOUSE_OWNER and ADMIN\n    }\n\n    @DeleteMapping(\"/{id}\")\n    @PreAuthorize(\"hasRole('ADMIN') or @propertyService.isOwner(#id)\")\n    public ResponseEntity&lt;Void&gt; delete(@PathVariable Long id) {\n        // Admin OR property owner\n    }\n}\n</code></pre>"},{"location":"security/authorization-model/#user-entity-roles","title":"User Entity Roles","text":"<pre><code>// User.java\n@Entity\npublic class User {\n\n    @ElementCollection(fetch = FetchType.EAGER)\n    @CollectionTable(name = \"user_roles\", joinColumns = @JoinColumn(name = \"user_id\"))\n    @Enumerated(EnumType.STRING)\n    @Column(name = \"role\")\n    private Set&lt;RoleName&gt; roles = new HashSet&lt;&gt;();\n\n    public boolean isAdmin() {\n        return roles.contains(RoleName.ROLE_ADMIN);\n    }\n\n    public boolean isHouseOwner() {\n        return roles.contains(RoleName.ROLE_HOUSE_OWNER);\n    }\n}\n</code></pre> <pre><code>// RoleName.java\npublic enum RoleName {\n    ROLE_USER,\n    ROLE_HOUSE_OWNER,\n    ROLE_ADMIN\n}\n</code></pre>"},{"location":"security/authorization-model/#role-assignment-flow","title":"Role Assignment Flow","text":"<pre><code>sequenceDiagram\n    participant U as User\n    participant AC as AuthController\n    participant AS as AuthService\n    participant DB as Database\n\n    U-&gt;&gt;AC: POST /api/auth/register\n    AC-&gt;&gt;AS: register(request)\n    AS-&gt;&gt;AS: Create user with ROLE_USER\n    AS-&gt;&gt;DB: INSERT INTO users\n    AS-&gt;&gt;DB: INSERT INTO user_roles (ROLE_USER)\n\n    Note over U: Later, user selects landlord role\n\n    U-&gt;&gt;AC: POST /api/auth/select-role\n    AC-&gt;&gt;AS: selectRole(HOUSE_OWNER)\n    AS-&gt;&gt;DB: INSERT INTO user_roles (ROLE_HOUSE_OWNER)\n    AS--&gt;&gt;U: Updated tokens with new roles</code></pre>"},{"location":"security/authorization-model/#oauth2-role-selection","title":"OAuth2 Role Selection","text":"<p>For OAuth2 users, role selection happens after first login:</p> <pre><code>@PostMapping(\"/select-role\")\n@PreAuthorize(\"isAuthenticated()\")\npublic ResponseEntity&lt;AuthResponse&gt; selectRole(\n        @RequestBody RoleSelectionRequest request) {\n\n    User user = userService.getCurrentUser();\n\n    if (user.isRoleSelected()) {\n        throw new BadRequestException(\"Role already selected\");\n    }\n\n    user.getRoles().add(request.getRole());\n    user.setRoleSelected(true);\n    userRepository.save(user);\n\n    // Generate new tokens with updated roles\n    return ResponseEntity.ok(authService.generateTokens(user));\n}\n</code></pre>"},{"location":"security/authorization-model/#endpoint-protection-summary","title":"Endpoint Protection Summary","text":"Pattern Access <code>/api/auth/register,login,refresh-token</code> Public <code>/api/public/**</code> Public <code>/api/admin/**</code> ADMIN only <code>/api/house-owner/**</code> HOUSE_OWNER, ADMIN <code>/api/**</code> (others) Authenticated"},{"location":"security/data-privacy/","title":"Data Privacy","text":"<p>How StayMate protects user data and handles sensitive information.</p>"},{"location":"security/data-privacy/#data-classification","title":"Data Classification","text":"Category Examples Protection Credentials Passwords, tokens BCrypt, never logged PII Email, phone, address Encrypted at rest Financial Earnings, payouts Access controlled Content Messages, reviews User-owned"},{"location":"security/data-privacy/#password-security","title":"Password Security","text":""},{"location":"security/data-privacy/#hashing-strategy","title":"Hashing Strategy","text":"<pre><code>@Bean\npublic PasswordEncoder passwordEncoder() {\n    return new BCryptPasswordEncoder(10);\n}\n</code></pre> Algorithm BCrypt Strength 10 (2^10 iterations) Salt Auto-generated Reversible No"},{"location":"security/data-privacy/#password-flow","title":"Password Flow","text":"<pre><code>sequenceDiagram\n    participant User\n    participant API\n    participant BCrypt\n    participant Database\n\n    Note over User,Database: Registration\n    User-&gt;&gt;API: password: \"MySecret123\"\n    API-&gt;&gt;BCrypt: encode(\"MySecret123\")\n    BCrypt--&gt;&gt;API: $2a$10$XkL...\n    API-&gt;&gt;Database: Store hash only\n\n    Note over User,Database: Login\n    User-&gt;&gt;API: password: \"MySecret123\"\n    API-&gt;&gt;Database: Get stored hash\n    API-&gt;&gt;BCrypt: matches(\"MySecret123\", hash)\n    BCrypt--&gt;&gt;API: true/false</code></pre>"},{"location":"security/data-privacy/#password-rules","title":"Password Rules","text":"<pre><code>public class RegisterRequest {\n    @NotBlank\n    @Size(min = 8, message = \"Password must be at least 8 characters\")\n    @Pattern(regexp = \".*[A-Z].*\", message = \"Must contain uppercase\")\n    @Pattern(regexp = \".*[a-z].*\", message = \"Must contain lowercase\")\n    @Pattern(regexp = \".*[0-9].*\", message = \"Must contain digit\")\n    private String password;\n}\n</code></pre>"},{"location":"security/data-privacy/#sensitive-data-handling","title":"Sensitive Data Handling","text":""},{"location":"security/data-privacy/#never-log-sensitive-data","title":"Never Log Sensitive Data","text":"<pre><code>// \u274c NEVER do this\nlog.info(\"User login: email={}, password={}\", email, password);\nlog.debug(\"Token generated: {}\", jwtToken);\n\n// \u2705 Do this instead\nlog.info(\"User login attempt: email={}\", email);\nlog.debug(\"Token generated for userId={}\", userId);\n</code></pre>"},{"location":"security/data-privacy/#dto-pattern-for-response-filtering","title":"DTO Pattern for Response Filtering","text":"<pre><code>// Entity contains sensitive data\n@Entity\npublic class User {\n    private Long id;\n    private String email;\n    private String password;  // BCrypt hash - NEVER expose\n    private String phoneOtp;   // OTP - NEVER expose\n}\n\n// Response DTO excludes sensitive fields\npublic class UserResponse {\n    private Long id;\n    private String email;\n    private String firstName;\n    private String lastName;\n    // No password, no OTP\n}\n</code></pre>"},{"location":"security/data-privacy/#access-control-for-financial-data","title":"Access Control for Financial Data","text":"<pre><code>@GetMapping(\"/earnings\")\n@PreAuthorize(\"hasRole('HOUSE_OWNER')\")\npublic ResponseEntity&lt;EarningsResponse&gt; getEarnings() {\n    User user = userService.getCurrentUser();\n    // Only returns current user's earnings\n    return ResponseEntity.ok(financeService.getEarnings(user.getId()));\n}\n</code></pre>"},{"location":"security/data-privacy/#data-retention","title":"Data Retention","text":""},{"location":"security/data-privacy/#user-deletion-flow","title":"User Deletion Flow","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Active: User Active\n    Active --&gt; DeletionRequested: User requests deletion\n    DeletionRequested --&gt; Scheduled: 30-day grace period\n    Scheduled --&gt; Deleted: Permanent deletion\n    DeletionRequested --&gt; Active: User cancels</code></pre> <pre><code>// User.java\n@Column(name = \"deletion_requested_at\")\nprivate LocalDateTime deletionRequestedAt;\n\n@Column(name = \"deletion_scheduled_at\")\nprivate LocalDateTime deletionScheduledAt;\n\n@Column(name = \"account_status\")\n@Enumerated(EnumType.STRING)\nprivate AccountStatus accountStatus;  // ACTIVE, DELETION_PENDING, DELETED\n</code></pre>"},{"location":"security/data-privacy/#database-security","title":"Database Security","text":""},{"location":"security/data-privacy/#connection-security","title":"Connection Security","text":"<pre><code># Use SSL in production\nspring.datasource.url=jdbc:mysql://host:3306/db?useSSL=true\n</code></pre>"},{"location":"security/data-privacy/#encryption-at-rest","title":"Encryption at Rest","text":"<p>Recommendation</p> <p>Enable MySQL encryption at rest for production:</p> <pre><code>ALTER TABLE users ENCRYPTION='Y';\n</code></pre>"},{"location":"security/data-privacy/#api-security-headers","title":"API Security Headers","text":"<pre><code>// SecurityConfig.java\n.headers(headers -&gt; headers\n    .frameOptions(frame -&gt; frame.sameOrigin())\n    .contentSecurityPolicy(csp -&gt; csp\n        .policyDirectives(\"default-src 'self'\"))\n)\n</code></pre>"},{"location":"security/data-privacy/#compliance-considerations","title":"Compliance Considerations","text":"Regulation Relevance Implementation GDPR EU users Data deletion, export CCPA California Opt-out mechanisms PCI-DSS Payments Not processing cards (out of scope) <p>Legal Note</p> <p>This is a technical guide. Consult legal counsel for compliance requirements.</p>"},{"location":"security/jwt-lifecycle/","title":"JWT Lifecycle","text":"<p>Complete lifecycle of JSON Web Tokens in StayMate.</p>"},{"location":"security/jwt-lifecycle/#token-overview","title":"Token Overview","text":"<p>StayMate uses two token types:</p> Token Purpose Lifetime Claims Access Token API authentication 15 minutes userId, email, roles Refresh Token Token renewal 7 days userId, type=\"refresh\""},{"location":"security/jwt-lifecycle/#token-lifecycle-state-diagram","title":"Token Lifecycle State Diagram","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Login: POST /api/auth/login\n    Login --&gt; AccessToken: Generate Access Token\n    Login --&gt; RefreshToken: Generate Refresh Token\n\n    AccessToken --&gt; Valid: Use for API calls\n    Valid --&gt; Expired: 15 minutes\n\n    Expired --&gt; RefreshEndpoint: POST /api/auth/refresh-token\n    RefreshEndpoint --&gt; NewAccessToken: New Access Token\n    NewAccessToken --&gt; Valid\n\n    RefreshToken --&gt; RefreshExpired: 7 days\n    RefreshExpired --&gt; [*]: Must login again</code></pre>"},{"location":"security/jwt-lifecycle/#token-generation","title":"Token Generation","text":""},{"location":"security/jwt-lifecycle/#jwttokenprovider-implementation","title":"JwtTokenProvider Implementation","text":"<pre><code>// JwtTokenProvider.java\n@Component\npublic class JwtTokenProvider {\n\n    @Value(\"${app.jwt.secret}\")\n    private String jwtSecret;\n\n    @Value(\"${app.jwt.access-token-expiration-ms}\")\n    private long accessTokenExpirationMs;  // 900000 (15 min)\n\n    @Value(\"${app.jwt.refresh-token-expiration-ms}\")\n    private long refreshTokenExpirationMs;  // 604800000 (7 days)\n\n    private SecretKey key;\n\n    @PostConstruct\n    public void init() {\n        byte[] keyBytes = Decoders.BASE64.decode(jwtSecret);\n        this.key = Keys.hmacShaKeyFor(keyBytes);\n    }\n\n    public String generateAccessToken(UserPrincipal userPrincipal) {\n        Date now = new Date();\n        Date expiryDate = new Date(now.getTime() + accessTokenExpirationMs);\n\n        String roles = userPrincipal.getAuthorities().stream()\n                .map(GrantedAuthority::getAuthority)\n                .collect(Collectors.joining(\",\"));\n\n        return Jwts.builder()\n                .subject(userPrincipal.getId().toString())\n                .claim(\"email\", userPrincipal.getEmail())\n                .claim(\"roles\", roles)\n                .issuedAt(now)\n                .expiration(expiryDate)\n                .signWith(key)\n                .compact();\n    }\n\n    public String generateRefreshToken(UserPrincipal userPrincipal) {\n        Date now = new Date();\n        Date expiryDate = new Date(now.getTime() + refreshTokenExpirationMs);\n\n        return Jwts.builder()\n                .subject(userPrincipal.getId().toString())\n                .claim(\"type\", \"refresh\")  // Marks as refresh token\n                .issuedAt(now)\n                .expiration(expiryDate)\n                .signWith(key)\n                .compact();\n    }\n}\n</code></pre>"},{"location":"security/jwt-lifecycle/#token-structure","title":"Token Structure","text":""},{"location":"security/jwt-lifecycle/#access-token-claims","title":"Access Token Claims","text":"<pre><code>{\n  \"sub\": \"42\",\n  \"email\": \"user@example.com\",\n  \"roles\": \"ROLE_USER,ROLE_HOUSE_OWNER\",\n  \"iat\": 1705836000,\n  \"exp\": 1705836900\n}\n</code></pre>"},{"location":"security/jwt-lifecycle/#refresh-token-claims","title":"Refresh Token Claims","text":"<pre><code>{\n  \"sub\": \"42\",\n  \"type\": \"refresh\",\n  \"iat\": 1705836000,\n  \"exp\": 1706440800\n}\n</code></pre>"},{"location":"security/jwt-lifecycle/#token-validation-flow","title":"Token Validation Flow","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant Filter as JwtAuthFilter\n    participant Provider as JwtTokenProvider\n    participant UserDetails\n    participant Security as SecurityContext\n\n    Client-&gt;&gt;Filter: Authorization: Bearer &lt;token&gt;\n    Filter-&gt;&gt;Filter: Extract token from header\n    Filter-&gt;&gt;Provider: validateToken(token)\n\n    Provider-&gt;&gt;Provider: Parse claims\n    Provider-&gt;&gt;Provider: Verify signature\n    Provider-&gt;&gt;Provider: Check expiration\n\n    alt Token Invalid\n        Provider--&gt;&gt;Client: 401 Unauthorized\n    end\n\n    Provider-&gt;&gt;Provider: getUserIdFromToken()\n    Filter-&gt;&gt;UserDetails: loadUserById(userId)\n    UserDetails--&gt;&gt;Filter: UserPrincipal\n\n    Filter-&gt;&gt;Security: setAuthentication(auth)\n    Filter-&gt;&gt;Filter: Continue filter chain</code></pre>"},{"location":"security/jwt-lifecycle/#validation-logic","title":"Validation Logic","text":"<pre><code>public boolean validateToken(String authToken) {\n    try {\n        Jwts.parser()\n                .verifyWith(key)\n                .build()\n                .parseSignedClaims(authToken);\n        return true;\n    } catch (SignatureException ex) {\n        logger.error(\"Invalid JWT signature\");\n    } catch (MalformedJwtException ex) {\n        logger.error(\"Invalid JWT token\");\n    } catch (ExpiredJwtException ex) {\n        logger.error(\"Expired JWT token\");\n    } catch (UnsupportedJwtException ex) {\n        logger.error(\"Unsupported JWT token\");\n    } catch (IllegalArgumentException ex) {\n        logger.error(\"JWT claims string is empty\");\n    }\n    return false;\n}\n</code></pre>"},{"location":"security/jwt-lifecycle/#refresh-flow","title":"Refresh Flow","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant Auth as AuthController\n    participant Provider as JwtTokenProvider\n    participant UserService\n\n    Client-&gt;&gt;Auth: POST /api/auth/refresh-token&lt;br/&gt;{ refreshToken }\n    Auth-&gt;&gt;Provider: validateToken(refreshToken)\n    Auth-&gt;&gt;Provider: isRefreshToken(refreshToken)\n\n    alt Not a refresh token\n        Auth--&gt;&gt;Client: 400 Bad Request\n    end\n\n    Auth-&gt;&gt;Provider: getUserIdFromToken()\n    Auth-&gt;&gt;UserService: loadUserById(userId)\n    Auth-&gt;&gt;Provider: generateAccessToken(user)\n    Auth-&gt;&gt;Provider: generateRefreshToken(user)\n    Auth--&gt;&gt;Client: { accessToken, refreshToken }</code></pre>"},{"location":"security/jwt-lifecycle/#configuration","title":"Configuration","text":"<pre><code># application.properties\napp.jwt.secret=${JWT_SECRET}\napp.jwt.access-token-expiration-ms=900000      # 15 minutes\napp.jwt.refresh-token-expiration-ms=604800000  # 7 days\n</code></pre> <p>Secret Management</p> <p>Never commit <code>JWT_SECRET</code> to version control. Use environment variables or secret managers.</p>"},{"location":"security/rate-limiting/","title":"Rate Limiting","text":"<p>Token bucket rate limiting implementation.</p>"},{"location":"security/rate-limiting/#overview","title":"Overview","text":"<p>StayMate uses a token bucket algorithm to prevent abuse and ensure fair resource allocation.</p> <pre><code>graph LR\n    subgraph \"Token Bucket\"\n        BUCKET[\"\ud83e\udea3 Bucket&lt;br/&gt;200 tokens max\"]\n        REFILL[\"\u23f0 Refill&lt;br/&gt;200/minute\"]\n    end\n\n    REQ[\"Request\"] --&gt; CHECK{Tokens available?}\n    CHECK --&gt;|Yes| CONSUME[\"Consume 1 token\"]\n    CONSUME --&gt; ALLOW[\"\u2705 Allow\"]\n    CHECK --&gt;|No| REJECT[\"\u274c 429 Too Many Requests\"]\n\n    REFILL --&gt; BUCKET</code></pre>"},{"location":"security/rate-limiting/#configuration","title":"Configuration","text":"<pre><code># application.properties\nrate.limit.enabled=true\nrate.limit.requests-per-minute=200\n</code></pre> Setting Default Description <code>enabled</code> true Enable/disable rate limiting <code>requests-per-minute</code> 200 Max requests per client per minute"},{"location":"security/rate-limiting/#implementation","title":"Implementation","text":""},{"location":"security/rate-limiting/#ratelimitfilter","title":"RateLimitFilter","text":"<pre><code>// RateLimitFilter.java\n@Component\npublic class RateLimitFilter extends OncePerRequestFilter {\n\n    private static final Logger logger = LoggerFactory.getLogger(RateLimitFilter.class);\n\n    @Value(\"${rate.limit.enabled:true}\")\n    private boolean rateLimitEnabled;\n\n    @Value(\"${rate.limit.requests-per-minute:200}\")\n    private int requestsPerMinute;\n\n    private final Map&lt;String, TokenBucket&gt; buckets = new ConcurrentHashMap&lt;&gt;();\n\n    @Override\n    protected void doFilterInternal(\n            HttpServletRequest request,\n            HttpServletResponse response,\n            FilterChain chain) throws ServletException, IOException {\n\n        if (!rateLimitEnabled) {\n            chain.doFilter(request, response);\n            return;\n        }\n\n        String clientId = getClientIdentifier(request);\n        TokenBucket bucket = buckets.computeIfAbsent(\n            clientId,\n            k -&gt; new TokenBucket(requestsPerMinute)\n        );\n\n        if (bucket.tryConsume()) {\n            chain.doFilter(request, response);\n        } else {\n            logger.warn(\"Rate limit exceeded for client: {}\", clientId);\n            response.setStatus(HttpStatus.TOO_MANY_REQUESTS.value());\n            response.setContentType(\"application/json\");\n            response.getWriter().write(\n                \"{\\\"error\\\":\\\"Rate limit exceeded\\\",\\\"message\\\":\\\"Try again later\\\"}\"\n            );\n        }\n    }\n\n    private String getClientIdentifier(HttpServletRequest request) {\n        // Prefer authenticated user ID\n        Authentication auth = SecurityContextHolder.getContext().getAuthentication();\n        if (auth != null &amp;&amp; auth.isAuthenticated() &amp;&amp;\n            !\"anonymousUser\".equals(auth.getPrincipal())) {\n            return \"user:\" + auth.getName();\n        }\n\n        // Fall back to IP address\n        String xff = request.getHeader(\"X-Forwarded-For\");\n        if (xff != null &amp;&amp; !xff.isEmpty()) {\n            return \"ip:\" + xff.split(\",\")[0].trim();\n        }\n        return \"ip:\" + request.getRemoteAddr();\n    }\n}\n</code></pre>"},{"location":"security/rate-limiting/#token-bucket-algorithm","title":"Token Bucket Algorithm","text":"<pre><code>public class TokenBucket {\n    private final int capacity;\n    private final double refillRate;  // tokens per millisecond\n    private double tokens;\n    private long lastRefillTime;\n\n    public TokenBucket(int tokensPerMinute) {\n        this.capacity = tokensPerMinute;\n        this.refillRate = tokensPerMinute / 60000.0;\n        this.tokens = capacity;\n        this.lastRefillTime = System.currentTimeMillis();\n    }\n\n    public synchronized boolean tryConsume() {\n        refill();\n        if (tokens &gt;= 1) {\n            tokens -= 1;\n            return true;\n        }\n        return false;\n    }\n\n    private void refill() {\n        long now = System.currentTimeMillis();\n        double elapsed = now - lastRefillTime;\n        tokens = Math.min(capacity, tokens + elapsed * refillRate);\n        lastRefillTime = now;\n    }\n}\n</code></pre>"},{"location":"security/rate-limiting/#filter-chain-position","title":"Filter Chain Position","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant CORS\n    participant RateLimit\n    participant JWT\n    participant Controller\n\n    Client-&gt;&gt;CORS: Request\n    CORS-&gt;&gt;RateLimit: Pass\n\n    alt Rate limit exceeded\n        RateLimit--&gt;&gt;Client: 429 Too Many Requests\n    end\n\n    RateLimit-&gt;&gt;JWT: Pass\n    JWT-&gt;&gt;Controller: Authenticated</code></pre> <p>The rate limit filter runs before JWT authentication to protect against unauthenticated abuse.</p>"},{"location":"security/rate-limiting/#per-endpoint-limits-future","title":"Per-Endpoint Limits (Future)","text":"<p>Enhancement Opportunity</p> <p>Current implementation uses a global limit. Consider per-endpoint limits:</p> <pre><code>@RateLimit(value = 10, window = 60)  // 10 per minute\n@PostMapping(\"/auth/login\")\npublic ResponseEntity&lt;AuthResponse&gt; login(...) {}\n</code></pre>"},{"location":"security/rate-limiting/#response-headers","title":"Response Headers","text":"<pre><code>HTTP/1.1 429 Too Many Requests\nContent-Type: application/json\nRetry-After: 60\n\n{\n  \"error\": \"Rate limit exceeded\",\n  \"message\": \"Try again later\"\n}\n</code></pre>"},{"location":"security/rate-limiting/#monitoring","title":"Monitoring","text":"<pre><code>// Future: Add metrics\nmeterRegistry.counter(\"rate.limit.exceeded\",\n    \"client\", clientId\n).increment();\n</code></pre>"},{"location":"security/threat-model/","title":"Security Threat Model","text":"<p>Identified threats and implemented mitigations for StayMate.</p>"},{"location":"security/threat-model/#threat-categories","title":"Threat Categories","text":"<pre><code>mindmap\n  root((Security Threats))\n    Authentication\n      Credential Stuffing\n      Brute Force\n      Token Theft\n      Session Hijacking\n    Authorization\n      Privilege Escalation\n      IDOR\n      RBAC Bypass\n    Injection\n      SQL Injection\n      XSS\n      CSRF\n    Data\n      Data Exposure\n      Password Leakage\n      PII Breach\n    DoS\n      Rate Limiting Bypass\n      Resource Exhaustion</code></pre>"},{"location":"security/threat-model/#threat-matrix","title":"Threat Matrix","text":"Threat Severity Likelihood Mitigation Status Brute Force Login High Medium Rate limiting \u2705 SQL Injection Critical Low JPA/Hibernate \u2705 XSS High Medium Output encoding \u2705 CSRF Medium Low Stateless (JWT) \u2705 Token Theft High Medium Short expiry, HTTPS \u2705 IDOR High Medium Ownership checks \u2705 Privilege Escalation Critical Low RBAC \u2705 Data Exposure High Low DTO pattern \u2705"},{"location":"security/threat-model/#authentication-threats","title":"Authentication Threats","text":""},{"location":"security/threat-model/#1-brute-force-attack","title":"1. Brute Force Attack","text":"<p>Threat: Attacker attempts many password combinations.</p> <p>Mitigation: <pre><code>// RateLimitFilter.java\n@Value(\"${rate.limit.requests-per-minute:200}\")\nprivate int requestsPerMinute;\n\nif (!rateLimiter.tryConsume(clientId)) {\n    response.setStatus(429);\n    return;\n}\n</code></pre></p>"},{"location":"security/threat-model/#2-credential-stuffing","title":"2. Credential Stuffing","text":"<p>Threat: Using leaked credentials from other sites.</p> <p>Mitigations:</p> <ul> <li>BCrypt password hashing (slow to verify)</li> <li>OAuth2 as alternative (offload to Google)</li> <li>Rate limiting on login endpoint</li> </ul>"},{"location":"security/threat-model/#3-token-theft","title":"3. Token Theft","text":"<p>Threat: Attacker intercepts JWT token.</p> <p>Mitigations:</p> <ul> <li>Short access token lifetime (15 min)</li> <li>Refresh token rotation</li> <li>HTTPS only in production</li> </ul>"},{"location":"security/threat-model/#authorization-threats","title":"Authorization Threats","text":""},{"location":"security/threat-model/#4-insecure-direct-object-reference-idor","title":"4. Insecure Direct Object Reference (IDOR)","text":"<p>Threat: Accessing other users' resources by changing IDs.</p> <p>Mitigation: <pre><code>@DeleteMapping(\"/properties/{id}\")\npublic ResponseEntity&lt;Void&gt; delete(@PathVariable Long id) {\n    Property property = propertyRepository.findById(id)\n        .orElseThrow(() -&gt; new ResourceNotFoundException(\"Property\", id));\n\n    User currentUser = userService.getCurrentUser();\n\n    // Ownership check prevents IDOR\n    if (!property.getOwner().equals(currentUser) &amp;&amp; !currentUser.isAdmin()) {\n        throw new AccessDeniedException(\"Not authorized\");\n    }\n\n    propertyRepository.delete(property);\n    return ResponseEntity.noContent().build();\n}\n</code></pre></p>"},{"location":"security/threat-model/#5-privilege-escalation","title":"5. Privilege Escalation","text":"<p>Threat: User gains higher privileges than authorized.</p> <p>Mitigation: <pre><code>// Role changes require admin approval\n@PreAuthorize(\"hasRole('ADMIN')\")\n@PostMapping(\"/users/{id}/roles\")\npublic ResponseEntity&lt;Void&gt; updateRoles(...) {\n    // Only admins can modify roles\n}\n</code></pre></p>"},{"location":"security/threat-model/#injection-threats","title":"Injection Threats","text":""},{"location":"security/threat-model/#6-sql-injection","title":"6. SQL Injection","text":"<p>Threat: Malicious SQL in user input.</p> <p>Mitigation: <pre><code>// JPA uses parameterized queries automatically\n@Query(\"SELECT p FROM Property p WHERE p.title LIKE %:search%\")\nList&lt;Property&gt; search(@Param(\"search\") String search);\n\n// Search input is parameterized, never concatenated\n</code></pre></p>"},{"location":"security/threat-model/#7-cross-site-scripting-xss","title":"7. Cross-Site Scripting (XSS)","text":"<p>Threat: Malicious scripts in user content.</p> <p>Mitigations:</p> <ul> <li>Input validation (Bean Validation)</li> <li>Output encoding (Jackson JSON serialization)</li> <li>Content-Type headers</li> </ul>"},{"location":"security/threat-model/#data-protection","title":"Data Protection","text":""},{"location":"security/threat-model/#8-password-handling","title":"8. Password Handling","text":"<pre><code>@Bean\npublic PasswordEncoder passwordEncoder() {\n    return new BCryptPasswordEncoder(10);  // Strength 10\n}\n\n// Never store plaintext\nuser.setPassword(passwordEncoder.encode(request.getPassword()));\n</code></pre>"},{"location":"security/threat-model/#9-sensitive-data-in-logs","title":"9. Sensitive Data in Logs","text":"<pre><code>// \u274c Never log passwords or tokens\nlog.info(\"Login with password: {}\", password);\n\n// \u2705 Log only safe identifiers\nlog.info(\"Login attempt for user: {}\", email);\n</code></pre>"},{"location":"security/threat-model/#10-response-data-filtering","title":"10. Response Data Filtering","text":"<pre><code>// Entity has password hash\n@Entity\npublic class User {\n    private String password;  // BCrypt hash\n}\n\n// DTO excludes sensitive fields\npublic class UserResponse {\n    private Long id;\n    private String email;\n    // No password field\n}\n</code></pre>"},{"location":"security/threat-model/#security-checklist","title":"Security Checklist","text":"Category Check Implementation Auth Rate limiting <code>RateLimitFilter</code> Auth Password hashing BCrypt Auth Token expiry 15 min access, 7 day refresh AuthZ RBAC enforcement <code>@PreAuthorize</code> AuthZ Ownership validation Service layer checks Input Validation Bean Validation Input SQL injection JPA parameterized Output Data filtering DTO pattern Transport HTTPS Nginx/cloud"},{"location":"setup/","title":"Setup","text":"<p>This section provides everything you need to get StayMate running locally.</p>"},{"location":"setup/#quick-start-tldr","title":"Quick Start (TL;DR)","text":"<pre><code># 1. Prerequisites\njava -version   # Java 17+\nmvn -version    # Maven 3.8+\nmysql --version # MySQL 8.0+\n\n# 2. Start dependencies\ndocker-compose up -d  # Starts MinIO\n\n# 3. Configure database\nmysql -u root -p -e \"CREATE DATABASE authdb;\"\n\n# 4. Run application\ncd server\n./mvnw spring-boot:run\n\n# 5. Verify\ncurl http://localhost:8080/actuator/health\n</code></pre>"},{"location":"setup/#in-this-section","title":"In This Section","text":"Document Description Time Prerequisites Required software 5 min Local Setup Step-by-step guide 15 min Database Setup MySQL configuration 10 min Run &amp; Debug IDE and debugging 10 min Common Errors Troubleshooting Reference"},{"location":"setup/#onboarding-path","title":"Onboarding Path","text":"<pre><code>flowchart LR\n    START([Start Here]) --&gt; PREREQ[Prerequisites]\n    PREREQ --&gt; DB[Database Setup]\n    DB --&gt; LOCAL[Local Setup]\n    LOCAL --&gt; RUN[Run &amp; Debug]\n    RUN --&gt; VERIFY{Working?}\n    VERIFY --&gt;|Yes| EXPLORE[Explore Docs]\n    VERIFY --&gt;|No| ERRORS[Common Errors]\n    ERRORS --&gt; RUN\n\n    style START fill:#2ecc71\n    style VERIFY fill:#f39c12\n    style EXPLORE fill:#3498db</code></pre>"},{"location":"setup/common-errors/","title":"Common Errors","text":"<p>Troubleshooting guide for frequent issues.</p>"},{"location":"setup/common-errors/#database-errors","title":"Database Errors","text":""},{"location":"setup/common-errors/#connection-refused","title":"Connection Refused","text":"<pre><code>com.mysql.cj.jdbc.exceptions.CommunicationsException:\nCommunications link failure\n</code></pre> <p>Cause: MySQL is not running.</p> <p>Fix: <pre><code># macOS\nbrew services start mysql\n\n# Linux\nsudo systemctl start mysql\n\n# Verify\nmysql -u root -p -e \"SELECT 1;\"\n</code></pre></p>"},{"location":"setup/common-errors/#access-denied","title":"Access Denied","text":"<pre><code>Access denied for user 'root'@'localhost' (using password: YES)\n</code></pre> <p>Cause: Wrong password or user doesn't exist.</p> <p>Fix: <pre><code># Reset password\nsudo mysql\nALTER USER 'root'@'localhost' IDENTIFIED BY 'new_password';\nFLUSH PRIVILEGES;\nEXIT;\n\n# Update environment\nexport DB_PASSWORD=new_password\n</code></pre></p>"},{"location":"setup/common-errors/#database-not-found","title":"Database Not Found","text":"<pre><code>Unknown database 'authdb'\n</code></pre> <p>Cause: Database doesn't exist.</p> <p>Fix: <pre><code>mysql -u root -p -e \"CREATE DATABASE authdb;\"\n</code></pre></p>"},{"location":"setup/common-errors/#flyway-errors","title":"Flyway Errors","text":""},{"location":"setup/common-errors/#migration-checksum-mismatch","title":"Migration Checksum Mismatch","text":"<pre><code>FlywayException: Validate failed: Migration checksum mismatch\n</code></pre> <p>Cause: Migration file was modified after being applied.</p> <p>Fix (Development Only): <pre><code># WARNING: This deletes migration history\nmysql -u root -p authdb -e \"DROP TABLE flyway_schema_history;\"\n\n# Restart application - migrations will re-run\n./mvnw spring-boot:run\n</code></pre></p> <p>Production Warning</p> <p>Never do this in production. Instead, create a new migration.</p>"},{"location":"setup/common-errors/#jwt-errors","title":"JWT Errors","text":""},{"location":"setup/common-errors/#invalid-jwt-signature","title":"Invalid JWT Signature","text":"<pre><code>io.jsonwebtoken.security.SignatureException: JWT signature does not match\n</code></pre> <p>Cause: JWT_SECRET changed between token generation and validation.</p> <p>Fix: - Use consistent JWT_SECRET - Clear browser tokens and re-login</p>"},{"location":"setup/common-errors/#expired-jwt-token","title":"Expired JWT Token","text":"<pre><code>io.jsonwebtoken.ExpiredJwtException: JWT expired\n</code></pre> <p>Cause: Access token expired (15 min lifetime).</p> <p>Fix: <pre><code># Use refresh token\ncurl -X POST http://localhost:8080/api/auth/refresh-token \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"refreshToken\": \"&lt;your-refresh-token&gt;\"}'\n</code></pre></p>"},{"location":"setup/common-errors/#minio-errors","title":"MinIO Errors","text":""},{"location":"setup/common-errors/#connection-refused-to-minio","title":"Connection Refused to MinIO","text":"<pre><code>io.minio.errors.InvalidResponseException:\nConnection refused to localhost:9005\n</code></pre> <p>Cause: MinIO container not running.</p> <p>Fix: <pre><code>docker-compose up -d\ndocker ps | grep minio\n</code></pre></p>"},{"location":"setup/common-errors/#bucket-does-not-exist","title":"Bucket Does Not Exist","text":"<pre><code>io.minio.errors.ErrorResponseException:\nThe specified bucket does not exist\n</code></pre> <p>Cause: Bucket not created.</p> <p>Fix: Access MinIO Console at http://localhost:9006 and create bucket <code>staymate-uploads</code>.</p>"},{"location":"setup/common-errors/#port-conflicts","title":"Port Conflicts","text":""},{"location":"setup/common-errors/#port-8080-already-in-use","title":"Port 8080 Already in Use","text":"<pre><code>Embedded servlet container failed to start. Port 8080 was already in use.\n</code></pre> <p>Fix: <pre><code># Find process using port\nlsof -i :8080\n\n# Kill process\nkill -9 &lt;PID&gt;\n\n# Or use different port\n./mvnw spring-boot:run -Dserver.port=8081\n</code></pre></p>"},{"location":"setup/common-errors/#maven-errors","title":"Maven Errors","text":""},{"location":"setup/common-errors/#dependency-resolution-failed","title":"Dependency Resolution Failed","text":"<pre><code>Could not resolve dependencies for project\n</code></pre> <p>Fix: <pre><code># Clear local cache\nrm -rf ~/.m2/repository\n\n# Retry\n./mvnw clean install -U\n</code></pre></p>"},{"location":"setup/common-errors/#getting-help","title":"Getting Help","text":"<p>If your error isn't listed:</p> <ol> <li>Check logs for full stack trace</li> <li>Search existing GitHub issues</li> <li>Open new issue with:</li> <li>Error message</li> <li>Steps to reproduce</li> <li>Environment details</li> </ol>"},{"location":"setup/database-setup/","title":"Database Setup","text":"<p>Configure MySQL for StayMate development.</p>"},{"location":"setup/database-setup/#overview","title":"Overview","text":"Property Value Database MySQL 8.0+ Default Name <code>authdb</code> Default User <code>root</code> Port <code>3306</code> Migrations Flyway (automatic)"},{"location":"setup/database-setup/#step-1-start-mysql","title":"Step 1: Start MySQL","text":"macOS (Homebrew)Linux (systemd)Docker (Alternative) <pre><code>brew services start mysql\n</code></pre> <pre><code>sudo systemctl start mysql\nsudo systemctl enable mysql  # Start on boot\n</code></pre> <pre><code>docker run -d \\\n  --name staymate-mysql \\\n  -e MYSQL_ROOT_PASSWORD=your_password \\\n  -e MYSQL_DATABASE=authdb \\\n  -p 3306:3306 \\\n  mysql:8.0\n</code></pre>"},{"location":"setup/database-setup/#step-2-create-database","title":"Step 2: Create Database","text":"<pre><code># Connect to MySQL\nmysql -u root -p\n\n# In MySQL shell:\nCREATE DATABASE authdb CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n\n# Verify\nSHOW DATABASES;\n</code></pre> <p>Expected output: <pre><code>+--------------------+\n| Database           |\n+--------------------+\n| authdb             |\n| information_schema |\n| mysql              |\n+--------------------+\n</code></pre></p>"},{"location":"setup/database-setup/#step-3-configure-connection","title":"Step 3: Configure Connection","text":"<p>The application uses environment variables with fallback defaults.</p>"},{"location":"setup/database-setup/#option-a-use-defaults-development","title":"Option A: Use Defaults (Development)","text":"<p>No configuration needed. Defaults are:</p> <pre><code>DB_HOST=localhost\nDB_PORT=3306\nDB_NAME=authdb\nDB_USERNAME=root\nDB_PASSWORD=MdAshikur123+  # Change this!\n</code></pre>"},{"location":"setup/database-setup/#option-b-environment-variables-recommended","title":"Option B: Environment Variables (Recommended)","text":"<pre><code># Add to ~/.zshrc or ~/.bashrc\nexport DB_HOST=localhost\nexport DB_PORT=3306\nexport DB_NAME=authdb\nexport DB_USERNAME=root\nexport DB_PASSWORD=your_secure_password\n</code></pre>"},{"location":"setup/database-setup/#option-c-env-file","title":"Option C: .env File","text":"<p>Create <code>server/.env</code>:</p> <pre><code>DB_HOST=localhost\nDB_PORT=3306\nDB_NAME=authdb\nDB_USERNAME=root\nDB_PASSWORD=your_secure_password\n</code></pre>"},{"location":"setup/database-setup/#step-4-verify-connection","title":"Step 4: Verify Connection","text":"<pre><code>mysql -u root -p -e \"SELECT 1 AS connected;\"\n</code></pre> <p>Expected: <pre><code>+-----------+\n| connected |\n+-----------+\n|         1 |\n+-----------+\n</code></pre></p>"},{"location":"setup/database-setup/#flyway-migrations","title":"Flyway Migrations","text":"<p>Automatic Migrations</p> <p>When you start the application, Flyway automatically:</p> <ol> <li>Connects to MySQL</li> <li>Creates <code>flyway_schema_history</code> table</li> <li>Runs all <code>V*__*.sql</code> migrations in order</li> <li>Records applied migrations</li> </ol> <p>You don't need to run migrations manually.</p> <p>Migrations location: <pre><code>server/src/main/resources/db/migration/\n\u251c\u2500\u2500 V1__init_schema.sql\n\u251c\u2500\u2500 V2__create_property_table.sql\n\u251c\u2500\u2500 ...\n\u2514\u2500\u2500 V120__alter_verification_requests_status.sql\n</code></pre></p>"},{"location":"setup/database-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"setup/database-setup/#access-denied","title":"Access Denied","text":"<pre><code>Access denied for user 'root'@'localhost'\n</code></pre> <p>Fix: <pre><code># Reset MySQL root password\nsudo mysql\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'new_password';\nFLUSH PRIVILEGES;\nEXIT;\n</code></pre></p>"},{"location":"setup/database-setup/#database-not-found","title":"Database Not Found","text":"<pre><code>Unknown database 'authdb'\n</code></pre> <p>Fix: <pre><code>mysql -u root -p -e \"CREATE DATABASE authdb;\"\n</code></pre></p>"},{"location":"setup/database-setup/#next-step","title":"Next Step","text":"<p>\u2192 Local Setup</p>"},{"location":"setup/local-setup/","title":"Local Setup","text":"<p>Complete step-by-step guide to run StayMate locally.</p>"},{"location":"setup/local-setup/#startup-flow","title":"Startup Flow","text":"<pre><code>flowchart TD\n    subgraph Clone[\"1. Clone\"]\n        A[\"git clone\"] --&gt; B[\"cd StayMate\"]\n    end\n\n    subgraph Dependencies[\"2. Dependencies\"]\n        B --&gt; C[\"Docker: MinIO\"]\n        B --&gt; D[\"MySQL: Database\"]\n    end\n\n    subgraph Backend[\"3. Backend\"]\n        C --&gt; E[\"mvn spring-boot:run\"]\n        D --&gt; E\n    end\n\n    subgraph Verify[\"4. Verify\"]\n        E --&gt; F[\"/actuator/health\"]\n        F --&gt; G{\"Status UP?\"}\n        G --&gt;|Yes| H[\"Ready\"]\n        G --&gt;|No| I[\"Check Logs\"]\n    end\n\n    style H fill:#2ecc71\n    style I fill:#e74c3c</code></pre>"},{"location":"setup/local-setup/#step-1-clone-repository","title":"Step 1: Clone Repository","text":"<pre><code>git clone https://github.com/your-org/StayMate.git\ncd StayMate\n</code></pre> <p>Verify structure: <pre><code>StayMate/\n\u251c\u2500\u2500 server/              # Spring Boot backend\n\u251c\u2500\u2500 client/              # Next.js frontend\n\u251c\u2500\u2500 staymate-mkdocs/     # Documentation\n\u251c\u2500\u2500 load-testing/        # k6 &amp; JMeter tests\n\u2514\u2500\u2500 docker-compose.yml   # MinIO container\n</code></pre></p>"},{"location":"setup/local-setup/#step-2-start-dependencies","title":"Step 2: Start Dependencies","text":""},{"location":"setup/local-setup/#minio-object-storage","title":"MinIO (Object Storage)","text":"<pre><code># Start MinIO container\ndocker-compose up -d\n\n# Verify MinIO is running\ndocker ps | grep minio\n</code></pre> <p>Expected: <pre><code>staymate-minio   minio/minio:latest   ...   0.0.0.0:9005-&gt;9000/tcp, 0.0.0.0:9006-&gt;9001/tcp\n</code></pre></p> <p>MinIO Console</p> <p>Access MinIO Console at http://localhost:9006</p> <ul> <li>Username: <code>minioadmin</code></li> <li>Password: <code>minioadmin</code></li> </ul>"},{"location":"setup/local-setup/#mysql","title":"MySQL","text":"<p>Ensure MySQL is running (see Database Setup):</p> <pre><code># macOS\nbrew services list | grep mysql\n\n# Linux\nsudo systemctl status mysql\n</code></pre>"},{"location":"setup/local-setup/#step-3-configure-environment-optional","title":"Step 3: Configure Environment (Optional)","text":"<p>Default values work for development. For custom config:</p> <pre><code># Create .env file\ncat &gt; server/.env &lt;&lt; 'EOF'\nDB_HOST=localhost\nDB_PORT=3306\nDB_NAME=authdb\nDB_USERNAME=root\nDB_PASSWORD=your_password\nJWT_SECRET=your-base64-encoded-secret\nEOF\n</code></pre>"},{"location":"setup/local-setup/#step-4-build-run-backend","title":"Step 4: Build &amp; Run Backend","text":"<pre><code>cd server\n\n# Download dependencies (first time only)\n./mvnw dependency:resolve\n\n# Run application\n./mvnw spring-boot:run\n</code></pre>"},{"location":"setup/local-setup/#expected-output","title":"Expected Output","text":"<pre><code>  .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::                (v3.2.0)\n\n...\nINFO  --- Flyway Community Edition 9.22.3\nINFO  --- Successfully validated 55 migrations\nINFO  --- Successfully applied 55 migrations\n...\nINFO  --- Started Application in 8.234 seconds\nINFO  --- Tomcat started on port 8080\n</code></pre> <p>First Startup</p> <p>First startup takes longer due to:</p> <ul> <li>Maven downloading dependencies</li> <li>Flyway running 55+ migrations</li> <li>MinIO bucket creation</li> </ul> <p>Subsequent starts are much faster.</p>"},{"location":"setup/local-setup/#step-5-verify","title":"Step 5: Verify","text":""},{"location":"setup/local-setup/#health-check","title":"Health Check","text":"<pre><code>curl http://localhost:8080/actuator/health\n</code></pre> <p>Expected: <pre><code>{\n  \"status\": \"UP\"\n}\n</code></pre></p>"},{"location":"setup/local-setup/#test-authentication","title":"Test Authentication","text":"<pre><code># Register a user\ncurl -X POST http://localhost:8080/api/auth/register \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"test@example.com\",\n    \"password\": \"Test123!\",\n    \"firstName\": \"Test\",\n    \"lastName\": \"User\"\n  }'\n</code></pre> <p>Expected: <pre><code>{\n  \"accessToken\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"refreshToken\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"tokenType\": \"Bearer\",\n  \"expiresIn\": 900000\n}\n</code></pre></p>"},{"location":"setup/local-setup/#test-protected-endpoint","title":"Test Protected Endpoint","text":"<pre><code># Use the accessToken from above\ncurl http://localhost:8080/api/auth/me \\\n  -H \"Authorization: Bearer &lt;accessToken&gt;\"\n</code></pre>"},{"location":"setup/local-setup/#step-6-access-points","title":"Step 6: Access Points","text":"Service URL Purpose API http://localhost:8080 Backend API Health http://localhost:8080/actuator/health Health check Swagger http://localhost:8080/swagger-ui.html API docs MinIO Console http://localhost:9006 Object storage MinIO API http://localhost:9005 S3-compatible API"},{"location":"setup/local-setup/#next-step","title":"Next Step","text":"<p>\u2192 Run &amp; Debug</p>"},{"location":"setup/prerequisites/","title":"Prerequisites","text":"<p>Software requirements for running StayMate locally.</p>"},{"location":"setup/prerequisites/#required-software","title":"Required Software","text":"Software Version Purpose Check Command Java JDK 17+ (LTS) Runtime <code>java -version</code> Maven 3.8+ Build tool <code>mvn -version</code> MySQL 8.0+ Database <code>mysql --version</code> Docker 20.10+ MinIO container <code>docker --version</code> Git 2.30+ Version control <code>git --version</code>"},{"location":"setup/prerequisites/#installation","title":"Installation","text":"macOSUbuntu/DebianWindows <pre><code># Install Homebrew if not installed\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n\n# Install Java 17\nbrew install openjdk@17\necho 'export PATH=\"/opt/homebrew/opt/openjdk@17/bin:$PATH\"' &gt;&gt; ~/.zshrc\nsource ~/.zshrc\n\n# Install Maven\nbrew install maven\n\n# Install MySQL\nbrew install mysql\nbrew services start mysql\n\n# Install Docker\nbrew install --cask docker\n</code></pre> <pre><code># Update packages\nsudo apt update\n\n# Install Java 17\nsudo apt install openjdk-17-jdk -y\n\n# Install Maven\nsudo apt install maven -y\n\n# Install MySQL\nsudo apt install mysql-server -y\nsudo systemctl start mysql\nsudo mysql_secure_installation\n\n# Install Docker\nsudo apt install docker.io docker-compose -y\nsudo usermod -aG docker $USER\n</code></pre> <pre><code># Using Chocolatey\nchoco install openjdk17 maven mysql docker-desktop git -y\n\n# Or download installers manually:\n# Java: https://adoptium.net/\n# Maven: https://maven.apache.org/download.cgi\n# MySQL: https://dev.mysql.com/downloads/installer/\n# Docker: https://www.docker.com/products/docker-desktop\n</code></pre>"},{"location":"setup/prerequisites/#verification","title":"Verification","text":"<p>Run these commands to verify your setup:</p> <pre><code># Java (must be 17+)\n$ java -version\nopenjdk version \"17.0.9\" 2023-10-17\n\n# Maven (must be 3.8+)\n$ mvn -version\nApache Maven 3.9.5\n\n# MySQL (must be 8.0+)\n$ mysql --version\nmysql  Ver 8.0.35\n\n\n# Docker\n$ docker --version\nDocker version 24.0.7\n</code></pre> <p>Java Version</p> <p>StayMate requires Java 17. Java 8 or 11 will not work.</p> <pre><code># Check exact version\njava -version 2&gt;&amp;1 | head -1\n</code></pre>"},{"location":"setup/prerequisites/#optional-tools","title":"Optional Tools","text":"Tool Purpose IntelliJ IDEA IDE with Spring support Postman/Swagger API testing MySQL Workbench Database GUI k6 Load testing"},{"location":"setup/prerequisites/#next-step","title":"Next Step","text":"<p>\u2192 Database Setup</p>"},{"location":"setup/run-and-debug/","title":"Run &amp; Debug","text":"<p>IDE configuration and debugging techniques.</p>"},{"location":"setup/run-and-debug/#running-in-ide","title":"Running in IDE","text":""},{"location":"setup/run-and-debug/#intellij-idea","title":"IntelliJ IDEA","text":"<ol> <li> <p>Open Project <pre><code>File \u2192 Open \u2192 Select \"server\" folder \u2192 Open as Project\n</code></pre></p> </li> <li> <p>Configure JDK <pre><code>File \u2192 Project Structure \u2192 Project \u2192 SDK \u2192 Java 17\n</code></pre></p> </li> <li> <p>Run Configuration <pre><code>Run \u2192 Edit Configurations \u2192 + \u2192 Spring Boot\n- Main class: com.webapp.Application\n- VM options: -Dspring.profiles.active=dev\n</code></pre></p> </li> <li> <p>Run <pre><code>Shift + F10 (Windows/Linux)\nCtrl + R (macOS)\n</code></pre></p> </li> </ol>"},{"location":"setup/run-and-debug/#vs-code","title":"VS Code","text":"<ol> <li>Install Extensions</li> <li>Extension Pack for Java</li> <li> <p>Spring Boot Extension Pack</p> </li> <li> <p>Run</p> </li> <li>Open <code>Application.java</code></li> <li>Click \"Run\" above <code>main()</code> method</li> </ol>"},{"location":"setup/run-and-debug/#debugging","title":"Debugging","text":""},{"location":"setup/run-and-debug/#intellij-idea_1","title":"IntelliJ IDEA","text":"<pre><code>flowchart LR\n    BP[Set Breakpoint] --&gt; DEBUG[Debug Mode]\n    DEBUG --&gt; REQ[Send Request]\n    REQ --&gt; HIT[Breakpoint Hit]\n    HIT --&gt; INSPECT[Inspect Variables]\n    INSPECT --&gt; STEP[Step Through]</code></pre> <ol> <li>Set Breakpoint</li> <li>Click in gutter next to line number</li> <li> <p>Red dot appears</p> </li> <li> <p>Start Debug Mode <pre><code>Shift + F9 (Windows/Linux)\nCtrl + D (macOS)\n</code></pre></p> </li> <li> <p>Trigger Breakpoint</p> </li> <li>Send request via curl/Postman</li> <li> <p>Debugger pauses at breakpoint</p> </li> <li> <p>Debug Controls</p> </li> </ol> Key Action F8 Step Over F7 Step Into Shift+F8 Step Out F9 Resume"},{"location":"setup/run-and-debug/#remote-debugging","title":"Remote Debugging","text":"<pre><code># Run with debug port\n./mvnw spring-boot:run \\\n  -Dspring-boot.run.jvmArguments=\"-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005\"\n</code></pre> <p>In IntelliJ: <pre><code>Run \u2192 Edit Configurations \u2192 + \u2192 Remote JVM Debug\n- Port: 5005\n</code></pre></p>"},{"location":"setup/run-and-debug/#hot-reload","title":"Hot Reload","text":"<p>DevTools is included for automatic restart on code changes.</p> <pre><code>&lt;!-- Already in pom.xml --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <p>IntelliJ Setup</p> <p>Enable auto-build for hot reload:</p> <ol> <li><code>Settings \u2192 Build \u2192 Compiler \u2192 Build project automatically</code></li> <li><code>Settings \u2192 Advanced Settings \u2192 Allow auto-make...</code></li> </ol>"},{"location":"setup/run-and-debug/#useful-commands","title":"Useful Commands","text":""},{"location":"setup/run-and-debug/#run-with-profile","title":"Run with Profile","text":"<pre><code># Development (more logging)\n./mvnw spring-boot:run -Dspring-boot.run.profiles=dev\n\n# Production simulation\n./mvnw spring-boot:run -Dspring-boot.run.profiles=prod\n</code></pre>"},{"location":"setup/run-and-debug/#run-tests","title":"Run Tests","text":"<pre><code># All tests\n./mvnw test\n\n# Specific test class\n./mvnw test -Dtest=PropertyServiceTest\n\n# Skip tests (for quick builds)\n./mvnw package -DskipTests\n</code></pre>"},{"location":"setup/run-and-debug/#build-jar","title":"Build JAR","text":"<pre><code>./mvnw clean package -DskipTests\njava -jar target/software-project-0.0.1-SNAPSHOT.jar\n</code></pre>"},{"location":"setup/run-and-debug/#logs","title":"Logs","text":""},{"location":"setup/run-and-debug/#log-levels","title":"Log Levels","text":"<pre><code># application.properties\nlogging.level.com.webapp=DEBUG          # Application\nlogging.level.org.hibernate.SQL=DEBUG   # SQL queries\nlogging.level.org.springframework.security=DEBUG  # Security\n</code></pre>"},{"location":"setup/run-and-debug/#log-output","title":"Log Output","text":"<pre><code># Follow logs in real-time\ntail -f server/logs/application.log\n\n# Or in console, look for:\nINFO  c.w.auth.controller.AuthController : Login attempt for: user@example.com\nDEBUG c.w.auth.security.JwtTokenProvider : Generated token for userId: 42\n</code></pre>"},{"location":"setup/run-and-debug/#next-step","title":"Next Step","text":"<p>\u2192 Common Errors</p>"}]}